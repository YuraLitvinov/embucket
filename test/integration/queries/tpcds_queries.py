TPCDS_QUERIES = [
    (
        "queryq1",
        "\nWITH customer_total_return AS\n( SELECT\n    sr_customer_sk AS ctr_customer_sk,\n    sr_store_sk AS ctr_store_sk,\n    sum(sr_return_amt) AS ctr_total_return\n  FROM {{TABLE:store_returns}}, {{TABLE:date_dim}}\n  WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000\n  GROUP BY sr_customer_sk, sr_store_sk)\nSELECT DISTINCT c_customer_id\nFROM customer_total_return ctr1, {{TABLE:store}}, {{TABLE:customer}}\nWHERE ctr1.ctr_total_return >\n  (SELECT cast(avg(ctr_total_return) * 1.2 as decimal(10,2))\n  FROM customer_total_return ctr2\n  WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n  AND s_store_sk = ctr1.ctr_store_sk\n  AND s_state = 'TN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY c_customer_id\n",
    ),
    (
        "queryq2",
        "\nWITH wscs AS\n( SELECT\n    sold_date_sk,\n    sales_price\n  FROM (SELECT\n    ws_sold_date_sk sold_date_sk,\n    ws_ext_sales_price sales_price\n  FROM {{TABLE:web_sales}}) x\n  UNION ALL\n  (SELECT\n    cs_sold_date_sk sold_date_sk,\n    cs_ext_sales_price sales_price\n  FROM {{TABLE:catalog_sales}})),\n    wswscs AS\n  ( SELECT\n    d_week_seq,\n    sum(CASE WHEN (d_day_name = 'Sunday')\n      THEN sales_price\n        ELSE NULL END)\n    sun_sales,\n    sum(CASE WHEN (d_day_name = 'Monday')\n      THEN sales_price\n        ELSE NULL END)\n    mon_sales,\n    sum(CASE WHEN (d_day_name = 'Tuesday')\n      THEN sales_price\n        ELSE NULL END)\n    tue_sales,\n    sum(CASE WHEN (d_day_name = 'Wednesday')\n      THEN sales_price\n        ELSE NULL END)\n    wed_sales,\n    sum(CASE WHEN (d_day_name = 'Thursday')\n      THEN sales_price\n        ELSE NULL END)\n    thu_sales,\n    sum(CASE WHEN (d_day_name = 'Friday')\n      THEN sales_price\n        ELSE NULL END)\n    fri_sales,\n    sum(CASE WHEN (d_day_name = 'Saturday')\n      THEN sales_price\n        ELSE NULL END)\n    sat_sales\n  FROM wscs, {{TABLE:date_dim}}\n  WHERE d_date_sk = sold_date_sk\n  GROUP BY d_week_seq)\nSELECT\n  d_week_seq1,\n  round(sun_sales1 / sun_sales2, 2),\n  round(mon_sales1 / mon_sales2, 2),\n  round(tue_sales1 / tue_sales2, 2),\n  round(wed_sales1 / wed_sales2, 2),\n  round(thu_sales1 / thu_sales2, 2),\n  round(fri_sales1 / fri_sales2, 2),\n  round(sat_sales1 / sat_sales2, 2)\nFROM\n  (SELECT\n    wswscs.d_week_seq d_week_seq1,\n    sun_sales sun_sales1,\n    mon_sales mon_sales1,\n    tue_sales tue_sales1,\n    wed_sales wed_sales1,\n    thu_sales thu_sales1,\n    fri_sales fri_sales1,\n    sat_sales sat_sales1\n  FROM wswscs, {{TABLE:date_dim}} date_dim\n  WHERE date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 2001) y,\n  (SELECT\n    wswscs.d_week_seq d_week_seq2,\n    sun_sales sun_sales2,\n    mon_sales mon_sales2,\n    tue_sales tue_sales2,\n    wed_sales wed_sales2,\n    thu_sales thu_sales2,\n    fri_sales fri_sales2,\n    sat_sales sat_sales2\n  FROM wswscs, {{TABLE:date_dim}} date_dim\n  WHERE date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 2001 + 1) z\nWHERE d_week_seq1 = d_week_seq2 - 53\nORDER BY d_week_seq1\n        ",
    ),
    (
        "queryq3",
        "\nSELECT\n  dt.d_year,\n  item.i_brand_id brand_id,\n  item.i_brand brand,\n  SUM(ss_ext_sales_price) sum_agg\nFROM {{TABLE:date_dim}} dt, {{TABLE:store_sales}} store_sales, {{TABLE:item}} item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manufact_id = 128\n  AND dt.d_moy = 11\nGROUP BY dt.d_year, item.i_brand, item.i_brand_id\nORDER BY dt.d_year, sum_agg DESC, brand_id\n",
    ),
    (
        "queryq4",
        "\nWITH year_total AS (\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    c_preferred_cust_flag customer_preferred_cust_flag,\n    c_birth_country customer_birth_country,\n    c_login customer_login,\n    c_email_address customer_email_address,\n    d_year dyear,\n    sum(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) +\n      ss_ext_sales_price) / 2) year_total,\n    's' sale_type\n  FROM {{TABLE:customer}}, {{TABLE:store_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk\n  GROUP BY c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    c_preferred_cust_flag customer_preferred_cust_flag,\n    c_birth_country customer_birth_country,\n    c_login customer_login,\n    c_email_address customer_email_address,\n    d_year dyear,\n    sum((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) +\n      cs_ext_sales_price) / 2)) year_total,\n    'c' sale_type\n  FROM {{TABLE:customer}}, {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk\n  GROUP BY c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    c_preferred_cust_flag customer_preferred_cust_flag,\n    c_birth_country customer_birth_country,\n    c_login customer_login,\n    c_email_address customer_email_address,\n    d_year dyear,\n    sum((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) /\n      2)) year_total,\n    'w' sale_type\n  FROM {{TABLE:customer}}, {{TABLE:web_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk\n  GROUP BY c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_preferred_cust_flag,\n  t_s_secyear.customer_birth_country,\n  t_s_secyear.customer_login,\n  t_s_secyear.customer_email_address\nFROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_c_firstyear,\n  year_total t_c_secyear, year_total t_w_firstyear, year_total t_w_secyear\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 2001\n  AND t_s_secyear.dyear = 2001 + 1\n  AND t_c_firstyear.dyear = 2001\n  AND t_c_secyear.dyear = 2001 + 1\n  AND t_w_firstyear.dyear = 2001\n  AND t_w_secyear.dyear = 2001 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE WHEN t_c_firstyear.year_total > 0\n  THEN t_c_secyear.year_total / t_c_firstyear.year_total\n      ELSE NULL END\n  > CASE WHEN t_s_firstyear.year_total > 0\n  THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL END\n  AND CASE WHEN t_c_firstyear.year_total > 0\n  THEN t_c_secyear.year_total / t_c_firstyear.year_total\n      ELSE NULL END\n  > CASE WHEN t_w_firstyear.year_total > 0\n  THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_preferred_cust_flag,\n  t_s_secyear.customer_birth_country,\n  t_s_secyear.customer_login,\n  t_s_secyear.customer_email_address\n",
    ),
    (
        "queryq5",
        "\nWITH ssr AS\n( SELECT\n    s_store_id,\n    sum(sales_price) AS sales,\n    sum(profit) AS profit,\n    sum(return_amt) AS RETURNS,\n    sum(net_loss) AS profit_loss\n  FROM\n    (SELECT\n       ss_store_sk AS store_sk,\n       ss_sold_date_sk AS date_sk,\n       ss_ext_sales_price AS sales_price,\n       ss_net_profit AS profit,\n       cast(0 AS DECIMAL(7, 2)) AS return_amt,\n       cast(0 AS DECIMAL(7, 2)) AS net_loss\n     FROM {{TABLE:store_sales}}\n     UNION ALL\n     SELECT\n       sr_store_sk AS store_sk,\n       sr_returned_date_sk AS date_sk,\n       cast(0 AS DECIMAL(7, 2)) AS sales_price,\n       cast(0 AS DECIMAL(7, 2)) AS profit,\n       sr_return_amt AS return_amt,\n       sr_net_loss AS net_loss\n     FROM {{TABLE:store_returns}})\n    salesreturns, {{TABLE:date_dim}}, {{TABLE:store}}\n  WHERE date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-23' AS DATE)\n  AND ((cast('2000-08-23' AS DATE) + INTERVAL 14 days))\n    AND store_sk = s_store_sk\n  GROUP BY s_store_id),\n    csr AS\n  ( SELECT\n    cp_catalog_page_id,\n    sum(sales_price) AS sales,\n    sum(profit) AS profit,\n    sum(return_amt) AS RETURNS,\n    sum(net_loss) AS profit_loss\n  FROM\n    (SELECT\n       cs_catalog_page_sk AS page_sk,\n       cs_sold_date_sk AS date_sk,\n       cs_ext_sales_price AS sales_price,\n       cs_net_profit AS profit,\n       cast(0 AS DECIMAL(7, 2)) AS return_amt,\n       cast(0 AS DECIMAL(7, 2)) AS net_loss\n     FROM {{TABLE:catalog_sales}}\n     UNION ALL\n     SELECT\n       cr_catalog_page_sk AS page_sk,\n       cr_returned_date_sk AS date_sk,\n       cast(0 AS DECIMAL(7, 2)) AS sales_price,\n       cast(0 AS DECIMAL(7, 2)) AS profit,\n       cr_return_amount AS return_amt,\n       cr_net_loss AS net_loss\n     FROM {{TABLE:catalog_returns}}\n    ) salesreturns, {{TABLE:date_dim}}, {{TABLE:catalog_page}}\n  WHERE date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-23' AS DATE)\n  AND ((cast('2000-08-23' AS DATE) + INTERVAL 14 days))\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY cp_catalog_page_id)\n  ,\n    wsr AS\n  ( SELECT\n    web_site_id,\n    sum(sales_price) AS sales,\n    sum(profit) AS profit,\n    sum(return_amt) AS RETURNS,\n    sum(net_loss) AS profit_loss\n  FROM\n    (SELECT\n       ws_web_site_sk AS wsr_web_site_sk,\n       ws_sold_date_sk AS date_sk,\n       ws_ext_sales_price AS sales_price,\n       ws_net_profit AS profit,\n       cast(0 AS DECIMAL(7, 2)) AS return_amt,\n       cast(0 AS DECIMAL(7, 2)) AS net_loss\n     FROM {{TABLE:web_sales}}\n     UNION ALL\n     SELECT\n       ws_web_site_sk AS wsr_web_site_sk,\n       wr_returned_date_sk AS date_sk,\n       cast(0 AS DECIMAL(7, 2)) AS sales_price,\n       cast(0 AS DECIMAL(7, 2)) AS profit,\n       wr_return_amt AS return_amt,\n       wr_net_loss AS net_loss\n     FROM {{TABLE:web_returns}}\n       LEFT OUTER JOIN {{TABLE:web_sales}} ON\n                                   (wr_item_sk = ws_item_sk\n                                     AND wr_order_number = ws_order_number)\n    ) salesreturns, {{TABLE:date_dim}}, {{TABLE:web_site}}\n  WHERE date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-23' AS DATE)\n  AND ((cast('2000-08-23' AS DATE) + INTERVAL 14 days))\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY web_site_id)\nSELECT\n  channel,\n  id,\n  sum(sales) AS sales,\n  sum(returns) AS returns,\n  sum(profit) AS profit\nFROM\n  (SELECT\n     'store channel' AS channel,\n     concat('store', s_store_id) AS id,\n     sales,\n     returns,\n     (profit - profit_loss) AS profit\n   FROM ssr\n   UNION ALL\n   SELECT\n     'catalog channel' AS channel,\n     concat('catalog_page', cp_catalog_page_id) AS id,\n     sales,\n     returns,\n     (profit - profit_loss) AS profit\n   FROM csr\n   UNION ALL\n   SELECT\n     'web channel' AS channel,\n     concat('web_site', web_site_id) AS id,\n     sales,\n     returns,\n     (profit - profit_loss) AS profit\n   FROM wsr\n  ) x\nGROUP BY ROLLUP (channel, id)\nORDER BY channel, id\n",
    ),
    (
        "queryq5a",
        "\nwith ssr as(\n    select\n      s_store_id,\n      sum(sales_price) as sales,\n      sum(profit) as profit,\n      sum(return_amt) as returns,\n      sum(net_loss) as profit_loss\n    from (\n        select\n          ss_store_sk as store_sk,\n          ss_sold_date_sk as date_sk,\n          ss_ext_sales_price as sales_price,\n          ss_net_profit as profit,\n          cast(0 as decimal(7,2)) as return_amt,\n          cast(0 as decimal(7,2)) as net_loss\n        from\n          {{TABLE:store_sales}}\n        union all\n        select\n          sr_store_sk as store_sk,\n          sr_returned_date_sk as date_sk,\n          cast(0 as decimal(7,2)) as sales_price,\n          cast(0 as decimal(7,2)) as profit,\n          sr_return_amt as return_amt,\n          sr_net_loss as net_loss\n        from\n          {{TABLE:store_returns}}) salesreturns,\n      {{TABLE:date_dim}},\n      {{TABLE:store}}\n    where\n      date_sk = d_date_sk and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + INTERVAL 14 days)\n        and store_sk = s_store_sk\n    group by\n      s_store_id),\ncsr as (\n    select\n      cp_catalog_page_id,\n      sum(sales_price) as sales,\n      sum(profit) as profit,\n      sum(return_amt) as returns,\n      sum(net_loss) as profit_loss\n    from (\n        select\n          cs_catalog_page_sk as page_sk,\n          cs_sold_date_sk  as date_sk,\n          cs_ext_sales_price as sales_price,\n          cs_net_profit as profit,\n          cast(0 as decimal(7,2)) as return_amt,\n          cast(0 as decimal(7,2)) as net_loss\n        from {{TABLE:catalog_sales}}\n        union all\n        select\n          cr_catalog_page_sk as page_sk,\n          cr_returned_date_sk as date_sk,\n          cast(0 as decimal(7,2)) as sales_price,\n          cast(0 as decimal(7,2)) as profit,\n          cr_return_amount as return_amt,\n          cr_net_loss as net_loss\n        from {{TABLE:catalog_returns}}) salesreturns,\n      {{TABLE:date_dim}},\n      {{TABLE:catalog_page}}\n    where\n      date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) +  INTERVAL 14 days)\n        and page_sk = cp_catalog_page_sk\n    group by\n      cp_catalog_page_id),\nwsr as (\n    select\n      web_site_id,\n      sum(sales_price) as sales,\n      sum(profit) as profit,\n      sum(return_amt) as returns,\n      sum(net_loss) as profit_loss\n    from (\n        select\n          ws_web_site_sk as wsr_web_site_sk,\n          ws_sold_date_sk  as date_sk,\n          ws_ext_sales_price as sales_price,\n          ws_net_profit as profit,\n          cast(0 as decimal(7,2)) as return_amt,\n          cast(0 as decimal(7,2)) as net_loss\n        from\n          {{TABLE:web_sales}}\n        union all\n        select\n          ws_web_site_sk as wsr_web_site_sk,\n          wr_returned_date_sk as date_sk,\n          cast(0 as decimal(7,2)) as sales_price,\n          cast(0 as decimal(7,2)) as profit,\n          wr_return_amt as return_amt,\n          wr_net_loss as net_loss\n        from\n          {{TABLE:web_returns}}\n        left outer join {{TABLE:web_sales}} on (\n          wr_item_sk = ws_item_sk and wr_order_number = ws_order_number)\n      ) salesreturns,\n      {{TABLE:date_dim}},\n      {{TABLE:web_site}}\n    where\n      date_sk = d_date_sk and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) +  INTERVAL 14 days)\n        and wsr_web_site_sk = web_site_sk\n    group by\n      web_site_id),\nresults as (\n    select\n      channel,\n      id,\n      sum(sales) as sales,\n      sum(returns) as returns,\n      sum(profit) as profit\n    from (\n      select\n        'store channel' as channel,\n        'store' || s_store_id as id,\n        sales,\n        returns,\n        (profit - profit_loss) as profit\n      from\n        ssr\n      union all\n      select\n        'catalog channel' as channel,\n        'catalog_page' || cp_catalog_page_id as id,\n        sales,\n        returns,\n        (profit - profit_loss) as profit\n      from\n        csr\n      union all\n      select\n        'web channel' as channel,\n        'web_site' || web_site_id as id,\n        sales,\n        returns,\n        (profit - profit_loss) as profit\n    from\n      wsr) x\n    group by\n      channel, id)\nselect\n  channel, id, sales, returns, profit\nfrom (\n  select channel, id, sales, returns, profit\n  from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit)\n  from results\n  group by channel\n  union\n  select null as channel, null as id, sum(sales), sum(returns), sum(profit)\n  from results) foo\n  order by channel, id\n",
    ),
    (
        "queryq6",
        "\nSELECT\n  a.ca_state state,\n  count(*) cnt\nFROM\n  {{TABLE:customer_address}} a, {{TABLE:customer}} c, {{TABLE:store_sales}} s, {{TABLE:date_dim}} d, {{TABLE:item}} i\nWHERE a.ca_address_sk = c.c_current_addr_sk\n  AND c.c_customer_sk = s.ss_customer_sk\n  AND s.ss_sold_date_sk = d.d_date_sk\n  AND s.ss_item_sk = i.i_item_sk\n  AND d.d_month_seq =\n  (SELECT DISTINCT (d_month_seq)\n  FROM {{TABLE:date_dim}}\n  WHERE d_year = 2000 AND d_moy = 1)\n  AND i.i_current_price > 1.2 *\n  (SELECT avg(j.i_current_price)\n  FROM {{TABLE:item}} j\n  WHERE j.i_category = i.i_category)\nGROUP BY a.ca_state\nHAVING count(*) >= 10\n-- order-by list of q6 in TPCDS v1.4 is below:\n-- order by cnt\norder by cnt, a.ca_state\n",
    ),
    (
        "queryq7",
        "\nSELECT\n  i_item_id,\n  avg(ss_quantity) agg1,\n  avg(ss_list_price) agg2,\n  avg(ss_coupon_amt) agg3,\n  avg(ss_sales_price) agg4\nFROM {{TABLE:store_sales}}, {{TABLE:customer_demographics}}, {{TABLE:date_dim}}, {{TABLE:item}}, {{TABLE:promotion}}\nWHERE ss_sold_date_sk = d_date_sk AND\n  ss_item_sk = i_item_sk AND\n  ss_cdemo_sk = cd_demo_sk AND\n  ss_promo_sk = p_promo_sk AND\n  cd_gender = 'M' AND\n  cd_marital_status = 'S' AND\n  cd_education_status = 'College' AND\n  (p_channel_email = 'N' OR p_channel_event = 'N') AND\n  d_year = 2000\nGROUP BY i_item_id\nORDER BY i_item_id\n",
    ),
    (
        "queryq8",
        "\nSELECT\n  s_store_name,\n  sum(ss_net_profit)\nFROM {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}},\n  (SELECT ca_zip\n  FROM (\n         (SELECT substr(ca_zip, 1, 5) ca_zip\n         FROM {{TABLE:customer_address}}\n         WHERE substr(ca_zip, 1, 5) IN (\n               '24128','76232','65084','87816','83926','77556','20548',\n               '26231','43848','15126','91137','61265','98294','25782',\n               '17920','18426','98235','40081','84093','28577','55565',\n               '17183','54601','67897','22752','86284','18376','38607',\n               '45200','21756','29741','96765','23932','89360','29839',\n               '25989','28898','91068','72550','10390','18845','47770',\n               '82636','41367','76638','86198','81312','37126','39192',\n               '88424','72175','81426','53672','10445','42666','66864',\n               '66708','41248','48583','82276','18842','78890','49448',\n               '14089','38122','34425','79077','19849','43285','39861',\n               '66162','77610','13695','99543','83444','83041','12305',\n               '57665','68341','25003','57834','62878','49130','81096',\n               '18840','27700','23470','50412','21195','16021','76107',\n               '71954','68309','18119','98359','64544','10336','86379',\n               '27068','39736','98569','28915','24206','56529','57647',\n               '54917','42961','91110','63981','14922','36420','23006',\n               '67467','32754','30903','20260','31671','51798','72325',\n               '85816','68621','13955','36446','41766','68806','16725',\n               '15146','22744','35850','88086','51649','18270','52867',\n               '39972','96976','63792','11376','94898','13595','10516',\n               '90225','58943','39371','94945','28587','96576','57855',\n               '28488','26105','83933','25858','34322','44438','73171',\n               '30122','34102','22685','71256','78451','54364','13354',\n               '45375','40558','56458','28286','45266','47305','69399',\n               '83921','26233','11101','15371','69913','35942','15882',\n               '25631','24610','44165','99076','33786','70738','26653',\n               '14328','72305','62496','22152','10144','64147','48425',\n               '14663','21076','18799','30450','63089','81019','68893',\n               '24996','51200','51211','45692','92712','70466','79994',\n               '22437','25280','38935','71791','73134','56571','14060',\n               '19505','72425','56575','74351','68786','51650','20004',\n               '18383','76614','11634','18906','15765','41368','73241',\n               '76698','78567','97189','28545','76231','75691','22246',\n               '51061','90578','56691','68014','51103','94167','57047',\n               '14867','73520','15734','63435','25733','35474','24676',\n               '94627','53535','17879','15559','53268','59166','11928',\n               '59402','33282','45721','43933','68101','33515','36634',\n               '71286','19736','58058','55253','67473','41918','19515',\n               '36495','19430','22351','77191','91393','49156','50298',\n               '87501','18652','53179','18767','63193','23968','65164',\n               '68880','21286','72823','58470','67301','13394','31016',\n               '70372','67030','40604','24317','45748','39127','26065',\n               '77721','31029','31880','60576','24671','45549','13376',\n               '50016','33123','19769','22927','97789','46081','72151',\n               '15723','46136','51949','68100','96888','64528','14171',\n               '79777','28709','11489','25103','32213','78668','22245',\n               '15798','27156','37930','62971','21337','51622','67853',\n               '10567','38415','15455','58263','42029','60279','37125',\n               '56240','88190','50308','26859','64457','89091','82136',\n               '62377','36233','63837','58078','17043','30010','60099',\n               '28810','98025','29178','87343','73273','30469','64034',\n               '39516','86057','21309','90257','67875','40162','11356',\n               '73650','61810','72013','30431','22461','19512','13375',\n               '55307','30625','83849','68908','26689','96451','38193',\n               '46820','88885','84935','69035','83144','47537','56616',\n               '94983','48033','69952','25486','61547','27385','61860',\n               '58048','56910','16807','17871','35258','31387','35458',\n               '35576'))\n         INTERSECT\n         (SELECT ca_zip\n         FROM\n           (SELECT\n             substr(ca_zip, 1, 5) ca_zip,\n             count(*) cnt\n           FROM {{TABLE:customer_address}}, {{TABLE:customer}}\n           WHERE ca_address_sk = c_current_addr_sk AND\n             c_preferred_cust_flag = 'Y'\n           GROUP BY ca_zip\n           HAVING count(*) > 10) A1)\n       ) A2\n  ) V1\nWHERE ss_store_sk = s_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_qoy = 2 AND d_year = 1998\n  AND (substr(s_zip, 1, 2) = substr(V1.ca_zip, 1, 2))\nGROUP BY s_store_name\nORDER BY s_store_name\n",
    ),
    (
        "queryq9",
        "\nSELECT\n  CASE WHEN (SELECT count(*)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 1 AND 20) > 62316685\n    THEN (SELECT avg(ss_ext_discount_amt)\n    FROM {{TABLE:store_sales}}\n    WHERE ss_quantity BETWEEN 1 AND 20)\n  ELSE (SELECT avg(ss_net_paid)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 1 AND 20) END bucket1,\n  CASE WHEN (SELECT count(*)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 21 AND 40) > 19045798\n    THEN (SELECT avg(ss_ext_discount_amt)\n    FROM {{TABLE:store_sales}}\n    WHERE ss_quantity BETWEEN 21 AND 40)\n  ELSE (SELECT avg(ss_net_paid)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 21 AND 40) END bucket2,\n  CASE WHEN (SELECT count(*)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 41 AND 60) > 365541424\n    THEN (SELECT avg(ss_ext_discount_amt)\n    FROM {{TABLE:store_sales}}\n    WHERE ss_quantity BETWEEN 41 AND 60)\n  ELSE (SELECT avg(ss_net_paid)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 41 AND 60) END bucket3,\n  CASE WHEN (SELECT count(*)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 61 AND 80) > 216357808\n    THEN (SELECT avg(ss_ext_discount_amt)\n    FROM {{TABLE:store_sales}}\n    WHERE ss_quantity BETWEEN 61 AND 80)\n  ELSE (SELECT avg(ss_net_paid)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 61 AND 80) END bucket4,\n  CASE WHEN (SELECT count(*)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 81 AND 100) > 184483884\n    THEN (SELECT avg(ss_ext_discount_amt)\n    FROM {{TABLE:store_sales}}\n    WHERE ss_quantity BETWEEN 81 AND 100)\n  ELSE (SELECT avg(ss_net_paid)\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 81 AND 100) END bucket5\nFROM {{TABLE:reason}}\nWHERE r_reason_sk = 1\n        ",
    ),
    (
        "queryq10",
        "\nSELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\nFROM\n  {{TABLE:customer}} c, {{TABLE:customer_address}} ca, {{TABLE:customer_demographics}}\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk AND\n    ca_county IN ('Rush County', 'Toole County', 'Jefferson County',\n                  'Dona Ana County', 'La Porte County') AND\n    cd_demo_sk = c.c_current_cdemo_sk AND\n    exists(SELECT *\n           FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n           WHERE c.c_customer_sk = ss_customer_sk AND\n             ss_sold_date_sk = d_date_sk AND\n             d_year = 2002 AND\n             d_moy BETWEEN 1 AND 1 + 3) AND\n    (exists(SELECT *\n            FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n            WHERE c.c_customer_sk = ws_bill_customer_sk AND\n              ws_sold_date_sk = d_date_sk AND\n              d_year = 2002 AND\n              d_moy BETWEEN 1 AND 1 + 3) OR\n      exists(SELECT *\n             FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n             WHERE c.c_customer_sk = cs_ship_customer_sk AND\n               cs_sold_date_sk = d_date_sk AND\n               d_year = 2002 AND\n               d_moy BETWEEN 1 AND 1 + 3))\nGROUP BY cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\n",
    ),
    (
        "queryq10a",
        "\nselect\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\nfrom\n  {{TABLE:customer}} c,{{TABLE:customer_address}} ca,{{TABLE:customer_demographics}}\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk\n    and ca_county in ('Walker County', 'Richland County', 'Gaines County', 'Douglas County', 'Dona Ana County')\n    and cd_demo_sk = c.c_current_cdemo_sk\n    and exists (\n        select *\n        from {{TABLE:store_sales}},{{TABLE:date_dim}}\n        where c.c_customer_sk = ss_customer_sk\n          and ss_sold_date_sk = d_date_sk\n          and d_year = 2002\n          and d_moy between 4 and 4 + 3)\n    and exists (\n        select *\n        from (\n            select\n              ws_bill_customer_sk as customer_sk,\n              d_year,\n              d_moy\n            from {{TABLE:web_sales}}, {{TABLE:date_dim}}\n            where ws_sold_date_sk = d_date_sk\n              and d_year = 2002\n              and d_moy between 4 and 4 + 3\n            union all\n            select\n              cs_ship_customer_sk as customer_sk,\n              d_year,\n              d_moy\n            from {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n            where cs_sold_date_sk = d_date_sk\n              and d_year = 2002\n              and d_moy between 4 and 4 + 3) x\n    where c.c_customer_sk = customer_sk)\ngroup by\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\norder by\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\n",
    ),
    (
        "queryq11",
        "\nWITH year_total AS (\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    c_preferred_cust_flag customer_preferred_cust_flag,\n    c_birth_country customer_birth_country,\n    c_login customer_login,\n    c_email_address customer_email_address,\n    d_year dyear,\n    sum(ss_ext_list_price - ss_ext_discount_amt) year_total,\n    's' sale_type\n  FROM {{TABLE:customer}}, {{TABLE:store_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = ss_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n  GROUP BY c_customer_id\n    , c_first_name\n    , c_last_name\n    , d_year\n    , c_preferred_cust_flag\n    , c_birth_country\n    , c_login\n    , c_email_address\n    , d_year\n  UNION ALL\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    c_preferred_cust_flag customer_preferred_cust_flag,\n    c_birth_country customer_birth_country,\n    c_login customer_login,\n    c_email_address customer_email_address,\n    d_year dyear,\n    sum(ws_ext_list_price - ws_ext_discount_amt) year_total,\n    'w' sale_type\n  FROM {{TABLE:customer}}, {{TABLE:web_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = ws_bill_customer_sk\n    AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country,\n    c_login, c_email_address, d_year)\nSELECT\n  -- select list of q11 in TPCDS v1.4 is below:\n  -- t_s_secyear.customer_preferred_cust_flag\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_email_address\nFROM year_total t_s_firstyear\n  , year_total t_s_secyear\n  , year_total t_w_firstyear\n  , year_total t_w_secyear\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 2001\n  AND t_s_secyear.dyear = 2001 + 1\n  AND t_w_firstyear.dyear = 2001\n  AND t_w_secyear.dyear = 2001 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE WHEN t_w_firstyear.year_total > 0\n  THEN t_w_secyear.year_total / t_w_firstyear.year_total\n  -- q11 in TPCDS v1.4 used NULL\n  --     ELSE NULL END\n      ELSE 0.0 END\n  > CASE WHEN t_s_firstyear.year_total > 0\n  THEN t_s_secyear.year_total / t_s_firstyear.year_total\n  -- q11 in TPCDS v1.4 used NULL\n  --   ELSE NULL END\n    ELSE 0.0 END\nORDER BY\n  -- order-by list of q11 in TPCDS v1.4 is below:\n  -- t_s_secyear.customer_preferred_cust_flag\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_email_address\n",
    ),
    (
        "queryq12",
        "\nSELECT\n  i_item_id, \n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  sum(ws_ext_sales_price) AS itemrevenue,\n  sum(ws_ext_sales_price) * 100 / sum(sum(ws_ext_sales_price))\n  OVER\n  (PARTITION BY i_class) AS revenueratio\nFROM\n  {{TABLE:web_sales}} web_sales, {{TABLE:item}} item, {{TABLE:date_dim}} date_dim\nWHERE\n  ws_item_sk = i_item_sk\n    AND i_category IN ('Sports', 'Books', 'Home')\n    AND ws_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('1999-02-22' AS DATE)\n  AND (cast('1999-02-22' AS DATE) + INTERVAL 30 days)\nGROUP BY\n  i_item_id, i_item_desc, i_category, i_class, i_current_price\nORDER BY\n  i_category, i_class, i_item_id, i_item_desc, revenueratio\n",
    ),
    (
        "queryq13",
        "\nSELECT\n  avg(ss_quantity),\n  avg(ss_ext_sales_price),\n  avg(ss_ext_wholesale_cost),\n  sum(ss_ext_wholesale_cost)\nFROM {{TABLE:store_sales}}\n  , {{TABLE:store}}\n  , {{TABLE:customer_demographics}}\n  , {{TABLE:household_demographics}}\n  , {{TABLE:customer_address}}\n  , {{TABLE:date_dim}}\nWHERE s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk AND d_year = 2001\n  AND ((ss_hdemo_sk = hd_demo_sk\n  AND cd_demo_sk = ss_cdemo_sk\n  AND cd_marital_status = 'M'\n  AND cd_education_status = 'Advanced Degree'\n  AND ss_sales_price BETWEEN 100.00 AND 150.00\n  AND hd_dep_count = 3\n) OR\n  (ss_hdemo_sk = hd_demo_sk\n    AND cd_demo_sk = ss_cdemo_sk\n    AND cd_marital_status = 'S'\n    AND cd_education_status = 'College'\n    AND ss_sales_price BETWEEN 50.00 AND 100.00\n    AND hd_dep_count = 1\n  ) OR\n  (ss_hdemo_sk = hd_demo_sk\n    AND cd_demo_sk = ss_cdemo_sk\n    AND cd_marital_status = 'W'\n    AND cd_education_status = '2 yr Degree'\n    AND ss_sales_price BETWEEN 150.00 AND 200.00\n    AND hd_dep_count = 1\n  ))\n  AND ((ss_addr_sk = ca_address_sk\n  AND ca_country = 'United States'\n  AND ca_state IN ('TX', 'OH', 'TX')\n  AND ss_net_profit BETWEEN 100 AND 200\n) OR\n  (ss_addr_sk = ca_address_sk\n    AND ca_country = 'United States'\n    AND ca_state IN ('OR', 'NM', 'KY')\n    AND ss_net_profit BETWEEN 150 AND 300\n  ) OR\n  (ss_addr_sk = ca_address_sk\n    AND ca_country = 'United States'\n    AND ca_state IN ('VA', 'TX', 'MS')\n    AND ss_net_profit BETWEEN 50 AND 250\n  ))\n        ",
    ),
    (
        "queryq14",
        "\n with cross_items as (\n  select\n    i_item_sk ss_item_sk\n  from {{TABLE:item}}, (\n      select\n        iss.i_brand_id brand_id,\n        iss.i_class_id class_id,\n        iss.i_category_id category_id\n      from\n        {{TABLE:store_sales}}, {{TABLE:item}} iss, {{TABLE:date_dim}} d1\n      where\n        ss_item_sk = iss.i_item_sk\n          and ss_sold_date_sk = d1.d_date_sk\n          and d1.d_year between 1998 AND 1998 + 2\n      intersect\n      select\n        ics.i_brand_id,\n        ics.i_class_id,\n        ics.i_category_id\n      from\n        {{TABLE:catalog_sales}}, {{TABLE:item}} ics, {{TABLE:date_dim}} d2\n      where\n        cs_item_sk = ics.i_item_sk\n          and cs_sold_date_sk = d2.d_date_sk\n          and d2.d_year between 1998 AND 1998 + 2\n      intersect\n      select\n        iws.i_brand_id,\n        iws.i_class_id,\n        iws.i_category_id\n      from\n        {{TABLE:web_sales}}, {{TABLE:item}} iws, {{TABLE:date_dim}} d3\n      where\n        ws_item_sk = iws.i_item_sk\n          and ws_sold_date_sk = d3.d_date_sk\n          and d3.d_year between 1998 AND 1998 + 2) x\n      where\n        i_brand_id = brand_id\n          and i_class_id = class_id\n          and i_category_id = category_id),\navg_sales as (\n  select\n    avg(quantity*list_price) average_sales\n  from (\n      select\n        ss_quantity quantity,\n        ss_list_price list_price\n      from\n        {{TABLE:store_sales}}, {{TABLE:date_dim}}\n      where\n        ss_sold_date_sk = d_date_sk\n          and d_year between 1998 and 1998 + 2\n      union all\n      select\n        cs_quantity quantity,\n        cs_list_price list_price\n      from\n        {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n      where\n        cs_sold_date_sk = d_date_sk\n          and d_year between 1998 and 1998 + 2\n      union all\n      select\n        ws_quantity quantity,\n        ws_list_price list_price\n      from\n        {{TABLE:web_sales}}, {{TABLE:date_dim}}\n      where\n        ws_sold_date_sk = d_date_sk\n          and d_year between 1998 and 1998 + 2) x)\nselect\n  *\nfrom (\n    select\n      'store' channel,\n      i_brand_id,\n      i_class_id,\n      i_category_id,\n      sum(ss_quantity * ss_list_price) sales,\n      count(*) number_sales\n    from\n      {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n    where\n      ss_item_sk in (select ss_item_sk from cross_items)\n        and ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and d_week_seq = (\n            select d_week_seq\n            from {{TABLE:date_dim}}\n            where d_year = 1998 + 1\n              and d_moy = 12\n              and d_dom = 16)\n    group by\n      i_brand_id,\n      i_class_id,\n      i_category_id\n    having\n      sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\n  (\n    select\n      'store' channel,\n      i_brand_id,\n      i_class_id,\n      i_category_id,\n      sum(ss_quantity * ss_list_price) sales,\n      count(*) number_sales\n    from\n      {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n    where\n      ss_item_sk in (select ss_item_sk from cross_items)\n        and ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and d_week_seq = (\n            select d_week_seq\n            from {{TABLE:date_dim}}\n            where d_year = 1998\n              and d_moy = 12\n              and d_dom = 16)\n    group by\n      i_brand_id,\n      i_class_id,\n      i_category_id\n    having\n      sum(ss_quantity * ss_list_price) > (select average_sales from avg_sales)) last_year\nwhere\n  this_year.i_brand_id = last_year.i_brand_id\n    and this_year.i_class_id = last_year.i_class_id\n    and this_year.i_category_id = last_year.i_category_id\norder by\n  this_year.channel,\n  this_year.i_brand_id,\n  this_year.i_class_id,\n  this_year.i_category_id\n",
    ),
    (
        "queryq14a",
        "\n with cross_items as (\n    select\n      i_item_sk ss_item_sk\n    from {{TABLE:item}}, (\n        select\n          iss.i_brand_id brand_id,\n          iss.i_class_id class_id,\n          iss.i_category_id category_id\n        from\n          {{TABLE:store_sales}}, {{TABLE:item}} iss, {{TABLE:date_dim}} d1\n        where\n          ss_item_sk = iss.i_item_sk\n            and ss_sold_date_sk = d1.d_date_sk\n            and d1.d_year between 1999 AND 1999 + 2\n        intersect\n        select\n          ics.i_brand_id,\n          ics.i_class_id,\n          ics.i_category_id\n        from\n          {{TABLE:catalog_sales}}, {{TABLE:item}} ics, {{TABLE:date_dim}} d2\n        where\n          cs_item_sk = ics.i_item_sk\n            and cs_sold_date_sk = d2.d_date_sk\n            and d2.d_year between 1999 AND 1999 + 2\n        intersect\n        select\n          iws.i_brand_id,\n          iws.i_class_id,\n          iws.i_category_id\n        from\n          {{TABLE:web_sales}}, {{TABLE:item}} iws, {{TABLE:date_dim}} d3\n        where\n          ws_item_sk = iws.i_item_sk\n            and ws_sold_date_sk = d3.d_date_sk\n            and d3.d_year between 1999 AND 1999 + 2) x\n    where\n      i_brand_id = brand_id\n        and i_class_id = class_id\n        and i_category_id = category_id),\navg_sales as (\n    select\n      avg(quantity*list_price) average_sales\n    from (\n        select\n          ss_quantity quantity,\n          ss_list_price list_price\n         from\n           {{TABLE:store_sales}}, {{TABLE:date_dim}}\n         where\n           ss_sold_date_sk = d_date_sk\n             and d_year between 1999 and 2001\n         union all\n         select\n           cs_quantity quantity,\n           cs_list_price list_price\n         from\n           {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n         where\n           cs_sold_date_sk = d_date_sk\n             and d_year between 1998 and 1998 + 2\n         union all\n         select\n           ws_quantity quantity,\n           ws_list_price list_price\n         from\n           {{TABLE:web_sales}}, {{TABLE:date_dim}}\n         where\n           ws_sold_date_sk = d_date_sk\n             and d_year between 1998 and 1998 + 2) x),\nresults AS (\n    select\n      channel,\n      i_brand_id,\n      i_class_id,\n      i_category_id,\n      sum(sales) sum_sales,\n      sum(number_sales) number_sales\n    from (\n        select\n          'store' channel,\n          i_brand_id,i_class_id,\n          i_category_id,\n          sum(ss_quantity*ss_list_price) sales,\n          count(*) number_sales\n       from\n         {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       where\n         ss_item_sk in (select ss_item_sk from cross_items)\n           and ss_item_sk = i_item_sk\n           and ss_sold_date_sk = d_date_sk\n           and d_year = 1998 + 2\n           and d_moy = 11\n       group by\n         i_brand_id,\n         i_class_id,\n         i_category_id\n       having\n         sum(ss_quantity * ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select\n         'catalog' channel,\n         i_brand_id,\n         i_class_id,\n         i_category_id,\n         sum(cs_quantity*cs_list_price) sales,\n         count(*) number_sales\n       from\n         {{TABLE:catalog_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       where\n         cs_item_sk in (select ss_item_sk from cross_items)\n           and cs_item_sk = i_item_sk\n           and cs_sold_date_sk = d_date_sk\n           and d_year = 1998+2\n           and d_moy = 11\n       group by\n         i_brand_id,i_class_id,i_category_id\n       having\n         sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select\n         'web' channel,\n         i_brand_id,\n         i_class_id,\n         i_category_id,\n         sum(ws_quantity*ws_list_price) sales,\n         count(*) number_sales\n       from\n         {{TABLE:web_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       where\n         ws_item_sk in (select ss_item_sk from cross_items)\n           and ws_item_sk = i_item_sk\n           and ws_sold_date_sk = d_date_sk\n           and d_year = 1998 + 2\n           and d_moy = 11\n       group by\n         i_brand_id,\n         i_class_id,\n         i_category_id\n       having\n         sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)) y\n    group by\n      channel,\n      i_brand_id,\n      i_class_id,\n      i_category_id)\nselect\n  channel,\n  i_brand_id,\n  i_class_id,\n  i_category_id,\n  sum_sales,\n  number_sales\nfrom (\n    select\n      channel,\n      i_brand_id,\n      i_class_id,\n      i_category_id,\n      sum_sales,\n      number_sales\n    from\n      results\n    union\n    select\n      channel,\n      i_brand_id,\n      i_class_id,\n      null as i_category_id,\n      sum(sum_sales),\n      sum(number_sales)\n    from results\n    group by\n      channel,\n      i_brand_id,\n      i_class_id\n    union\n    select\n      channel,\n      i_brand_id,\n      null as i_class_id,\n      null as i_category_id,\n      sum(sum_sales),\n      sum(number_sales)\n    from results\n    group by\n      channel,\n      i_brand_id\n    union\n    select\n      channel,\n      null as i_brand_id,\n      null as i_class_id,\n      null as i_category_id,\n      sum(sum_sales),\n      sum(number_sales)\n    from results\n    group by\n      channel\n    union\n    select\n      null as channel,\n      null as i_brand_id,\n      null as i_class_id,\n      null as i_category_id,\n      sum(sum_sales),\n      sum(number_sales)\n    from results) z\norder by\n  channel,\n  i_brand_id,\n  i_class_id,\n  i_category_id\n",
    ),
    (
        "queryq14b",
        "\nWITH cross_items AS\n(SELECT i_item_sk ss_item_sk\n  FROM {{TABLE:item}},\n    (SELECT\n      iss.i_brand_id brand_id,\n      iss.i_class_id class_id,\n      iss.i_category_id category_id\n    FROM {{TABLE:store_sales}}, {{TABLE:item}} iss, {{TABLE:date_dim}} d1\n    WHERE ss_item_sk = iss.i_item_sk\n      AND ss_sold_date_sk = d1.d_date_sk\n      AND d1.d_year BETWEEN 1999 AND 1999 + 2\n    INTERSECT\n    SELECT\n      ics.i_brand_id,\n      ics.i_class_id,\n      ics.i_category_id\n    FROM {{TABLE:catalog_sales}}, {{TABLE:item}} ics, {{TABLE:date_dim}} d2\n    WHERE cs_item_sk = ics.i_item_sk\n      AND cs_sold_date_sk = d2.d_date_sk\n      AND d2.d_year BETWEEN 1999 AND 1999 + 2\n    INTERSECT\n    SELECT\n      iws.i_brand_id,\n      iws.i_class_id,\n      iws.i_category_id\n    FROM {{TABLE:web_sales}}, {{TABLE:item}} iws, {{TABLE:date_dim}} d3\n    WHERE ws_item_sk = iws.i_item_sk\n      AND ws_sold_date_sk = d3.d_date_sk\n      AND d3.d_year BETWEEN 1999 AND 1999 + 2) x\n  WHERE i_brand_id = brand_id\n    AND i_class_id = class_id\n    AND i_category_id = category_id\n),\n    avg_sales AS\n  (SELECT avg(quantity * list_price) average_sales\n  FROM (SELECT\n          ss_quantity quantity,\n          ss_list_price list_price\n        FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n        WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2\n        UNION ALL\n        SELECT\n          cs_quantity quantity,\n          cs_list_price list_price\n        FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n        WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2\n        UNION ALL\n        SELECT\n          ws_quantity quantity,\n          ws_list_price list_price\n        FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n        WHERE ws_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2) x)\nSELECT *\nFROM\n  (SELECT\n    'store' channel,\n    i_brand_id,\n    i_class_id,\n    i_category_id,\n    sum(ss_quantity * ss_list_price) sales,\n    count(*) number_sales\n  FROM {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n  WHERE ss_item_sk IN (SELECT ss_item_sk\n  FROM cross_items)\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_week_seq = (SELECT d_week_seq\n  FROM {{TABLE:date_dim}}\n  WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 11)\n  GROUP BY i_brand_id, i_class_id, i_category_id\n  HAVING sum(ss_quantity * ss_list_price) > (SELECT average_sales\n  FROM avg_sales)) this_year,\n  (SELECT\n    'store' channel,\n    i_brand_id,\n    i_class_id,\n    i_category_id,\n    sum(ss_quantity * ss_list_price) sales,\n    count(*) number_sales\n  FROM {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n  WHERE ss_item_sk IN (SELECT ss_item_sk\n  FROM cross_items)\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_week_seq = (SELECT d_week_seq\n  FROM {{TABLE:date_dim}}\n  WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 11)\n  GROUP BY i_brand_id, i_class_id, i_category_id\n  HAVING sum(ss_quantity * ss_list_price) > (SELECT average_sales\n  FROM avg_sales)) last_year\nWHERE this_year.i_brand_id = last_year.i_brand_id\n  AND this_year.i_class_id = last_year.i_class_id\n  AND this_year.i_category_id = last_year.i_category_id\nORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\n",
    ),
    (
        "queryq15",
        "\nSELECT\n  ca_zip,\n  sum(cs_sales_price)\nFROM {{TABLE:catalog_sales}} catalog_sales, {{TABLE:customer}} customer, {{TABLE:customer_address}} customer_address, {{TABLE:date_dim}} date_dim\nWHERE cs_bill_customer_sk = c_customer_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND (substr(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475',\n                                '85392', '85460', '80348', '81792')\n  OR ca_state IN ('CA', 'WA', 'GA')\n  OR cs_sales_price > 500)\n  AND cs_sold_date_sk = d_date_sk\n  AND d_qoy = 2 AND d_year = 2001\nGROUP BY ca_zip\nORDER BY ca_zip\n",
    ),
    (
        "queryq16",
        "\nSELECT\n  count(DISTINCT cs_order_number) AS `order count `,\n  sum(cs_ext_ship_cost) AS `total shipping cost `,\n  sum(cs_net_profit) AS `total net profit `\nFROM\n  {{TABLE:catalog_sales}} cs1, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:call_center}}\nWHERE\n  d_date BETWEEN '2002-02-01' AND (CAST('2002-02-01' AS DATE) + INTERVAL 60 days)\n    AND cs1.cs_ship_date_sk = d_date_sk\n    AND cs1.cs_ship_addr_sk = ca_address_sk\n    AND ca_state = 'GA'\n    AND cs1.cs_call_center_sk = cc_call_center_sk\n    AND cc_county IN\n    ('Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')\n    AND EXISTS(SELECT *\n               FROM {{TABLE:catalog_sales}} cs2\n               WHERE cs1.cs_order_number = cs2.cs_order_number\n                 AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\n    AND NOT EXISTS(SELECT *\n                   FROM {{TABLE:catalog_returns}} cr1\n                   WHERE cs1.cs_order_number = cr1.cr_order_number)\nORDER BY count(DISTINCT cs_order_number)\n",
    ),
    (
        "queryq17",
        "\nSELECT\n  i.i_item_id,\n  i.i_item_desc,\n  s.s_state,\n  COUNT(ss.ss_quantity) AS store_sales_quantitycount,\n  AVG(ss.ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss.ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss.ss_quantity)/AVG(ss.ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr.sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr.sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr.sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr.sr_return_quantity)/AVG(sr.sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs.cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs.cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs.cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs.cs_quantity)/AVG(cs.cs_quantity) AS catalog_sales_quantitycov\nFROM {{TABLE:store_sales}} ss\nJOIN {{TABLE:item}} i ON i.i_item_sk=ss.ss_item_sk\nJOIN {{TABLE:store}} s ON s.s_store_sk=ss.ss_store_sk\nJOIN {{TABLE:store_returns}} sr ON ss.ss_customer_sk=sr.sr_customer_sk AND ss.ss_item_sk=sr.sr_item_sk AND ss.ss_ticket_number=sr.sr_ticket_number\nJOIN {{TABLE:catalog_sales}} cs ON sr.sr_customer_sk=cs.cs_bill_customer_sk AND sr.sr_item_sk=cs.cs_item_sk\nJOIN {{TABLE:date_dim}} d1 ON d1.d_date_sk=ss.ss_sold_date_sk AND d1.d_quarter_name='2001Q1'\nJOIN {{TABLE:date_dim}} d2 ON d2.d_date_sk=sr.sr_returned_date_sk AND d2.d_quarter_name IN ('2001Q1','2001Q2','2001Q3')\nJOIN {{TABLE:date_dim}} d3 ON d3.d_date_sk=cs.cs_sold_date_sk AND d3.d_quarter_name IN ('2001Q1','2001Q2','2001Q3')\nGROUP BY i.i_item_id, i.i_item_desc, s.s_state\nORDER BY i.i_item_id, i.i_item_desc, s.s_state\n",
    ),
    (
        "queryq18",
        "\nSELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  avg(cast(cs_quantity AS DECIMAL(12, 2))) agg1,\n  avg(cast(cs_list_price AS DECIMAL(12, 2))) agg2,\n  avg(cast(cs_coupon_amt AS DECIMAL(12, 2))) agg3,\n  avg(cast(cs_sales_price AS DECIMAL(12, 2))) agg4,\n  avg(cast(cs_net_profit AS DECIMAL(12, 2))) agg5,\n  avg(cast(c_birth_year AS DECIMAL(12, 2))) agg6,\n  avg(cast(cd1.cd_dep_count AS DECIMAL(12, 2))) agg7\nFROM {{TABLE:catalog_sales}}, {{TABLE:customer_demographics}} cd1,\n  {{TABLE:customer_demographics}} cd2, {{TABLE:customer}}, {{TABLE:customer_address}}, {{TABLE:date_dim}}, {{TABLE:item}}\nWHERE cs_sold_date_sk = d_date_sk AND\n  cs_item_sk = i_item_sk AND\n  cs_bill_cdemo_sk = cd1.cd_demo_sk AND\n  cs_bill_customer_sk = c_customer_sk AND\n  cd1.cd_gender = 'F' AND\n  cd1.cd_education_status = 'Unknown' AND\n  c_current_cdemo_sk = cd2.cd_demo_sk AND\n  c_current_addr_sk = ca_address_sk AND\n  c_birth_month IN (1, 6, 8, 9, 12, 2) AND\n  d_year = 1998 AND\n  ca_state IN ('MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')\nGROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county)\nORDER BY ca_country, ca_state, ca_county, i_item_id\n",
    ),
    (
        "queryq18a",
        "\n with results as (\n    select\n      i_item_id,\n      ca_country,\n      ca_state,\n      ca_county,\n      cast(cs_quantity as decimal(12,2)) agg1,\n      cast(cs_list_price as decimal(12,2)) agg2,\n      cast(cs_coupon_amt as decimal(12,2)) agg3,\n      cast(cs_sales_price as decimal(12,2)) agg4,\n      cast(cs_net_profit as decimal(12,2)) agg5,\n      cast(c_birth_year as decimal(12,2)) agg6,\n      cast(cd1.cd_dep_count as decimal(12,2)) agg7\n    from\n      {{TABLE:catalog_sales}}, {{TABLE:customer_demographics}} cd1, {{TABLE:customer_demographics}} cd2, {{TABLE:customer}},\n      {{TABLE:customer_address}}, {{TABLE:date_dim}}, {{TABLE:item}}\n    where\n      cs_sold_date_sk = d_date_sk\n        and cs_item_sk = i_item_sk\n        and cs_bill_cdemo_sk = cd1.cd_demo_sk\n        and cs_bill_customer_sk = c_customer_sk\n        and cd1.cd_gender = 'M'\n        and cd1.cd_education_status = 'College'\n        and c_current_cdemo_sk = cd2.cd_demo_sk\n        and c_current_addr_sk = ca_address_sk\n        and c_birth_month in (9,5,12,4,1,10)\n        and d_year = 2001\n        and ca_state in ('ND','WI','AL','NC','OK','MS','TN'))\nselect\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  agg1,\n  agg2,\n  agg3,\n  agg4,\n  agg5,\n  agg6,\n  agg7\nfrom (\n    select\n      i_item_id,\n      ca_country,\n      ca_state,\n      ca_county,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4,\n      avg(agg5) agg5,\n      avg(agg6) agg6,\n      avg(agg7) agg7\n    from\n      results\n    group by\n      i_item_id,\n      ca_country,\n      ca_state,\n      ca_county\n    union all\n    select\n      i_item_id,\n      ca_country,\n      ca_state,\n      NULL as county,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4,\n      avg(agg5) agg5,\n      avg(agg6) agg6,\n      avg(agg7) agg7\n    from\n      results\n    group by\n      i_item_id,\n      ca_country,\n      ca_state\n    union all\n    select\n      i_item_id,\n      ca_country,\n      NULL as ca_state,\n      NULL as county,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4,\n      avg(agg5) agg5,\n      avg(agg6) agg6,\n      avg(agg7) agg7\n    from results\n    group by\n      i_item_id,\n      ca_country\n    union all\n    select\n      i_item_id,\n      NULL as ca_country,\n      NULL as ca_state,\n      NULL as county,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4,\n      avg(agg5) agg5,\n      avg(agg6) agg6,\n      avg(agg7) agg7\n    from results\n    group by\n      i_item_id\n    union all\n    select\n      NULL AS i_item_id,\n      NULL as ca_country,\n      NULL as ca_state,\n      NULL as county,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4,\n      avg(agg5) agg5,\n      avg(agg6) agg6,\n      avg(agg7) agg7\n    from results) foo\norder by\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\n",
    ),
    (
        "queryq19",
        "\nSELECT\n  i_brand_id brand_id,\n  i_brand brand,\n  i_manufact_id,\n  i_manufact,\n  sum(ss_ext_sales_price) ext_price\nFROM {{TABLE:date_dim}}, {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:customer}}, {{TABLE:customer_address}}, {{TABLE:store}}\nWHERE d_date_sk = ss_sold_date_sk\n  AND ss_item_sk = i_item_sk\n  AND i_manager_id = 8\n  AND d_moy = 11\n  AND d_year = 1998\n  AND ss_customer_sk = c_customer_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND substr(ca_zip, 1, 5) <> substr(s_zip, 1, 5)\n  AND ss_store_sk = s_store_sk\nGROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact\nORDER BY ext_price DESC, brand, brand_id, i_manufact_id, i_manufact\n",
    ),
    (
        "queryq20",
        "\nSELECT\n  i_item_id, \n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  sum(cs_ext_sales_price) AS itemrevenue,\n  sum(cs_ext_sales_price) * 100 / sum(sum(cs_ext_sales_price))\n  OVER\n  (PARTITION BY i_class) AS revenueratio\nFROM {{TABLE:catalog_sales}} catalog_sales, {{TABLE:item}} item, {{TABLE:date_dim}} date_dim\nWHERE cs_item_sk = i_item_sk\n  AND i_category IN ('Sports', 'Books', 'Home')\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN cast('1999-02-22' AS DATE)\nAND (cast('1999-02-22' AS DATE) + INTERVAL 30 days)\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price\nORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio\n",
    ),
    (
        "queryq21",
        "\nSELECT *\nFROM (\n       SELECT\n         w_warehouse_name,\n         i_item_id,\n         sum(CASE WHEN (cast(d_date AS DATE) < cast('2000-03-11' AS DATE))\n           THEN inv_quantity_on_hand\n             ELSE 0 END) AS inv_before,\n         sum(CASE WHEN (cast(d_date AS DATE) >= cast('2000-03-11' AS DATE))\n           THEN inv_quantity_on_hand\n             ELSE 0 END) AS inv_after\n       FROM {{TABLE:inventory}}, {{TABLE:warehouse}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       WHERE i_current_price BETWEEN 0.99 AND 1.49\n         AND i_item_sk = inv_item_sk\n         AND inv_warehouse_sk = w_warehouse_sk\n         AND inv_date_sk = d_date_sk\n         AND d_date BETWEEN (cast('2000-03-11' AS DATE) - INTERVAL 30 days)\n       AND (cast('2000-03-11' AS DATE) + INTERVAL 30 days)\n       GROUP BY w_warehouse_name, i_item_id) x\nWHERE (CASE WHEN inv_before > 0\n  THEN inv_after / inv_before\n       ELSE NULL\n       END) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY w_warehouse_name, i_item_id\n",
    ),
    (
        "queryq22",
        "\nSELECT\n  i_product_name,\n  i_brand,\n  i_class,\n  i_category,\n  avg(inv_quantity_on_hand) qoh\nFROM {{TABLE:inventory}}, {{TABLE:date_dim}}, {{TABLE:item}}, {{TABLE:warehouse}}\nWHERE inv_date_sk = d_date_sk\n  AND inv_item_sk = i_item_sk\n  -- q22 in TPCDS v1.4 had a condition below:\n  -- AND inv_warehouse_sk = w_warehouse_sk\n  AND d_month_seq BETWEEN 1200 AND 1200 + 11\nGROUP BY ROLLUP (i_product_name, i_brand, i_class, i_category)\nORDER BY qoh, i_product_name, i_brand, i_class, i_category\n",
    ),
    (
        "queryq22a",
        "\n with results as (\n    select\n      i_product_name,\n      i_brand,\n      i_class,\n      i_category,\n      avg(inv_quantity_on_hand) qoh\n    from\n      {{TABLE:inventory}}, {{TABLE:date_dim}}, {{TABLE:item}}, {{TABLE:warehouse}}\n    where\n      inv_date_sk = d_date_sk\n        and inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and d_month_seq between 1212 and 1212 + 11\n    group by\n      i_product_name,\n      i_brand,\n      i_class,\n      i_category),\nresults_rollup as (\n    select\n      i_product_name,\n      i_brand,\n      i_class,\n      i_category,\n      avg(qoh) qoh\n    from\n      results\n    group by\n      i_product_name,\n      i_brand,\n      i_class,\n      i_category\n    union all\n    select\n      i_product_name,\n      i_brand,\n      i_class,\n      null i_category,\n      avg(qoh) qoh\n    from\n      results\n    group by\n      i_product_name,\n      i_brand,\n      i_class\n    union all\n    select\n      i_product_name,\n      i_brand,\n      null i_class,\n      null i_category,\n      avg(qoh) qoh\n    from\n      results\n    group by\n      i_product_name,\n      i_brand\n    union all\n    select\n      i_product_name,\n      null i_brand,\n      null i_class,\n      null i_category,\n      avg(qoh) qoh\n    from\n      results\n    group by\n      i_product_name\n    union all\n    select\n      null i_product_name,\n      null i_brand,\n      null i_class,\n      null i_category,\n      avg(qoh) qoh\n    from\n      results)\nselect\n  i_product_name,\n  i_brand,\n  i_class,\n  i_category,\n  qoh\nfrom\n  results_rollup\norder by\n  qoh,\n  i_product_name,\n  i_brand,\n  i_class,\n  i_category\n",
    ),
    (
        "queryq23a",
        "\nWITH frequent_ss_items AS\n(SELECT\n    substr(i_item_desc, 1, 30) itemdesc,\n    i_item_sk item_sk,\n    d_date solddate,\n    count(*) cnt\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:item}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY substr(i_item_desc, 1, 30), i_item_sk, d_date\n  HAVING count(*) > 4),\n    max_store_sales AS\n  (SELECT max(csales) tpcds_cmax\n  FROM (SELECT\n    c_customer_sk,\n    sum(ss_quantity * ss_sales_price) csales\n  FROM {{TABLE:store_sales}}, {{TABLE:customer}}, {{TABLE:date_dim}}\n  WHERE ss_customer_sk = c_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY c_customer_sk) x),\n    best_ss_customer AS\n  (SELECT\n    c_customer_sk,\n    sum(ss_quantity * ss_sales_price) ssales\n  FROM {{TABLE:store_sales}}, {{TABLE:customer}}\n  WHERE ss_customer_sk = c_customer_sk\n  GROUP BY c_customer_sk\n  HAVING sum(ss_quantity * ss_sales_price) > (50 / 100.0) *\n    (SELECT *\n    FROM max_store_sales))\nSELECT sum(sales)\nFROM ((SELECT cs_quantity * cs_list_price sales\nFROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\nWHERE d_year = 2000\n  AND d_moy = 2\n  AND cs_sold_date_sk = d_date_sk\n  AND cs_item_sk IN (SELECT item_sk\nFROM frequent_ss_items)\n  AND cs_bill_customer_sk IN (SELECT c_customer_sk\nFROM best_ss_customer))\n      UNION ALL\n      (SELECT ws_quantity * ws_list_price sales\n      FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n      WHERE d_year = 2000\n        AND d_moy = 2\n        AND ws_sold_date_sk = d_date_sk\n        AND ws_item_sk IN (SELECT item_sk\n      FROM frequent_ss_items)\n        AND ws_bill_customer_sk IN (SELECT c_customer_sk\n      FROM best_ss_customer))) y\n",
    ),
    (
        "queryq23b",
        "\nWITH frequent_ss_items AS\n(SELECT\n    substr(i_item_desc, 1, 30) itemdesc,\n    i_item_sk item_sk,\n    d_date solddate,\n    count(*) cnt\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:item}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY substr(i_item_desc, 1, 30), i_item_sk, d_date\n  HAVING count(*) > 4),\n    max_store_sales AS\n  (SELECT max(csales) tpcds_cmax\n  FROM (SELECT\n    c_customer_sk,\n    sum(ss_quantity * ss_sales_price) csales\n  FROM {{TABLE:store_sales}}, {{TABLE:customer}}, {{TABLE:date_dim}}\n  WHERE ss_customer_sk = c_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY c_customer_sk) x),\n    best_ss_customer AS\n  (SELECT\n    c_customer_sk,\n    sum(ss_quantity * ss_sales_price) ssales\n  FROM {{TABLE:store_sales}}\n    , {{TABLE:customer}}\n  WHERE ss_customer_sk = c_customer_sk\n  GROUP BY c_customer_sk\n  HAVING sum(ss_quantity * ss_sales_price) > (50 / 100.0) *\n    (SELECT *\n    FROM max_store_sales))\nSELECT\n  c_last_name,\n  c_first_name,\n  sales\nFROM ((SELECT\n  c_last_name,\n  c_first_name,\n  sum(cs_quantity * cs_list_price) sales\nFROM {{TABLE:catalog_sales}}, {{TABLE:customer}}, {{TABLE:date_dim}}\nWHERE d_year = 2000\n  AND d_moy = 2\n  AND cs_sold_date_sk = d_date_sk\n  AND cs_item_sk IN (SELECT item_sk\nFROM frequent_ss_items)\n  AND cs_bill_customer_sk IN (SELECT c_customer_sk\nFROM best_ss_customer)\n  AND cs_bill_customer_sk = c_customer_sk\nGROUP BY c_last_name, c_first_name)\n      UNION ALL\n      (SELECT\n        c_last_name,\n        c_first_name,\n        sum(ws_quantity * ws_list_price) sales\n      FROM {{TABLE:web_sales}}, {{TABLE:customer}}, {{TABLE:date_dim}}\n      WHERE d_year = 2000\n        AND d_moy = 2\n        AND ws_sold_date_sk = d_date_sk\n        AND ws_item_sk IN (SELECT item_sk\n      FROM frequent_ss_items)\n        AND ws_bill_customer_sk IN (SELECT c_customer_sk\n      FROM best_ss_customer)\n        AND ws_bill_customer_sk = c_customer_sk\n      GROUP BY c_last_name, c_first_name)) y\nORDER BY c_last_name, c_first_name, sales\n",
    ),
    (
        "queryq24",
        "\nWITH ssales AS\n(SELECT\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size,\n    sum(ss_net_paid) netpaid\n  FROM {{TABLE:store_sales}}, {{TABLE:store_returns}}, {{TABLE:store}}, {{TABLE:item}}, {{TABLE:customer}}, {{TABLE:customer_address}}\n  WHERE ss_ticket_number = sr_ticket_number\n    AND ss_item_sk = sr_item_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND c_current_addr_sk = ca_address_sk -- This condition did not exist in TPCDS v1.4\n    AND c_birth_country = upper(ca_country)\n    AND s_zip = ca_zip\n    AND s_market_id = 8\n  GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color,\n    i_current_price, i_manager_id, i_units, i_size)\nSELECT\n  c_last_name,\n  c_first_name,\n  s_store_name,\n  sum(netpaid) paid\nFROM ssales\nWHERE i_color = 'pale'\nGROUP BY c_last_name, c_first_name, s_store_name\nHAVING sum(netpaid) > (SELECT 0.05 * avg(netpaid)\nFROM ssales)\n-- no order-by exists in q24a of TPCDS v1.4\nORDER BY\n  c_last_name,\n  c_first_name,\n  s_store_name\n        ",
    ),
    (
        "queryq24a",
        "\nWITH ssales AS\n(SELECT\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size,\n    sum(ss_net_paid) netpaid\n  FROM {{TABLE:store_sales}}, {{TABLE:store_returns}}, {{TABLE:store}}, {{TABLE:item}}, {{TABLE:customer}}, {{TABLE:customer_address}}\n  WHERE ss_ticket_number = sr_ticket_number\n    AND ss_item_sk = sr_item_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND c_birth_country = upper(ca_country)\n    AND s_zip = ca_zip\n    AND s_market_id = 8\n  GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color,\n    i_current_price, i_manager_id, i_units, i_size)\nSELECT\n  c_last_name,\n  c_first_name,\n  s_store_name,\n  sum(netpaid) paid\nFROM ssales\nWHERE i_color = 'pale'\nGROUP BY c_last_name, c_first_name, s_store_name\nHAVING sum(netpaid) > (SELECT 0.05 * avg(netpaid)\nFROM ssales)\n        ",
    ),
    (
        "queryq24b",
        "\nWITH ssales AS\n(SELECT\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size,\n    sum(ss_net_paid) netpaid\n  FROM {{TABLE:store_sales}}, {{TABLE:store_returns}}, {{TABLE:store}}, {{TABLE:item}}, {{TABLE:customer}}, {{TABLE:customer_address}}\n  WHERE ss_ticket_number = sr_ticket_number\n    AND ss_item_sk = sr_item_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND c_birth_country = upper(ca_country)\n    AND s_zip = ca_zip\n    AND s_market_id = 8\n  GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state,\n    i_color, i_current_price, i_manager_id, i_units, i_size)\nSELECT\n  c_last_name,\n  c_first_name,\n  s_store_name,\n  sum(netpaid) paid\nFROM ssales\nWHERE i_color = 'chiffon'\nGROUP BY c_last_name, c_first_name, s_store_name\nHAVING sum(netpaid) > (SELECT 0.05 * avg(netpaid)\nFROM ssales)\n        ",
    ),
    (
        "queryq25",
        "\nSELECT\n  i.i_item_id,\n  i.i_item_desc,\n  s.s_store_id,\n  s.s_store_name,\n  SUM(ss.ss_net_profit) AS store_sales_profit,\n  SUM(sr.sr_net_loss)   AS store_returns_loss,\n  SUM(cs.cs_net_profit) AS catalog_sales_profit\nFROM {{TABLE:store_sales}} ss\nJOIN {{TABLE:item}} i           ON i.i_item_sk = ss.ss_item_sk\nJOIN {{TABLE:store}} s          ON s.s_store_sk = ss.ss_store_sk\nJOIN {{TABLE:store_returns}} sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number\nJOIN {{TABLE:catalog_sales}} cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk\nJOIN {{TABLE:date_dim}} d1      ON d1.d_date_sk = ss.ss_sold_date_sk AND d1.d_moy = 4 AND d1.d_year = 2001\nJOIN {{TABLE:date_dim}} d2      ON d2.d_date_sk = sr.sr_returned_date_sk AND d2.d_moy BETWEEN 4 AND 10 AND d2.d_year = 2001\nJOIN {{TABLE:date_dim}} d3      ON d3.d_date_sk = cs.cs_sold_date_sk AND d3.d_moy BETWEEN 4 AND 10 AND d3.d_year = 2001\nGROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name\nORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name\n",
    ),
    (
        "queryq26",
        "\nSELECT\n  i_item_id,\n  avg(cs_quantity) agg1,\n  avg(cs_list_price) agg2,\n  avg(cs_coupon_amt) agg3,\n  avg(cs_sales_price) agg4\nFROM {{TABLE:catalog_sales}}, {{TABLE:customer_demographics}}, {{TABLE:date_dim}}, {{TABLE:item}}, {{TABLE:promotion}}\nWHERE cs_sold_date_sk = d_date_sk AND\n  cs_item_sk = i_item_sk AND\n  cs_bill_cdemo_sk = cd_demo_sk AND\n  cs_promo_sk = p_promo_sk AND\n  cd_gender = 'M' AND\n  cd_marital_status = 'S' AND\n  cd_education_status = 'College' AND\n  (p_channel_email = 'N' OR p_channel_event = 'N') AND\n  d_year = 2000\nGROUP BY i_item_id\nORDER BY i_item_id\n",
    ),
    (
        "queryq27",
        "\nSELECT\n  i_item_id,\n  s_state,\n  grouping(s_state) g_state,\n  avg(ss_quantity) agg1,\n  avg(ss_list_price) agg2,\n  avg(ss_coupon_amt) agg3,\n  avg(ss_sales_price) agg4\nFROM {{TABLE:store_sales}}, {{TABLE:customer_demographics}}, {{TABLE:date_dim}}, {{TABLE:store}}, {{TABLE:item}}\nWHERE ss_sold_date_sk = d_date_sk AND\n  ss_item_sk = i_item_sk AND\n  ss_store_sk = s_store_sk AND\n  ss_cdemo_sk = cd_demo_sk AND\n  cd_gender = 'M' AND\n  cd_marital_status = 'S' AND\n  cd_education_status = 'College' AND\n  d_year = 2002 AND\n  s_state IN ('TN', 'TN', 'TN', 'TN', 'TN', 'TN')\nGROUP BY ROLLUP (i_item_id, s_state)\nORDER BY i_item_id, s_state\n",
    ),
    (
        "queryq27a",
        "\n with results as (\n    select\n        i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n    from\n      {{TABLE:store_sales}}, {{TABLE:customer_demographics}}, {{TABLE:date_dim}}, {{TABLE:store}}, {{TABLE:item}}\n    where\n      ss_sold_date_sk = d_date_sk\n        and ss_item_sk = i_item_sk\n        and ss_store_sk = s_store_sk\n        and ss_cdemo_sk = cd_demo_sk\n        and cd_gender = 'F'\n        and cd_marital_status = 'W'\n        and cd_education_status = 'Primary'\n        and d_year = 1998\n        and s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN'))\nselect\n  i_item_id,\n  s_state,\n  g_state,\n  agg1,\n  agg2,\n  agg3,\n  agg4\nfrom (\n    select\n      i_item_id,\n      s_state,\n      0 as g_state,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4\n    from\n      results\n    group by\n      i_item_id,\n      s_state\n    union all\n    select\n      i_item_id,\n      NULL AS s_state,\n      1 AS g_state,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4\n    from results\n    group by\n      i_item_id\n    union all\n    select\n      NULL AS i_item_id,\n      NULL as s_state,\n      1 as g_state,\n      avg(agg1) agg1,\n      avg(agg2) agg2,\n      avg(agg3) agg3,\n      avg(agg4) agg4\n    from\n      results) foo\norder by\n  i_item_id,\n  s_state\n",
    ),
    (
        "queryq28",
        "\nSELECT *\nFROM (SELECT\n  avg(ss_list_price) B1_LP,\n  count(ss_list_price) B1_CNT,\n  count(DISTINCT ss_list_price) B1_CNTD\nFROM {{TABLE:store_sales}}\nWHERE ss_quantity BETWEEN 0 AND 5\n  AND (ss_list_price BETWEEN 8 AND 8 + 10\n  OR ss_coupon_amt BETWEEN 459 AND 459 + 1000\n  OR ss_wholesale_cost BETWEEN 57 AND 57 + 20)) B1,\n  (SELECT\n    avg(ss_list_price) B2_LP,\n    count(ss_list_price) B2_CNT,\n    count(DISTINCT ss_list_price) B2_CNTD\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 6 AND 10\n    AND (ss_list_price BETWEEN 90 AND 90 + 10\n    OR ss_coupon_amt BETWEEN 2323 AND 2323 + 1000\n    OR ss_wholesale_cost BETWEEN 31 AND 31 + 20)) B2,\n  (SELECT\n    avg(ss_list_price) B3_LP,\n    count(ss_list_price) B3_CNT,\n    count(DISTINCT ss_list_price) B3_CNTD\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 11 AND 15\n    AND (ss_list_price BETWEEN 142 AND 142 + 10\n    OR ss_coupon_amt BETWEEN 12214 AND 12214 + 1000\n    OR ss_wholesale_cost BETWEEN 79 AND 79 + 20)) B3,\n  (SELECT\n    avg(ss_list_price) B4_LP,\n    count(ss_list_price) B4_CNT,\n    count(DISTINCT ss_list_price) B4_CNTD\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 16 AND 20\n    AND (ss_list_price BETWEEN 135 AND 135 + 10\n    OR ss_coupon_amt BETWEEN 6071 AND 6071 + 1000\n    OR ss_wholesale_cost BETWEEN 38 AND 38 + 20)) B4,\n  (SELECT\n    avg(ss_list_price) B5_LP,\n    count(ss_list_price) B5_CNT,\n    count(DISTINCT ss_list_price) B5_CNTD\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 21 AND 25\n    AND (ss_list_price BETWEEN 122 AND 122 + 10\n    OR ss_coupon_amt BETWEEN 836 AND 836 + 1000\n    OR ss_wholesale_cost BETWEEN 17 AND 17 + 20)) B5,\n  (SELECT\n    avg(ss_list_price) B6_LP,\n    count(ss_list_price) B6_CNT,\n    count(DISTINCT ss_list_price) B6_CNTD\n  FROM {{TABLE:store_sales}}\n  WHERE ss_quantity BETWEEN 26 AND 30\n    AND (ss_list_price BETWEEN 154 AND 154 + 10\n    OR ss_coupon_amt BETWEEN 7326 AND 7326 + 1000\n    OR ss_wholesale_cost BETWEEN 7 AND 7 + 20)) B6\n",
    ),
    (
        "queryq29",
        "\nSELECT\n  i.i_item_id,\n  i.i_item_desc,\n  s.s_store_id,\n  s.s_store_name,\n  SUM(ss.ss_quantity)        AS store_sales_quantity,\n  SUM(sr.sr_return_quantity) AS store_returns_quantity,\n  SUM(cs.cs_quantity)        AS catalog_sales_quantity\nFROM {{TABLE:store_sales}} ss\nJOIN {{TABLE:item}} i           ON i.i_item_sk = ss.ss_item_sk\nJOIN {{TABLE:store}} s          ON s.s_store_sk = ss.ss_store_sk\nJOIN {{TABLE:store_returns}} sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number\nJOIN {{TABLE:catalog_sales}} cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk\nJOIN {{TABLE:date_dim}} d1      ON d1.d_date_sk = ss.ss_sold_date_sk AND d1.d_moy = 9 AND d1.d_year = 1999\nJOIN {{TABLE:date_dim}} d2      ON d2.d_date_sk = sr.sr_returned_date_sk AND d2.d_moy BETWEEN 9 AND 9 + 3 AND d2.d_year = 1999\nJOIN {{TABLE:date_dim}} d3      ON d3.d_date_sk = cs.cs_sold_date_sk AND d3.d_year IN (1999, 1999 + 1, 1999 + 2)\nGROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name\nORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name\n",
    ),
    (
        "queryq30",
        "\nWITH customer_total_return AS (\n  SELECT\n    wr.wr_returning_customer_sk AS ctr_customer_sk,\n    ca.ca_state       AS ctr_state,\n    SUM(wr.wr_return_amt) AS ctr_total_return\n  FROM {{TABLE:web_returns}} wr\n  JOIN {{TABLE:date_dim}} d       ON wr.wr_returned_date_sk = d.d_date_sk AND d.d_year = 2002\n  JOIN {{TABLE:customer_address}} ca ON wr.wr_returning_addr_sk = ca.ca_address_sk\n  GROUP BY wr.wr_returning_customer_sk, ca.ca_state\n)\nSELECT\n  c.c_customer_id,\n  c.c_salutation,\n  c.c_first_name,\n  c.c_last_name,\n  c.c_preferred_cust_flag,\n  c.c_birth_day,\n  c.c_birth_month,\n  c.c_birth_year,\n  c.c_birth_country,\n  c.c_login,\n  c.c_email_address,\n  dr.d_date AS c_last_review_date,\n  ctr1.ctr_total_return\nFROM customer_total_return ctr1\nJOIN {{TABLE:customer}} c          ON ctr1.ctr_customer_sk = c.c_customer_sk\nJOIN {{TABLE:customer_address}} ca ON ca.ca_address_sk = c.c_current_addr_sk AND ca.ca_state = 'GA'\nLEFT JOIN {{TABLE:date_dim}} dr    ON c.c_last_review_date_sk = dr.d_date_sk\nWHERE ctr1.ctr_total_return > (\n  SELECT AVG(ctr2.ctr_total_return) * 1.2\n  FROM customer_total_return ctr2\n  WHERE ctr1.ctr_state = ctr2.ctr_state\n)\nORDER BY\n  c.c_customer_id, c.c_salutation, c.c_first_name, c.c_last_name,\n  c.c_preferred_cust_flag, c.c_birth_day, c.c_birth_month, c.c_birth_year,\n  c.c_birth_country, c.c_login, c.c_email_address, dr.d_date,\n  ctr1.ctr_total_return\n",
    ),
    (
        "queryq31",
        "\nWITH ss AS\n(SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    sum(ss_ext_sales_price) AS store_sales\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n  GROUP BY ca_county, d_qoy, d_year),\n    ws AS\n  (SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    sum(ws_ext_sales_price) AS web_sales\n  FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}\n  WHERE ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY ca_county, d_qoy, d_year)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales store_q2_q3_increase\nFROM\n  ss ss1, ss ss2, ss ss3, ws ws1, ws ws2, ws ws3\nWHERE\n  ss1.d_qoy = 1\n    AND ss1.d_year = 2000\n    AND ss1.ca_county = ss2.ca_county\n    AND ss2.d_qoy = 2\n    AND ss2.d_year = 2000\n    AND ss2.ca_county = ss3.ca_county\n    AND ss3.d_qoy = 3\n    AND ss3.d_year = 2000\n    AND ss1.ca_county = ws1.ca_county\n    AND ws1.d_qoy = 1\n    AND ws1.d_year = 2000\n    AND ws1.ca_county = ws2.ca_county\n    AND ws2.d_qoy = 2\n    AND ws2.d_year = 2000\n    AND ws1.ca_county = ws3.ca_county\n    AND ws3.d_qoy = 3\n    AND ws3.d_year = 2000\n    AND CASE WHEN ws1.web_sales > 0\n    THEN ws2.web_sales / ws1.web_sales\n        ELSE NULL END\n    > CASE WHEN ss1.store_sales > 0\n    THEN ss2.store_sales / ss1.store_sales\n      ELSE NULL END\n    AND CASE WHEN ws2.web_sales > 0\n    THEN ws3.web_sales / ws2.web_sales\n        ELSE NULL END\n    > CASE WHEN ss2.store_sales > 0\n    THEN ss3.store_sales / ss2.store_sales\n      ELSE NULL END\nORDER BY ss1.ca_county\n        ",
    ),
    (
        "queryq32",
        "\nSELECT sum(cs_ext_discount_amt) AS `excess discount amount`\nFROM\n  {{TABLE:catalog_sales}} catalog_sales, {{TABLE:item}} item, {{TABLE:date_dim}} date_dim\nWHERE\n  i_manufact_id = 977\n    AND i_item_sk = cs_item_sk\n    AND d_date BETWEEN '2000-01-27' AND (cast('2000-01-27' AS DATE) + interval 90 days)\n    AND d_date_sk = cs_sold_date_sk\n    AND cs_ext_discount_amt > (\n    SELECT 1.3 * avg(cs_ext_discount_amt)\n    FROM {{TABLE:catalog_sales}} catalog_sales, {{TABLE:date_dim}} date_dim\n    WHERE cs_item_sk = i_item_sk\n      AND d_date BETWEEN '2000-01-27' AND (cast('2000-01-27' AS DATE) + interval 90 days)\n      AND d_date_sk = cs_sold_date_sk)\n",
    ),
    (
        "queryq33",
        "\nWITH ss AS (\n  SELECT\n    i_manufact_id,\n    sum(ss_ext_sales_price) total_sales\n  FROM\n    {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:item}}\n  WHERE\n    i_manufact_id IN (SELECT i_manufact_id\n    FROM {{TABLE:item}}\n    WHERE i_category IN ('Electronics'))\n      AND ss_item_sk = i_item_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year = 1998\n      AND d_moy = 5\n      AND ss_addr_sk = ca_address_sk\n      AND ca_gmt_offset = -5\n  GROUP BY i_manufact_id), cs AS\n(SELECT\n    i_manufact_id,\n    sum(cs_ext_sales_price) total_sales\n  FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:item}}\n  WHERE\n    i_manufact_id IN (\n      SELECT i_manufact_id\n      FROM {{TABLE:item}}\n      WHERE\n        i_category IN ('Electronics'))\n      AND cs_item_sk = i_item_sk\n      AND cs_sold_date_sk = d_date_sk\n      AND d_year = 1998\n      AND d_moy = 5\n      AND cs_bill_addr_sk = ca_address_sk\n      AND ca_gmt_offset = -5\n  GROUP BY i_manufact_id),\n    ws AS (\n    SELECT\n      i_manufact_id,\n      sum(ws_ext_sales_price) total_sales\n    FROM\n      {{TABLE:web_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:item}}\n    WHERE\n      i_manufact_id IN (SELECT i_manufact_id\n      FROM {{TABLE:item}}\n      WHERE i_category IN ('Electronics'))\n        AND ws_item_sk = i_item_sk\n        AND ws_sold_date_sk = d_date_sk\n        AND d_year = 1998\n        AND d_moy = 5\n        AND ws_bill_addr_sk = ca_address_sk\n        AND ca_gmt_offset = -5\n    GROUP BY i_manufact_id)\nSELECT\n  i_manufact_id,\n  sum(total_sales) total_sales\nFROM (SELECT *\n      FROM ss\n      UNION ALL\n      SELECT *\n      FROM cs\n      UNION ALL\n      SELECT *\n      FROM ws) tmp1\nGROUP BY i_manufact_id\nORDER BY total_sales\n",
    ),
    (
        "queryq34",
        "\nSELECT\n  c.c_last_name,\n  c.c_first_name,\n  c.c_salutation,\n  c.c_preferred_cust_flag,\n  dn.ss_ticket_number,\n  dn.cnt\nFROM (\n  SELECT\n    ss.ss_ticket_number,\n    ss.ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM {{TABLE:store_sales}} ss\n  JOIN {{TABLE:date_dim}} d   ON ss.ss_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:store}} s      ON ss.ss_store_sk     = s.s_store_sk\n  JOIN {{TABLE:household_demographics}} hd ON ss.ss_hdemo_sk = hd.hd_demo_sk\n  WHERE (d.d_dom BETWEEN 1 AND 3 OR d.d_dom BETWEEN 25 AND 28)\n    AND (hd.hd_buy_potential = '>10000' OR hd.hd_buy_potential = 'unknown')\n    AND hd.hd_vehicle_count > 0\n    AND (CASE WHEN hd.hd_vehicle_count > 0 THEN hd.hd_dep_count / hd.hd_vehicle_count ELSE NULL END) > 1.2\n    AND d.d_year IN (1999, 1999 + 1, 1999 + 2)\n    AND s.s_county IN ('Williamson County','Williamson County','Williamson County','Williamson County','Williamson County','Williamson County','Williamson County','Williamson County')\n  GROUP BY ss.ss_ticket_number, ss.ss_customer_sk\n) dn\nJOIN {{TABLE:customer}} c ON dn.ss_customer_sk = c.c_customer_sk\nWHERE dn.cnt BETWEEN 15 AND 20\nORDER BY\n  c.c_last_name,\n  c.c_first_name,\n  c.c_salutation,\n  c.c_preferred_cust_flag DESC,\n  dn.ss_ticket_number\n        ",
    ),
    (
        "queryq35",
        "\nSELECT\n  -- ca_state,\n  -- cd_gender,\n  -- cd_marital_status,\n  -- count(*) cnt1,\n  -- min(cd_dep_count),\n  -- max(cd_dep_count),\n  -- avg(cd_dep_count),\n  -- cd_dep_employed_count,\n  -- count(*) cnt2,\n  -- min(cd_dep_employed_count),\n  -- max(cd_dep_employed_count),\n  -- avg(cd_dep_employed_count),\n  -- cd_dep_college_count,\n  -- count(*) cnt3,\n  -- min(cd_dep_college_count),\n  -- max(cd_dep_college_count),\n  -- avg(cd_dep_college_count)\n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  avg(cd_dep_count),\n  max(cd_dep_count),\n  sum(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  avg(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  sum(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  avg(cd_dep_college_count),\n  max(cd_dep_college_count),\n  sum(cd_dep_college_count)\nFROM\n  {{TABLE:customer}} c, {{TABLE:customer_address}} ca, {{TABLE:customer_demographics}}\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk AND\n    cd_demo_sk = c.c_current_cdemo_sk AND\n    exists(SELECT *\n           FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n           WHERE c.c_customer_sk = ss_customer_sk AND\n             ss_sold_date_sk = d_date_sk AND\n             d_year = 2002 AND\n             d_qoy < 4) AND\n    (exists(SELECT *\n            FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n            WHERE c.c_customer_sk = ws_bill_customer_sk AND\n              ws_sold_date_sk = d_date_sk AND\n              d_year = 2002 AND\n              d_qoy < 4) OR\n      exists(SELECT *\n             FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n             WHERE c.c_customer_sk = cs_ship_customer_sk AND\n               cs_sold_date_sk = d_date_sk AND\n               d_year = 2002 AND\n               d_qoy < 4))\nGROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count,\n  cd_dep_employed_count, cd_dep_college_count\nORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count,\n  cd_dep_employed_count, cd_dep_college_count\n",
    ),
    (
        "queryq35a",
        "\n select\n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  avg(cd_dep_count),\n  max(cd_dep_count),\n  sum(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  avg(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  sum(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  avg(cd_dep_college_count),\n  max(cd_dep_college_count),\n  sum(cd_dep_college_count)\nfrom\n  {{TABLE:customer}} c, {{TABLE:customer_address}} ca, {{TABLE:customer_demographics}}\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk\n    and cd_demo_sk = c.c_current_cdemo_sk\n    and exists (\n        select *\n        from {{TABLE:store_sales}}, {{TABLE:date_dim}}\n        where c.c_customer_sk = ss_customer_sk\n          and ss_sold_date_sk = d_date_sk\n          and d_year = 1999\n          and d_qoy < 4)\n    and exists (\n        select *\n        from (\n            select ws_bill_customer_sk customsk\n            from {{TABLE:web_sales}}, {{TABLE:date_dim}}\n            where ws_sold_date_sk = d_date_sk\n              and d_year = 1999\n              and d_qoy < 4\n        union all\n        select cs_ship_customer_sk customsk\n        from {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n        where cs_sold_date_sk = d_date_sk\n          and d_year = 1999\n          and d_qoy < 4) x\n        where x.customsk = c.c_customer_sk)\ngroup by\n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\norder by\n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\n",
    ),
    (
        "queryq36",
        "\nSELECT\n  sum(ss_net_profit) / sum(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  grouping(i_category) + grouping(i_class) AS lochierarchy,\n  rank()\n  OVER (\n    PARTITION BY grouping(i_category) + grouping(i_class),\n      CASE WHEN grouping(i_class) = 0\n        THEN i_category END\n    ORDER BY sum(ss_net_profit) / sum(ss_ext_sales_price) ASC) AS rank_within_parent\nFROM\n  {{TABLE:store_sales}}, {{TABLE:date_dim}} d1, {{TABLE:item}}, {{TABLE:store}}\nWHERE\n  d1.d_year = 2001\n    AND d1.d_date_sk = ss_sold_date_sk\n    AND i_item_sk = ss_item_sk\n    AND s_store_sk = ss_store_sk\n    AND s_state IN ('TN', 'TN', 'TN', 'TN', 'TN', 'TN', 'TN', 'TN')\nGROUP BY ROLLUP (i_category, i_class)\nORDER BY\n  lochierarchy DESC\n  , CASE WHEN lochierarchy = 0\n  THEN i_category END\n  , rank_within_parent\n",
    ),
    (
        "queryq36a",
        "\nWITH base AS (\n  SELECT\n    ss.ss_net_profit,\n    ss.ss_ext_sales_price,\n    i.i_category,\n    i.i_class\n  FROM {{TABLE:store_sales}} ss\n  JOIN {{TABLE:date_dim}} d1 ON d1.d_date_sk = ss.ss_sold_date_sk AND d1.d_year = 2001\n  JOIN {{TABLE:item}} i      ON i.i_item_sk  = ss.ss_item_sk\n  JOIN {{TABLE:store}} s     ON s.s_store_sk = ss.ss_store_sk\n  WHERE s.s_state IN ('TN','TN','TN','TN','TN','TN','TN','TN')\n),\nlevel_cc AS (\n  SELECT\n    CASE WHEN SUM(ss_ext_sales_price) = 0 THEN NULL ELSE SUM(ss_net_profit) / SUM(ss_ext_sales_price) END AS gross_margin,\n    i_category,\n    i_class,\n    0 AS lochierarchy,\n    0 AS t_class\n  FROM base\n  GROUP BY i_category, i_class\n),\nlevel_c AS (\n  SELECT\n    CASE WHEN SUM(ss_ext_sales_price) = 0 THEN NULL ELSE SUM(ss_net_profit) / SUM(ss_ext_sales_price) END AS gross_margin,\n    i_category,\n    CAST(NULL AS STRING) AS i_class,\n    1 AS lochierarchy,\n    1 AS t_class\n  FROM base\n  GROUP BY i_category\n),\nlevel_all AS (\n  SELECT\n    CASE WHEN SUM(ss_ext_sales_price) = 0 THEN NULL ELSE SUM(ss_net_profit) / SUM(ss_ext_sales_price) END AS gross_margin,\n    CAST(NULL AS STRING) AS i_category,\n    CAST(NULL AS STRING) AS i_class,\n    2 AS lochierarchy,\n    1 AS t_class\n  FROM base\n)\nSELECT\n  gross_margin,\n  i_category,\n  i_class,\n  lochierarchy,\n  RANK() OVER (\n    PARTITION BY lochierarchy, CASE WHEN t_class = 0 THEN i_category END\n    ORDER BY gross_margin ASC\n  ) AS rank_within_parent\nFROM (\n  SELECT * FROM level_cc\n  UNION ALL\n  SELECT * FROM level_c\n  UNION ALL\n  SELECT * FROM level_all\n) results_rollup\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\n",
    ),
    (
        "queryq37",
        "\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_current_price\nFROM {{TABLE:item}} item, {{TABLE:inventory}} inventory, {{TABLE:date_dim}} date_dim, {{TABLE:catalog_sales}} catalog_sales\nWHERE i_current_price BETWEEN 68 AND 68 + 30\n  AND inv_item_sk = i_item_sk\n  AND d_date_sk = inv_date_sk\n  AND d_date BETWEEN cast('2000-02-01' AS DATE) AND (cast('2000-02-01' AS DATE) + INTERVAL 60 days)\n  AND i_manufact_id IN (677, 940, 694, 808)\n  AND inv_quantity_on_hand BETWEEN 100 AND 500\n  AND cs_item_sk = i_item_sk\nGROUP BY i_item_id, i_item_desc, i_current_price\nORDER BY i_item_id\n",
    ),
    (
        "queryq38",
        "\nSELECT COUNT(*)\nFROM (\n  SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date\n  FROM {{TABLE:store_sales}} ss\n  JOIN {{TABLE:date_dim}} d ON ss.ss_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:customer}} c ON ss.ss_customer_sk = c.c_customer_sk\n  WHERE d.d_month_seq BETWEEN 1200 AND 1200 + 11\n  INTERSECT\n  SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date\n  FROM {{TABLE:catalog_sales}} cs\n  JOIN {{TABLE:date_dim}} d ON cs.cs_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:customer}} c ON cs.cs_bill_customer_sk = c.c_customer_sk\n  WHERE d.d_month_seq BETWEEN 1200 AND 1200 + 11\n  INTERSECT\n  SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date\n  FROM {{TABLE:web_sales}} ws\n  JOIN {{TABLE:date_dim}} d ON ws.ws_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:customer}} c ON ws.ws_bill_customer_sk = c.c_customer_sk\n  WHERE d.d_month_seq BETWEEN 1200 AND 1200 + 11\n) hot_cust\n",
    ),
    (
        "queryq39a",
        "\nWITH inv AS\n(SELECT\n    w_warehouse_name,\n    w_warehouse_sk,\n    i_item_sk,\n    d_moy,\n    stdev,\n    mean,\n    CASE mean\n    WHEN 0\n      THEN NULL\n    ELSE stdev / mean END cov\n  FROM (SELECT\n    w_warehouse_name,\n    w_warehouse_sk,\n    i_item_sk,\n    d_moy,\n    stddev_samp(inv_quantity_on_hand) stdev,\n    avg(inv_quantity_on_hand) mean\n  FROM {{TABLE:inventory}}, {{TABLE:item}}, {{TABLE:warehouse}}, {{TABLE:date_dim}}\n  WHERE inv_item_sk = i_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_year = 2001\n  GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy) foo\n  WHERE CASE mean\n        WHEN 0\n          THEN 0\n        ELSE stdev / mean END > 1)\nSELECT\n  inv1.w_warehouse_sk,\n  inv1.i_item_sk,\n  inv1.d_moy,\n  inv1.mean,\n  inv1.cov,\n  inv2.w_warehouse_sk,\n  inv2.i_item_sk,\n  inv2.d_moy,\n  inv2.mean,\n  inv2.cov\nFROM inv inv1, inv inv2\nWHERE inv1.i_item_sk = inv2.i_item_sk\n  AND inv1.w_warehouse_sk = inv2.w_warehouse_sk\n  AND inv1.d_moy = 1\n  AND inv2.d_moy = 1 + 1\nORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov\n  , inv2.d_moy, inv2.mean, inv2.cov\n        ",
    ),
    (
        "queryq39b",
        "\nWITH inv AS\n(SELECT\n    w_warehouse_name,\n    w_warehouse_sk,\n    i_item_sk,\n    d_moy,\n    stdev,\n    mean,\n    CASE mean\n    WHEN 0\n      THEN NULL\n    ELSE stdev / mean END cov\n  FROM (SELECT\n    w_warehouse_name,\n    w_warehouse_sk,\n    i_item_sk,\n    d_moy,\n    stddev_samp(inv_quantity_on_hand) stdev,\n    avg(inv_quantity_on_hand) mean\n  FROM {{TABLE:inventory}}, {{TABLE:item}}, {{TABLE:warehouse}}, {{TABLE:date_dim}}\n  WHERE inv_item_sk = i_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_year = 2001\n  GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy) foo\n  WHERE CASE mean\n        WHEN 0\n          THEN 0\n        ELSE stdev / mean END > 1)\nSELECT\n  inv1.w_warehouse_sk,\n  inv1.i_item_sk,\n  inv1.d_moy,\n  inv1.mean,\n  inv1.cov,\n  inv2.w_warehouse_sk,\n  inv2.i_item_sk,\n  inv2.d_moy,\n  inv2.mean,\n  inv2.cov\nFROM inv inv1, inv inv2\nWHERE inv1.i_item_sk = inv2.i_item_sk\n  AND inv1.w_warehouse_sk = inv2.w_warehouse_sk\n  AND inv1.d_moy = 1\n  AND inv2.d_moy = 1 + 1\n  AND inv1.cov > 1.5\nORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov\n  , inv2.d_moy, inv2.mean, inv2.cov\n        ",
    ),
    (
        "queryq40",
        "\nSELECT\n  w_state,\n  i_item_id,\n  sum(CASE WHEN (cast(d_date AS DATE) < cast('2000-03-11' AS DATE))\n    THEN cs_sales_price - coalesce(cr_refunded_cash, 0)\n      ELSE 0 END) AS sales_before,\n  sum(CASE WHEN (cast(d_date AS DATE) >= cast('2000-03-11' AS DATE))\n    THEN cs_sales_price - coalesce(cr_refunded_cash, 0)\n      ELSE 0 END) AS sales_after\nFROM\n  {{TABLE:catalog_sales}}\n  LEFT OUTER JOIN {{TABLE:catalog_returns}} ON\n                                    (cs_order_number = cr_order_number\n                                      AND cs_item_sk = cr_item_sk)\n  , {{TABLE:warehouse}}, {{TABLE:item}}, {{TABLE:date_dim}}\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = cs_item_sk\n    AND cs_warehouse_sk = w_warehouse_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN (cast('2000-03-11' AS DATE) - INTERVAL 30 days)\n  AND (cast('2000-03-11' AS DATE) + INTERVAL 30 days)\nGROUP BY w_state, i_item_id\nORDER BY w_state, i_item_id\n",
    ),
    (
        "queryq41",
        "\nSELECT DISTINCT (i_product_name)\nFROM {{TABLE:item}} i1\nWHERE i_manufact_id BETWEEN 738 AND 738 + 40\n  AND (SELECT count(*) AS item_cnt\nFROM {{TABLE:item}}\nWHERE (i_manufact = i1.i_manufact AND\n  ((i_category = 'Women' AND\n    (i_color = 'powder' OR i_color = 'khaki') AND\n    (i_units = 'Ounce' OR i_units = 'Oz') AND\n    (i_size = 'medium' OR i_size = 'extra large')\n  ) OR\n    (i_category = 'Women' AND\n      (i_color = 'brown' OR i_color = 'honeydew') AND\n      (i_units = 'Bunch' OR i_units = 'Ton') AND\n      (i_size = 'N/A' OR i_size = 'small')\n    ) OR\n    (i_category = 'Men' AND\n      (i_color = 'floral' OR i_color = 'deep') AND\n      (i_units = 'N/A' OR i_units = 'Dozen') AND\n      (i_size = 'petite' OR i_size = 'large')\n    ) OR\n    (i_category = 'Men' AND\n      (i_color = 'light' OR i_color = 'cornflower') AND\n      (i_units = 'Box' OR i_units = 'Pound') AND\n      (i_size = 'medium' OR i_size = 'extra large')\n    ))) OR\n  (i_manufact = i1.i_manufact AND\n    ((i_category = 'Women' AND\n      (i_color = 'midnight' OR i_color = 'snow') AND\n      (i_units = 'Pallet' OR i_units = 'Gross') AND\n      (i_size = 'medium' OR i_size = 'extra large')\n    ) OR\n      (i_category = 'Women' AND\n        (i_color = 'cyan' OR i_color = 'papaya') AND\n        (i_units = 'Cup' OR i_units = 'Dram') AND\n        (i_size = 'N/A' OR i_size = 'small')\n      ) OR\n      (i_category = 'Men' AND\n        (i_color = 'orange' OR i_color = 'frosted') AND\n        (i_units = 'Each' OR i_units = 'Tbl') AND\n        (i_size = 'petite' OR i_size = 'large')\n      ) OR\n      (i_category = 'Men' AND\n        (i_color = 'forest' OR i_color = 'ghost') AND\n        (i_units = 'Lb' OR i_units = 'Bundle') AND\n        (i_size = 'medium' OR i_size = 'extra large')\n      )))) > 0\nORDER BY i_product_name\n",
    ),
    (
        "queryq42",
        "\nSELECT\n  dt.d_year,\n  item.i_category_id,\n  item.i_category,\n  sum(ss_ext_sales_price)\nFROM {{TABLE:date_dim}} dt, {{TABLE:store_sales}} store_sales, {{TABLE:item}} item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manager_id = 1\n  AND dt.d_moy = 11\n  AND dt.d_year = 2000\nGROUP BY dt.d_year\n  , item.i_category_id\n  , item.i_category\nORDER BY sum(ss_ext_sales_price) DESC, dt.d_year\n  , item.i_category_id\n  , item.i_category\n",
    ),
    (
        "queryq43",
        "\nSELECT\n  s_store_name,\n  s_store_id,\n  sum(CASE WHEN (d_day_name = 'Sunday')\n    THEN ss_sales_price\n      ELSE NULL END) sun_sales,\n  sum(CASE WHEN (d_day_name = 'Monday')\n    THEN ss_sales_price\n      ELSE NULL END) mon_sales,\n  sum(CASE WHEN (d_day_name = 'Tuesday')\n    THEN ss_sales_price\n      ELSE NULL END) tue_sales,\n  sum(CASE WHEN (d_day_name = 'Wednesday')\n    THEN ss_sales_price\n      ELSE NULL END) wed_sales,\n  sum(CASE WHEN (d_day_name = 'Thursday')\n    THEN ss_sales_price\n      ELSE NULL END) thu_sales,\n  sum(CASE WHEN (d_day_name = 'Friday')\n    THEN ss_sales_price\n      ELSE NULL END) fri_sales,\n  sum(CASE WHEN (d_day_name = 'Saturday')\n    THEN ss_sales_price\n      ELSE NULL END) sat_sales\nFROM {{TABLE:date_dim}}, {{TABLE:store_sales}}, {{TABLE:store}}\nWHERE d_date_sk = ss_sold_date_sk AND\n  s_store_sk = ss_store_sk AND\n  s_gmt_offset = -5 AND\n  d_year = 2000\nGROUP BY s_store_name, s_store_id\nORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales,\n  thu_sales, fri_sales, sat_sales\n",
    ),
    (
        "queryq44",
        "\nSELECT\n  asceding.rnk,\n  i1.i_product_name best_performing,\n  i2.i_product_name worst_performing\nFROM (SELECT *\nFROM (SELECT\n  item_sk,\n  rank()\n  OVER (\n    ORDER BY rank_col ASC) rnk\nFROM (SELECT\n  ss_item_sk item_sk,\n  avg(ss_net_profit) rank_col\nFROM {{TABLE:store_sales}} ss1\nWHERE ss_store_sk = 4\nGROUP BY ss_item_sk\nHAVING avg(ss_net_profit) > 0.9 * (SELECT avg(ss_net_profit) rank_col\nFROM {{TABLE:store_sales}}\nWHERE ss_store_sk = 4\n  AND ss_addr_sk IS NULL\nGROUP BY ss_store_sk)) V1) V11\nWHERE rnk < 11) asceding,\n  (SELECT *\n  FROM (SELECT\n    item_sk,\n    rank()\n    OVER (\n      ORDER BY rank_col DESC) rnk\n  FROM (SELECT\n    ss_item_sk item_sk,\n    avg(ss_net_profit) rank_col\n  FROM {{TABLE:store_sales}} ss1\n  WHERE ss_store_sk = 4\n  GROUP BY ss_item_sk\n  HAVING avg(ss_net_profit) > 0.9 * (SELECT avg(ss_net_profit) rank_col\n  FROM {{TABLE:store_sales}}\n  WHERE ss_store_sk = 4\n    AND ss_addr_sk IS NULL\n  GROUP BY ss_store_sk)) V2) V21\n  WHERE rnk < 11) descending,\n  {{TABLE:item}} i1, {{TABLE:item}} i2\nWHERE asceding.rnk = descending.rnk\n  AND i1.i_item_sk = asceding.item_sk\n  AND i2.i_item_sk = descending.item_sk\nORDER BY asceding.rnk\n",
    ),
    (
        "queryq45",
        "\nSELECT\n  ca_zip,\n  ca_city,\n  sum(ws_sales_price)\nFROM {{TABLE:web_sales}}, {{TABLE:customer}}, {{TABLE:customer_address}}, {{TABLE:date_dim}}, {{TABLE:item}}\nWHERE ws_bill_customer_sk = c_customer_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND ws_item_sk = i_item_sk\n  AND (substr(ca_zip, 1, 5) IN\n  ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')\n  OR\n  i_item_id IN (SELECT i_item_id\n  FROM {{TABLE:item}}\n  WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n  )\n)\n  AND ws_sold_date_sk = d_date_sk\n  AND d_qoy = 2 AND d_year = 2001\nGROUP BY ca_zip, ca_city\nORDER BY ca_zip, ca_city\n",
    ),
    (
        "queryq46",
        "\nSELECT\n  c.c_last_name,\n  c.c_first_name,\n  curr.ca_city,\n  dn.bought_city,\n  dn.ss_ticket_number,\n  dn.amt,\n  dn.profit\nFROM (\n  SELECT\n    ss.ss_ticket_number,\n    ss.ss_customer_sk,\n    ca.ca_city AS bought_city,\n    SUM(ss.ss_coupon_amt) AS amt,\n    SUM(ss.ss_net_profit) AS profit,\n    ss.ss_addr_sk\n  FROM {{TABLE:store_sales}} ss\n  JOIN {{TABLE:date_dim}} d   ON ss.ss_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:store}} s      ON ss.ss_store_sk     = s.s_store_sk\n  JOIN {{TABLE:household_demographics}} hd ON ss.ss_hdemo_sk = hd.hd_demo_sk\n  JOIN {{TABLE:customer_address}} ca ON ss.ss_addr_sk = ca.ca_address_sk\n  WHERE (hd.hd_dep_count = 4 OR hd.hd_vehicle_count = 3)\n    AND d.d_dow IN (6, 0)\n    AND d.d_year IN (1999, 1999 + 1, 1999 + 2)\n    AND s.s_city IN ('Fairview','Midway','Fairview','Fairview','Fairview')\n  GROUP BY ss.ss_ticket_number, ss.ss_customer_sk, ss.ss_addr_sk, ca.ca_city\n) dn\nJOIN {{TABLE:customer}} c            ON dn.ss_customer_sk = c.c_customer_sk\nJOIN {{TABLE:customer_address}} curr ON c.c_current_addr_sk = curr.ca_address_sk\nWHERE curr.ca_city <> dn.bought_city\nORDER BY c.c_last_name, c.c_first_name, curr.ca_city, dn.bought_city, dn.ss_ticket_number\n",
    ),
    (
        "queryq47",
        "\nWITH v1 AS (\n  SELECT\n    i_category,\n    i_brand,\n    s_store_name,\n    s_company_name,\n    d_year,\n    d_moy,\n    sum(ss_sales_price) sum_sales,\n    avg(sum(ss_sales_price))\n    OVER\n    (PARTITION BY i_category, i_brand,\n      s_store_name, s_company_name, d_year)\n    avg_monthly_sales,\n    rank()\n    OVER\n    (PARTITION BY i_category, i_brand,\n      s_store_name, s_company_name\n      ORDER BY d_year, d_moy) rn\n  FROM {{TABLE:item}}, {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}\n  WHERE ss_item_sk = i_item_sk AND\n    ss_sold_date_sk = d_date_sk AND\n    ss_store_sk = s_store_sk AND\n    (\n      d_year = 1999 OR\n        (d_year = 1999 - 1 AND d_moy = 12) OR\n        (d_year = 1999 + 1 AND d_moy = 1)\n    )\n  GROUP BY i_category, i_brand,\n    s_store_name, s_company_name,\n    d_year, d_moy),\n    v2 AS (\n    SELECT\n      v1.i_category,\n      -- q47 in TPCDS v1.4 had more columns below:\n      -- v1.i_brand,\n      -- v1.s_store_name,\n      -- v1.s_company_name,\n      v1.d_year,\n      v1.d_moy,\n      v1.avg_monthly_sales,\n      v1.sum_sales,\n      v1_lag.sum_sales psum,\n      v1_lead.sum_sales nsum\n    FROM v1, v1 v1_lag, v1 v1_lead\n    WHERE v1.i_category = v1_lag.i_category AND\n      v1.i_category = v1_lead.i_category AND\n      v1.i_brand = v1_lag.i_brand AND\n      v1.i_brand = v1_lead.i_brand AND\n      v1.s_store_name = v1_lag.s_store_name AND\n      v1.s_store_name = v1_lead.s_store_name AND\n      v1.s_company_name = v1_lag.s_company_name AND\n      v1.s_company_name = v1_lead.s_company_name AND\n      v1.rn = v1_lag.rn + 1 AND\n      v1.rn = v1_lead.rn - 1)\nSELECT *\nFROM v2\nWHERE d_year = 1999 AND\n  avg_monthly_sales > 0 AND\n  CASE WHEN avg_monthly_sales > 0\n    THEN abs(sum_sales - avg_monthly_sales) / avg_monthly_sales\n  ELSE NULL END > 0.1\nORDER BY sum_sales - avg_monthly_sales, 3\n",
    ),
    (
        "queryq48",
        "\nSELECT sum(ss_quantity)\nFROM {{TABLE:store_sales}}, {{TABLE:store}}, {{TABLE:customer_demographics}}, {{TABLE:customer_address}}, {{TABLE:date_dim}}\nWHERE s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk AND d_year = 2001\n  AND\n  (\n    (\n      cd_demo_sk = ss_cdemo_sk\n        AND\n        cd_marital_status = 'M'\n        AND\n        cd_education_status = '4 yr Degree'\n        AND\n        ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n      OR\n      (\n        cd_demo_sk = ss_cdemo_sk\n          AND\n          cd_marital_status = 'D'\n          AND\n          cd_education_status = '2 yr Degree'\n          AND\n          ss_sales_price BETWEEN 50.00 AND 100.00\n      )\n      OR\n      (\n        cd_demo_sk = ss_cdemo_sk\n          AND\n          cd_marital_status = 'S'\n          AND\n          cd_education_status = 'College'\n          AND\n          ss_sales_price BETWEEN 150.00 AND 200.00\n      )\n  )\n  AND\n  (\n    (\n      ss_addr_sk = ca_address_sk\n        AND\n        ca_country = 'United States'\n        AND\n        ca_state IN ('CO', 'OH', 'TX')\n        AND ss_net_profit BETWEEN 0 AND 2000\n    )\n      OR\n      (ss_addr_sk = ca_address_sk\n        AND\n        ca_country = 'United States'\n        AND\n        ca_state IN ('OR', 'MN', 'KY')\n        AND ss_net_profit BETWEEN 150 AND 3000\n      )\n      OR\n      (ss_addr_sk = ca_address_sk\n        AND\n        ca_country = 'United States'\n        AND\n        ca_state IN ('VA', 'CA', 'MS')\n        AND ss_net_profit BETWEEN 50 AND 25000\n      )\n  )\n        ",
    ),
    (
        "queryq49",
        "\nSELECT\n  channel,\n  item,\n  return_ratio,\n  return_rank,\n  currency_rank\nFROM (\n       SELECT\n         'web' as channel,\n         in_web.item,\n         in_web.return_ratio,\n         in_web.return_rank,\n         in_web.currency_rank\n       FROM\n         (SELECT\n           item,\n           return_ratio,\n           currency_ratio,\n           rank() over (ORDER BY return_ratio) AS return_rank,\n           rank() over (ORDER BY currency_ratio) AS currency_rank\n         FROM (\n            SELECT\n              ws.ws_item_sk AS item,\n              CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) /\n                CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio,\n              CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) /\n                CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio\n            FROM\n              {{TABLE:web_sales}} ws LEFT OUTER JOIN {{TABLE:web_returns}} wr\n                ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk),\n              {{TABLE:date_dim}}\n            WHERE\n              wr.wr_return_amt > 10000\n                AND ws.ws_net_profit > 1\n                AND ws.ws_net_paid > 0\n                AND ws.ws_quantity > 0\n                AND ws_sold_date_sk = d_date_sk\n                AND d_year = 2001\n                AND d_moy = 12\n            GROUP BY\n              ws.ws_item_sk)\n         ) in_web\n     ) web\nWHERE (web.return_rank <= 10 OR web.currency_rank <= 10)\nUNION\nSELECT\n  'catalog' AS channel,\n  catalog.item,\n  catalog.return_ratio,\n  catalog.return_rank,\n  catalog.currency_rank\nFROM (\n       SELECT\n         item,\n         return_ratio,\n         currency_ratio,\n         rank()\n         OVER (\n           ORDER BY return_ratio) AS return_rank,\n         rank()\n         OVER (\n           ORDER BY currency_ratio) AS currency_rank\n       FROM\n         (SELECT\n           cs.cs_item_sk AS item,\n           (cast(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) /\n             cast(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio,\n           (cast(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) /\n             cast(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio\n         FROM\n           {{TABLE:catalog_sales}} cs LEFT OUTER JOIN {{TABLE:catalog_returns}} cr\n             ON (cs.cs_order_number = cr.cr_order_number AND\n             cs.cs_item_sk = cr.cr_item_sk)\n           , {{TABLE:date_dim}}\n         WHERE\n           cr.cr_return_amount > 10000\n             AND cs.cs_net_profit > 1\n             AND cs.cs_net_paid > 0\n             AND cs.cs_quantity > 0\n             AND cs_sold_date_sk = d_date_sk\n             AND d_year = 2001\n             AND d_moy = 12\n         GROUP BY cs.cs_item_sk\n         ) in_cat\n     ) catalog\nWHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10)\nUNION\nSELECT\n  'store' AS channel,\n  store.item,\n  store.return_ratio,\n  store.return_rank,\n  store.currency_rank\nFROM (\n       SELECT\n         item,\n         return_ratio,\n         currency_ratio,\n         rank()\n         OVER (\n           ORDER BY return_ratio) AS return_rank,\n         rank()\n         OVER (\n           ORDER BY currency_ratio) AS currency_rank\n       FROM\n         (SELECT\n           sts.ss_item_sk AS item,\n           (cast(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) /\n             cast(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio,\n           (cast(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) /\n             cast(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio\n         FROM\n           {{TABLE:store_sales}} sts LEFT OUTER JOIN {{TABLE:store_returns}} sr\n             ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk)\n           , {{TABLE:date_dim}}\n         WHERE\n           sr.sr_return_amt > 10000\n             AND sts.ss_net_profit > 1\n             AND sts.ss_net_paid > 0\n             AND sts.ss_quantity > 0\n             AND ss_sold_date_sk = d_date_sk\n             AND d_year = 2001\n             AND d_moy = 12\n         GROUP BY sts.ss_item_sk\n         ) in_store\n     ) store\nWHERE (store.return_rank <= 10 OR store.currency_rank <= 10)\nORDER BY\n  -- order-by list of q49 in TPCDS v1.4 is below:\n  -- 1, 4, 5\n  1, 4, 5, 2\n",
    ),
    (
        "queryq50",
        "\nSELECT\n  s_store_name,\n  s_company_id,\n  s_street_number,\n  s_street_name,\n  s_street_type,\n  s_suite_number,\n  s_city,\n  s_county,\n  s_state,\n  s_zip,\n  sum(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30)\n    THEN 1\n      ELSE 0 END)  AS `30 days `,\n  sum(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30) AND\n    (sr_returned_date_sk - ss_sold_date_sk <= 60)\n    THEN 1\n      ELSE 0 END)  AS `31 - 60 days `,\n  sum(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60) AND\n    (sr_returned_date_sk - ss_sold_date_sk <= 90)\n    THEN 1\n      ELSE 0 END)  AS `61 - 90 days `,\n  sum(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90) AND\n    (sr_returned_date_sk - ss_sold_date_sk <= 120)\n    THEN 1\n      ELSE 0 END)  AS `91 - 120 days `,\n  sum(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120)\n    THEN 1\n      ELSE 0 END)  AS `>120 days `\nFROM\n  {{TABLE:store_sales}}, {{TABLE:store_returns}}, {{TABLE:store}}, {{TABLE:date_dim}} d1, {{TABLE:date_dim}} d2\nWHERE\n  d2.d_year = 2001\n    AND d2.d_moy = 8\n    AND ss_ticket_number = sr_ticket_number\n    AND ss_item_sk = sr_item_sk\n    AND ss_sold_date_sk = d1.d_date_sk\n    AND sr_returned_date_sk = d2.d_date_sk\n    AND ss_customer_sk = sr_customer_sk\n    AND ss_store_sk = s_store_sk\nGROUP BY\n  s_store_name, s_company_id, s_street_number, s_street_name, s_street_type,\n  s_suite_number, s_city, s_county, s_state, s_zip\nORDER BY\n  s_store_name, s_company_id, s_street_number, s_street_name, s_street_type,\n  s_suite_number, s_city, s_county, s_state, s_zip\n",
    ),
    (
        "queryq51",
        "\nWITH web_v1 AS (\n  SELECT\n    ws_item_sk item_sk,\n    d_date,\n    sum(sum(ws_sales_price))\n    OVER (PARTITION BY ws_item_sk\n      ORDER BY d_date\n      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cume_sales\n  FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n  WHERE ws_sold_date_sk = d_date_sk\n    AND d_month_seq BETWEEN 1200 AND 1200 + 11\n    AND ws_item_sk IS NOT NULL\n  GROUP BY ws_item_sk, d_date),\n    store_v1 AS (\n    SELECT\n      ss_item_sk item_sk,\n      d_date,\n      sum(sum(ss_sales_price))\n      OVER (PARTITION BY ss_item_sk\n        ORDER BY d_date\n        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) cume_sales\n    FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n    WHERE ss_sold_date_sk = d_date_sk\n      AND d_month_seq BETWEEN 1200 AND 1200 + 11\n      AND ss_item_sk IS NOT NULL\n    GROUP BY ss_item_sk, d_date)\nSELECT *\nFROM (SELECT\n  item_sk,\n  d_date,\n  web_sales,\n  store_sales,\n  max(web_sales)\n  OVER (PARTITION BY item_sk\n    ORDER BY d_date\n    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) web_cumulative,\n  max(store_sales)\n  OVER (PARTITION BY item_sk\n    ORDER BY d_date\n    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) store_cumulative\nFROM (SELECT\n  CASE WHEN web.item_sk IS NOT NULL\n    THEN web.item_sk\n  ELSE store.item_sk END item_sk,\n  CASE WHEN web.d_date IS NOT NULL\n    THEN web.d_date\n  ELSE store.d_date END d_date,\n  web.cume_sales web_sales,\n  store.cume_sales store_sales\nFROM web_v1 web FULL OUTER JOIN store_v1 store ON (web.item_sk = store.item_sk\n  AND web.d_date = store.d_date)\n     ) x) y\nWHERE web_cumulative > store_cumulative\nORDER BY item_sk, d_date\n",
    ),
    (
        "queryq51a",
        "\nWITH web_tv as (\n    select\n      ws_item_sk item_sk,\n      d_date,\n      sum(ws_sales_price) sumws,\n      row_number() over (partition by ws_item_sk order by d_date) rk\n    from\n      {{TABLE:web_sales}}, {{TABLE:date_dim}}\n    where\n      ws_sold_date_sk=d_date_sk\n        and d_month_seq between 1212 and 1212 + 11\n        and ws_item_sk is not NULL\n    group by\n      ws_item_sk, d_date),\nweb_v1 as (\n    select\n      v1.item_sk,\n      v1.d_date,\n      v1.sumws,\n      sum(v2.sumws) cume_sales\n    from\n      web_tv v1, web_tv v2\n    where\n      v1.item_sk = v2.item_sk\n        and v1.rk >= v2.rk\n    group by\n      v1.item_sk,\n      v1.d_date,\n      v1.sumws),\nstore_tv as (\n    select\n      ss_item_sk item_sk,\n      d_date,\n      sum(ss_sales_price) sumss,\n      row_number() over (partition by ss_item_sk order by d_date) rk\n    from\n      {{TABLE:store_sales}}, {{TABLE:date_dim}}\n    where\n      ss_sold_date_sk = d_date_sk\n        and d_month_seq between 1212 and 1212 + 11\n        and ss_item_sk is not NULL\n    group by ss_item_sk, d_date),\nstore_v1 as (\n    select\n      v1.item_sk,\n      v1.d_date,\n      v1.sumss,\n      sum(v2.sumss) cume_sales\n    from\n      store_tv v1, store_tv v2\n    where\n      v1.item_sk = v2.item_sk\n        and v1.rk >= v2.rk\n    group by\n      v1.item_sk,\n      v1.d_date,\n      v1.sumss),\nv as (\n    select\n      item_sk,\n      d_date,\n      web_sales,\n      store_sales,\n      row_number() over (partition by item_sk order by d_date) rk\n    from (\n        select\n          case when web.item_sk is not null\n            then web.item_sk\n            else store.item_sk end item_sk,\n          case when web.d_date is not null\n            then web.d_date\n            else store.d_date end d_date,\n          web.cume_sales web_sales,\n          store.cume_sales store_sales\n        from\n          web_v1 web full outer join store_v1 store\n            on (web.item_sk = store.item_sk and web.d_date = store.d_date)))\nselect *\nfrom (\n    select\n      v1.item_sk,\n      v1.d_date,\n      v1.web_sales,\n      v1.store_sales,\n      max(v2.web_sales) web_cumulative,\n      max(v2.store_sales) store_cumulative\n    from\n      v v1, v v2\n    where\n      v1.item_sk = v2.item_sk\n        and v1.rk >= v2.rk\n    group by\n      v1.item_sk,\n      v1.d_date,\n      v1.web_sales,\n      v1.store_sales) x\nwhere\n  web_cumulative > store_cumulative\norder by\n  item_sk,\n  d_date\n",
    ),
    (
        "queryq52",
        "\nSELECT\n  dt.d_year,\n  item.i_brand_id brand_id,\n  item.i_brand brand,\n  sum(ss_ext_sales_price) ext_price\nFROM {{TABLE:date_dim}} dt, {{TABLE:store_sales}} store_sales, {{TABLE:item}} item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manager_id = 1\n  AND dt.d_moy = 11\n  AND dt.d_year = 2000\nGROUP BY dt.d_year, item.i_brand, item.i_brand_id\nORDER BY dt.d_year, ext_price DESC, brand_id\n",
    ),
    (
        "queryq53",
        "\nSELECT *\nFROM\n  (SELECT\n    i_manufact_id,\n    sum(ss_sales_price) sum_sales,\n    avg(sum(ss_sales_price))\n    OVER (PARTITION BY i_manufact_id) avg_quarterly_sales\n  FROM {{TABLE:item}}, {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}\n  WHERE ss_item_sk = i_item_sk AND\n    ss_sold_date_sk = d_date_sk AND\n    ss_store_sk = s_store_sk AND\n    d_month_seq IN (1200, 1200 + 1, 1200 + 2, 1200 + 3, 1200 + 4, 1200 + 5, 1200 + 6,\n                          1200 + 7, 1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11) AND\n    ((i_category IN ('Books', 'Children', 'Electronics') AND\n      i_class IN ('personal', 'portable', 'reference', 'self-help') AND\n      i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7',\n                  'exportiunivamalg #9', 'scholaramalgamalg #9'))\n      OR\n      (i_category IN ('Women', 'Music', 'Men') AND\n        i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND\n        i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1',\n                    'importoamalg #1')))\n  GROUP BY i_manufact_id, d_qoy) tmp1\nWHERE CASE WHEN avg_quarterly_sales > 0\n  THEN abs(sum_sales - avg_quarterly_sales) / avg_quarterly_sales\n      ELSE NULL END > 0.1\nORDER BY avg_quarterly_sales,\n  sum_sales,\n  i_manufact_id\n",
    ),
    (
        "queryq54",
        "\nWITH my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM\n    (SELECT\n       cs_sold_date_sk sold_date_sk,\n       cs_bill_customer_sk customer_sk,\n       cs_item_sk item_sk\n     FROM {{TABLE:catalog_sales}}\n     UNION ALL\n     SELECT\n       ws_sold_date_sk sold_date_sk,\n       ws_bill_customer_sk customer_sk,\n       ws_item_sk item_sk\n     FROM {{TABLE:web_sales}}\n    ) cs_or_ws_sales,\n    {{TABLE:item}},\n    {{TABLE:date_dim}},\n    {{TABLE:customer}}\n  WHERE sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND d_moy = 12\n    AND d_year = 1998\n)\n  , my_revenue AS (\n  SELECT\n    c_customer_sk,\n    sum(ss_ext_sales_price) AS revenue\n  FROM my_customers,\n    {{TABLE:store_sales}},\n    {{TABLE:customer_address}},\n    {{TABLE:store}},\n    {{TABLE:date_dim}}\n  WHERE c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1\n  FROM {{TABLE:date_dim}}\n  WHERE d_year = 1998 AND d_moy = 12)\n  AND (SELECT DISTINCT d_month_seq + 3\n  FROM {{TABLE:date_dim}}\n  WHERE d_year = 1998 AND d_moy = 12)\n  GROUP BY c_customer_sk\n)\n  , segments AS\n(SELECT cast((revenue / 50) AS INT) AS segment\n  FROM my_revenue)\nSELECT\n  segment,\n  count(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY segment\nORDER BY segment, num_customers\n",
    ),
    (
        "queryq55",
        "\nSELECT\n  i_brand_id brand_id,\n  i_brand brand,\n  sum(ss_ext_sales_price) ext_price\nFROM {{TABLE:date_dim}}, {{TABLE:store_sales}}, {{TABLE:item}}\nWHERE d_date_sk = ss_sold_date_sk\n  AND ss_item_sk = i_item_sk\n  AND i_manager_id = 28\n  AND d_moy = 11\n  AND d_year = 1999\nGROUP BY i_brand, i_brand_id\nORDER BY ext_price DESC, brand_id\n",
    ),
    (
        "queryq56",
        "\nWITH ss AS (\n  SELECT\n    i_item_id,\n    sum(ss_ext_sales_price) total_sales\n  FROM\n    {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:item}}\n  WHERE\n    i_item_id IN (SELECT i_item_id\n    FROM {{TABLE:item}}\n    WHERE i_color IN ('slate', 'blanched', 'burnished'))\n      AND ss_item_sk = i_item_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year = 2001\n      AND d_moy = 2\n      AND ss_addr_sk = ca_address_sk\n      AND ca_gmt_offset = -5\n  GROUP BY i_item_id),\n    cs AS (\n    SELECT\n      i_item_id,\n      sum(cs_ext_sales_price) total_sales\n    FROM\n      {{TABLE:catalog_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:item}}\n    WHERE\n      i_item_id IN (SELECT i_item_id\n      FROM {{TABLE:item}}\n      WHERE i_color IN ('slate', 'blanched', 'burnished'))\n        AND cs_item_sk = i_item_sk\n        AND cs_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy = 2\n        AND cs_bill_addr_sk = ca_address_sk\n        AND ca_gmt_offset = -5\n    GROUP BY i_item_id),\n    ws AS (\n    SELECT\n      i_item_id,\n      sum(ws_ext_sales_price) total_sales\n    FROM\n      {{TABLE:web_sales}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:item}}\n    WHERE\n      i_item_id IN (SELECT i_item_id\n      FROM {{TABLE:item}}\n      WHERE i_color IN ('slate', 'blanched', 'burnished'))\n        AND ws_item_sk = i_item_sk\n        AND ws_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy = 2\n        AND ws_bill_addr_sk = ca_address_sk\n        AND ca_gmt_offset = -5\n    GROUP BY i_item_id)\nSELECT\n  i_item_id,\n  sum(total_sales) total_sales\nFROM (SELECT *\n      FROM ss\n      UNION ALL\n      SELECT *\n      FROM cs\n      UNION ALL\n      SELECT *\n      FROM ws) tmp1\nGROUP BY i_item_id\nORDER BY total_sales\n",
    ),
    (
        "queryq57",
        "\nWITH v1 AS (\n  SELECT\n    i_category,\n    i_brand,\n    cc_name,\n    d_year,\n    d_moy,\n    sum(cs_sales_price) sum_sales,\n    avg(sum(cs_sales_price))\n    OVER\n    (PARTITION BY i_category, i_brand, cc_name, d_year)\n    avg_monthly_sales,\n    rank()\n    OVER\n    (PARTITION BY i_category, i_brand, cc_name\n      ORDER BY d_year, d_moy) rn\n  FROM {{TABLE:item}}, {{TABLE:catalog_sales}}, {{TABLE:date_dim}}, {{TABLE:call_center}}\n  WHERE cs_item_sk = i_item_sk AND\n    cs_sold_date_sk = d_date_sk AND\n    cc_call_center_sk = cs_call_center_sk AND\n    (\n      d_year = 1999 OR\n        (d_year = 1999 - 1 AND d_moy = 12) OR\n        (d_year = 1999 + 1 AND d_moy = 1)\n    )\n  GROUP BY i_category, i_brand,\n    cc_name, d_year, d_moy),\n    v2 AS (\n    SELECT\n      v1.i_category,\n      v1.i_brand,\n      -- q57 in TPCDS v1.4 had a column below:\n      -- v1.cc_name,\n      v1.d_year,\n      v1.d_moy,\n      v1.avg_monthly_sales,\n      v1.sum_sales,\n      v1_lag.sum_sales psum,\n      v1_lead.sum_sales nsum\n    FROM v1, v1 v1_lag, v1 v1_lead\n    WHERE v1.i_category = v1_lag.i_category AND\n      v1.i_category = v1_lead.i_category AND\n      v1.i_brand = v1_lag.i_brand AND\n      v1.i_brand = v1_lead.i_brand AND\n      v1.cc_name = v1_lag.cc_name AND\n      v1.cc_name = v1_lead.cc_name AND\n      v1.rn = v1_lag.rn + 1 AND\n      v1.rn = v1_lead.rn - 1)\nSELECT *\nFROM v2\nWHERE d_year = 1999 AND\n  avg_monthly_sales > 0 AND\n  CASE WHEN avg_monthly_sales > 0\n    THEN abs(sum_sales - avg_monthly_sales) / avg_monthly_sales\n  ELSE NULL END > 0.1\nORDER BY sum_sales - avg_monthly_sales, 3\n",
    ),
    (
        "queryq58",
        "\nWITH ss_items AS\n(SELECT\n    i_item_id item_id,\n    sum(ss_ext_sales_price) ss_item_rev\n  FROM {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n  WHERE ss_item_sk = i_item_sk\n    AND d_date IN (SELECT d_date\n  FROM {{TABLE:date_dim}}\n  WHERE d_week_seq = (SELECT d_week_seq\n  FROM {{TABLE:date_dim}}\n  WHERE d_date = '2000-01-03'))\n    AND ss_sold_date_sk = d_date_sk\n  GROUP BY i_item_id),\n    cs_items AS\n  (SELECT\n    i_item_id item_id,\n    sum(cs_ext_sales_price) cs_item_rev\n  FROM {{TABLE:catalog_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n  WHERE cs_item_sk = i_item_sk\n    AND d_date IN (SELECT d_date\n  FROM {{TABLE:date_dim}}\n  WHERE d_week_seq = (SELECT d_week_seq\n  FROM {{TABLE:date_dim}}\n  WHERE d_date = '2000-01-03'))\n    AND cs_sold_date_sk = d_date_sk\n  GROUP BY i_item_id),\n    ws_items AS\n  (SELECT\n    i_item_id item_id,\n    sum(ws_ext_sales_price) ws_item_rev\n  FROM {{TABLE:web_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n  WHERE ws_item_sk = i_item_sk\n    AND d_date IN (SELECT d_date\n  FROM {{TABLE:date_dim}}\n  WHERE d_week_seq = (SELECT d_week_seq\n  FROM {{TABLE:date_dim}}\n  WHERE d_date = '2000-01-03'))\n    AND ws_sold_date_sk = d_date_sk\n  GROUP BY i_item_id)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (ss_item_rev + cs_item_rev + ws_item_rev) / 3 * 100 ss_dev,\n  cs_item_rev,\n  cs_item_rev / (ss_item_rev + cs_item_rev + ws_item_rev) / 3 * 100 cs_dev,\n  ws_item_rev,\n  ws_item_rev / (ss_item_rev + cs_item_rev + ws_item_rev) / 3 * 100 ws_dev,\n  (ss_item_rev + cs_item_rev + ws_item_rev) / 3 average\nFROM ss_items, cs_items, ws_items\nWHERE ss_items.item_id = cs_items.item_id\n  AND ss_items.item_id = ws_items.item_id\n  AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY item_id, ss_item_rev\n",
    ),
    (
        "queryq59",
        "\nWITH wss AS\n(SELECT\n    d_week_seq,\n    ss_store_sk,\n    sum(CASE WHEN (d_day_name = 'Sunday')\n      THEN ss_sales_price\n        ELSE NULL END) sun_sales,\n    sum(CASE WHEN (d_day_name = 'Monday')\n      THEN ss_sales_price\n        ELSE NULL END) mon_sales,\n    sum(CASE WHEN (d_day_name = 'Tuesday')\n      THEN ss_sales_price\n        ELSE NULL END) tue_sales,\n    sum(CASE WHEN (d_day_name = 'Wednesday')\n      THEN ss_sales_price\n        ELSE NULL END) wed_sales,\n    sum(CASE WHEN (d_day_name = 'Thursday')\n      THEN ss_sales_price\n        ELSE NULL END) thu_sales,\n    sum(CASE WHEN (d_day_name = 'Friday')\n      THEN ss_sales_price\n        ELSE NULL END) fri_sales,\n    sum(CASE WHEN (d_day_name = 'Saturday')\n      THEN ss_sales_price\n        ELSE NULL END) sat_sales\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n  WHERE d_date_sk = ss_sold_date_sk\n  GROUP BY d_week_seq, ss_store_sk\n)\nSELECT\n  s_store_name1,\n  s_store_id1,\n  d_week_seq1,\n  sun_sales1 / sun_sales2,\n  mon_sales1 / mon_sales2,\n  tue_sales1 / tue_sales2,\n  wed_sales1 / wed_sales2,\n  thu_sales1 / thu_sales2,\n  fri_sales1 / fri_sales2,\n  sat_sales1 / sat_sales2\nFROM\n  (SELECT\n    s_store_name s_store_name1,\n    wss.d_week_seq d_week_seq1,\n    s_store_id s_store_id1,\n    sun_sales sun_sales1,\n    mon_sales mon_sales1,\n    tue_sales tue_sales1,\n    wed_sales wed_sales1,\n    thu_sales thu_sales1,\n    fri_sales fri_sales1,\n    sat_sales sat_sales1\n  FROM wss, {{TABLE:store}}, {{TABLE:date_dim}} d\n  WHERE d.d_week_seq = wss.d_week_seq AND\n    ss_store_sk = s_store_sk AND\n    d_month_seq BETWEEN 1212 AND 1212 + 11) y,\n  (SELECT\n    s_store_name s_store_name2,\n    wss.d_week_seq d_week_seq2,\n    s_store_id s_store_id2,\n    sun_sales sun_sales2,\n    mon_sales mon_sales2,\n    tue_sales tue_sales2,\n    wed_sales wed_sales2,\n    thu_sales thu_sales2,\n    fri_sales fri_sales2,\n    sat_sales sat_sales2\n  FROM wss, {{TABLE:store}}, {{TABLE:date_dim}} d\n  WHERE d.d_week_seq = wss.d_week_seq AND\n    ss_store_sk = s_store_sk AND\n    d_month_seq BETWEEN 1212 + 12 AND 1212 + 23) x\nWHERE s_store_id1 = s_store_id2\n  AND d_week_seq1 = d_week_seq2 - 52\nORDER BY s_store_name1, s_store_id1, d_week_seq1\n",
    ),
    (
        "queryq60",
        "\nWITH ss AS (\n  SELECT\n    i.i_item_id,\n    SUM(ssales.ss_ext_sales_price) AS total_sales\n  FROM {{TABLE:store_sales}} ssales\n  JOIN {{TABLE:date_dim}} d   ON ssales.ss_sold_date_sk = d.d_date_sk AND d.d_year = 1998 AND d.d_moy = 9\n  JOIN {{TABLE:customer_address}} ca ON ssales.ss_addr_sk = ca.ca_address_sk AND ca.ca_gmt_offset = -5\n  JOIN {{TABLE:item}} i      ON ssales.ss_item_sk = i.i_item_sk AND i.i_category IN ('Music')\n  GROUP BY i.i_item_id\n),\ncs AS (\n  SELECT\n    i.i_item_id,\n    SUM(csales.cs_ext_sales_price) AS total_sales\n  FROM {{TABLE:catalog_sales}} csales\n  JOIN {{TABLE:date_dim}} d   ON csales.cs_sold_date_sk = d.d_date_sk AND d.d_year = 1998 AND d.d_moy = 9\n  JOIN {{TABLE:customer_address}} ca ON csales.cs_bill_addr_sk = ca.ca_address_sk AND ca.ca_gmt_offset = -5\n  JOIN {{TABLE:item}} i      ON csales.cs_item_sk = i.i_item_sk AND i.i_category IN ('Music')\n  GROUP BY i.i_item_id\n),\nws AS (\n  SELECT\n    i.i_item_id,\n    SUM(wsales.ws_ext_sales_price) AS total_sales\n  FROM {{TABLE:web_sales}} wsales\n  JOIN {{TABLE:date_dim}} d   ON wsales.ws_sold_date_sk = d.d_date_sk AND d.d_year = 1998 AND d.d_moy = 9\n  JOIN {{TABLE:customer_address}} ca ON wsales.ws_bill_addr_sk = ca.ca_address_sk AND ca.ca_gmt_offset = -5\n  JOIN {{TABLE:item}} i      ON wsales.ws_item_sk = i.i_item_sk AND i.i_category IN ('Music')\n  GROUP BY i.i_item_id\n)\nSELECT\n  i_item_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT * FROM ss\n  UNION ALL\n  SELECT * FROM cs\n  UNION ALL\n  SELECT * FROM ws\n) tmp1\nGROUP BY i_item_id\nORDER BY i_item_id, total_sales\n",
    ),
    (
        "queryq61",
        "\nSELECT\n  promotions,\n  total,\n  cast(promotions AS DECIMAL(15, 4)) / cast(total AS DECIMAL(15, 4)) * 100\nFROM\n  (SELECT sum(ss_ext_sales_price) promotions\n  FROM {{TABLE:store_sales}}, {{TABLE:store}}, {{TABLE:promotion}}, {{TABLE:date_dim}}, {{TABLE:customer}}, {{TABLE:customer_address}}, {{TABLE:item}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND ss_store_sk = s_store_sk\n    AND ss_promo_sk = p_promo_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ca_address_sk = c_current_addr_sk\n    AND ss_item_sk = i_item_sk\n    AND ca_gmt_offset = -5\n    AND i_category = 'Jewelry'\n    AND (p_channel_dmail = 'Y' OR p_channel_email = 'Y' OR p_channel_tv = 'Y')\n    AND s_gmt_offset = -5\n    AND d_year = 1998\n    AND d_moy = 11) promotional_sales,\n  (SELECT sum(ss_ext_sales_price) total\n  FROM {{TABLE:store_sales}}, {{TABLE:store}}, {{TABLE:date_dim}}, {{TABLE:customer}}, {{TABLE:customer_address}}, {{TABLE:item}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND ss_store_sk = s_store_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ca_address_sk = c_current_addr_sk\n    AND ss_item_sk = i_item_sk\n    AND ca_gmt_offset = -5\n    AND i_category = 'Jewelry'\n    AND s_gmt_offset = -5\n    AND d_year = 1998\n    AND d_moy = 11) all_sales\nORDER BY promotions, total\n",
    ),
    (
        "queryq62",
        "\nSELECT\n  substr(w_warehouse_name, 1, 20),\n  sm_type,\n  web_name,\n  sum(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk <= 30)\n    THEN 1\n      ELSE 0 END)  AS `30 days `,\n  sum(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 30) AND\n    (ws_ship_date_sk - ws_sold_date_sk <= 60)\n    THEN 1\n      ELSE 0 END)  AS `31 - 60 days `,\n  sum(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 60) AND\n    (ws_ship_date_sk - ws_sold_date_sk <= 90)\n    THEN 1\n      ELSE 0 END)  AS `61 - 90 days `,\n  sum(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 90) AND\n    (ws_ship_date_sk - ws_sold_date_sk <= 120)\n    THEN 1\n      ELSE 0 END)  AS `91 - 120 days `,\n  sum(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 120)\n    THEN 1\n      ELSE 0 END)  AS `>120 days `\nFROM\n  {{TABLE:web_sales}}, {{TABLE:warehouse}}, {{TABLE:ship_mode}}, {{TABLE:web_site}}, {{TABLE:date_dim}}\nWHERE\n  d_month_seq BETWEEN 1200 AND 1200 + 11\n    AND ws_ship_date_sk = d_date_sk\n    AND ws_warehouse_sk = w_warehouse_sk\n    AND ws_ship_mode_sk = sm_ship_mode_sk\n    AND ws_web_site_sk = web_site_sk\nGROUP BY\n  substr(w_warehouse_name, 1, 20), sm_type, web_name\nORDER BY\n  substr(w_warehouse_name, 1, 20), sm_type, web_name\n",
    ),
    (
        "queryq63",
        "\nSELECT *\nFROM (SELECT\n  i_manager_id,\n  sum(ss_sales_price) sum_sales,\n  avg(sum(ss_sales_price))\n  OVER (PARTITION BY i_manager_id) avg_monthly_sales\nFROM {{TABLE:item}}\n  , {{TABLE:store_sales}}\n  , {{TABLE:date_dim}}\n  , {{TABLE:store}}\nWHERE ss_item_sk = i_item_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND ss_store_sk = s_store_sk\n  AND d_month_seq IN (1200, 1200 + 1, 1200 + 2, 1200 + 3, 1200 + 4, 1200 + 5, 1200 + 6, 1200 + 7,\n                            1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11)\n  AND ((i_category IN ('Books', 'Children', 'Electronics')\n  AND i_class IN ('personal', 'portable', 'refernece', 'self-help')\n  AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7',\n                  'exportiunivamalg #9', 'scholaramalgamalg #9'))\n  OR (i_category IN ('Women', 'Music', 'Men')\n  AND i_class IN ('accessories', 'classical', 'fragrances', 'pants')\n  AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1',\n                  'importoamalg #1')))\nGROUP BY i_manager_id, d_moy) tmp1\nWHERE CASE WHEN avg_monthly_sales > 0\n  THEN abs(sum_sales - avg_monthly_sales) / avg_monthly_sales\n      ELSE NULL END > 0.1\nORDER BY i_manager_id\n  , avg_monthly_sales\n  , sum_sales\n",
    ),
    (
        "queryq64",
        "\nWITH cs_ui AS\n(SELECT\n    cs_item_sk,\n    sum(cs_ext_list_price) AS sale,\n    sum(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund\n  FROM {{TABLE:catalog_sales}}\n    , {{TABLE:catalog_returns}}\n  WHERE cs_item_sk = cr_item_sk\n    AND cs_order_number = cr_order_number\n  GROUP BY cs_item_sk\n  HAVING sum(cs_ext_list_price) > 2 * sum(cr_refunded_cash + cr_reversed_charge + cr_store_credit)),\n    cross_sales AS\n  (SELECT\n    i_product_name product_name,\n    i_item_sk item_sk,\n    s_store_name store_name,\n    s_zip store_zip,\n    ad1.ca_street_number b_street_number,\n    ad1.ca_street_name b_streen_name,\n    ad1.ca_city b_city,\n    ad1.ca_zip b_zip,\n    ad2.ca_street_number c_street_number,\n    ad2.ca_street_name c_street_name,\n    ad2.ca_city c_city,\n    ad2.ca_zip c_zip,\n    d1.d_year AS syear,\n    d2.d_year AS fsyear,\n    d3.d_year s2year,\n    count(*) cnt,\n    sum(ss_wholesale_cost) s1,\n    sum(ss_list_price) s2,\n    sum(ss_coupon_amt) s3\n  FROM {{TABLE:store_sales}}, {{TABLE:store_returns}}, cs_ui, {{TABLE:date_dim}} d1, {{TABLE:date_dim}} d2, {{TABLE:date_dim}} d3,\n    {{TABLE:store}}, {{TABLE:customer}}, {{TABLE:customer_demographics}} cd1, {{TABLE:customer_demographics}} cd2,\n    {{TABLE:promotion}}, {{TABLE:household_demographics}} hd1, {{TABLE:household_demographics}} hd2,\n    {{TABLE:customer_address}} ad1, {{TABLE:customer_address}} ad2, {{TABLE:income_band}} ib1, {{TABLE:income_band}} ib2, {{TABLE:item}}\n  WHERE ss_store_sk = s_store_sk AND\n    ss_sold_date_sk = d1.d_date_sk AND\n    ss_customer_sk = c_customer_sk AND\n    ss_cdemo_sk = cd1.cd_demo_sk AND\n    ss_hdemo_sk = hd1.hd_demo_sk AND\n    ss_addr_sk = ad1.ca_address_sk AND\n    ss_item_sk = i_item_sk AND\n    ss_item_sk = sr_item_sk AND\n    ss_ticket_number = sr_ticket_number AND\n    ss_item_sk = cs_ui.cs_item_sk AND\n    c_current_cdemo_sk = cd2.cd_demo_sk AND\n    c_current_hdemo_sk = hd2.hd_demo_sk AND\n    c_current_addr_sk = ad2.ca_address_sk AND\n    c_first_sales_date_sk = d2.d_date_sk AND\n    c_first_shipto_date_sk = d3.d_date_sk AND\n    ss_promo_sk = p_promo_sk AND\n    hd1.hd_income_band_sk = ib1.ib_income_band_sk AND\n    hd2.hd_income_band_sk = ib2.ib_income_band_sk AND\n    cd1.cd_marital_status <> cd2.cd_marital_status AND\n    i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND\n    i_current_price BETWEEN 64 AND 64 + 10 AND\n    i_current_price BETWEEN 64 + 1 AND 64 + 15\n  GROUP BY\n    i_product_name,\n    i_item_sk,\n    s_store_name,\n    s_zip,\n    ad1.ca_street_number,\n    ad1.ca_street_name,\n    ad1.ca_city,\n    ad1.ca_zip,\n    ad2.ca_street_number,\n    ad2.ca_street_name,\n    ad2.ca_city,\n    ad2.ca_zip,\n    d1.d_year,\n    d2.d_year,\n    d3.d_year\n  )\nSELECT\n  cs1.product_name,\n  cs1.store_name,\n  cs1.store_zip,\n  cs1.b_street_number,\n  cs1.b_streen_name,\n  cs1.b_city,\n  cs1.b_zip,\n  cs1.c_street_number,\n  cs1.c_street_name,\n  cs1.c_city,\n  cs1.c_zip,\n  cs1.syear,\n  cs1.cnt,\n  cs1.s1,\n  cs1.s2,\n  cs1.s3,\n  cs2.s1,\n  cs2.s2,\n  cs2.s3,\n  cs2.syear,\n  cs2.cnt\nFROM cross_sales cs1, cross_sales cs2\nWHERE cs1.item_sk = cs2.item_sk AND\n  cs1.syear = 1999 AND\n  cs2.syear = 1999 + 1 AND\n  cs2.cnt <= cs1.cnt AND\n  cs1.store_name = cs2.store_name AND\n  cs1.store_zip = cs2.store_zip\nORDER BY\n  cs1.product_name,\n  cs1.store_name,\n  cs2.cnt,\n  -- The two columns below are newly added in TPCDS v2.7\n  cs1.s1,\n  cs2.s1\n        ",
    ),
    (
        "queryq65",
        "\nSELECT\n  s_store_name,\n  i_item_desc,\n  sc.revenue,\n  i_current_price,\n  i_wholesale_cost,\n  i_brand\nFROM {{TABLE:store}}, {{TABLE:item}},\n  (SELECT\n    ss_store_sk,\n    avg(revenue) AS ave\n  FROM\n    (SELECT\n      ss_store_sk,\n      ss_item_sk,\n      sum(ss_sales_price) AS revenue\n    FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n    WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1176 AND 1176 + 11\n    GROUP BY ss_store_sk, ss_item_sk) sa\n  GROUP BY ss_store_sk) sb,\n  (SELECT\n    ss_store_sk,\n    ss_item_sk,\n    sum(ss_sales_price) AS revenue\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n  WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1176 AND 1176 + 11\n  GROUP BY ss_store_sk, ss_item_sk) sc\nWHERE sb.ss_store_sk = sc.ss_store_sk AND\n  sc.revenue <= 0.1 * sb.ave AND\n  s_store_sk = sc.ss_store_sk AND\n  i_item_sk = sc.ss_item_sk\nORDER BY s_store_name, i_item_desc\n",
    ),
    (
        "queryq66",
        "WITH unified AS (\n  SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_county, w.w_state, w.w_country, 'DHL,BARIAN' AS ship_carriers, d.d_year AS year, d.d_moy, (ws.ws_ext_sales_price * ws.ws_quantity) AS sales_amt, (ws.ws_net_paid * ws.ws_quantity) AS net_amt\n  FROM {{TABLE:web_sales}} ws\n  JOIN {{TABLE:warehouse}} w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n  JOIN {{TABLE:date_dim}} d  ON ws.ws_sold_date_sk = d.d_date_sk AND d.d_year = 2001\n  JOIN {{TABLE:time_dim}} t  ON ws.ws_sold_time_sk = t.t_time_sk AND t.t_time BETWEEN 30838 AND 30838 + 28800\n  JOIN {{TABLE:ship_mode}} sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk AND sm.sm_carrier IN ('DHL','BARIAN')\n  UNION ALL\n  SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_county, w.w_state, w.w_country, 'DHL,BARIAN' AS ship_carriers, d.d_year AS year, d.d_moy, (cs.cs_sales_price * cs.cs_quantity) AS sales_amt, (cs.cs_net_paid_inc_tax * cs.cs_quantity) AS net_amt\n  FROM {{TABLE:catalog_sales}} cs\n  JOIN {{TABLE:warehouse}} w ON cs.cs_warehouse_sk = w.w_warehouse_sk\n  JOIN {{TABLE:date_dim}} d  ON cs.cs_sold_date_sk = d.d_date_sk AND d.d_year = 2001\n  JOIN {{TABLE:time_dim}} t  ON cs.cs_sold_time_sk = t.t_time_sk AND t.t_time BETWEEN 30838 AND 30838 + 28800\n  JOIN {{TABLE:ship_mode}} sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk AND sm.sm_carrier IN ('DHL','BARIAN')\n)\nSELECT\n  w_warehouse_name,\n  w_warehouse_sq_ft,\n  w_city,\n  w_county,\n  w_state,\n  w_country,\n  ship_carriers,\n  year,\n  SUM(CASE WHEN d_moy = 1  THEN sales_amt ELSE 0 END) AS jan_sales,\n  SUM(CASE WHEN d_moy = 2  THEN sales_amt ELSE 0 END) AS feb_sales,\n  SUM(CASE WHEN d_moy = 3  THEN sales_amt ELSE 0 END) AS mar_sales,\n  SUM(CASE WHEN d_moy = 4  THEN sales_amt ELSE 0 END) AS apr_sales,\n  SUM(CASE WHEN d_moy = 5  THEN sales_amt ELSE 0 END) AS may_sales,\n  SUM(CASE WHEN d_moy = 6  THEN sales_amt ELSE 0 END) AS jun_sales,\n  SUM(CASE WHEN d_moy = 7  THEN sales_amt ELSE 0 END) AS jul_sales,\n  SUM(CASE WHEN d_moy = 8  THEN sales_amt ELSE 0 END) AS aug_sales,\n  SUM(CASE WHEN d_moy = 9  THEN sales_amt ELSE 0 END) AS sep_sales,\n  SUM(CASE WHEN d_moy = 10 THEN sales_amt ELSE 0 END) AS oct_sales,\n  SUM(CASE WHEN d_moy = 11 THEN sales_amt ELSE 0 END) AS nov_sales,\n  SUM(CASE WHEN d_moy = 12 THEN sales_amt ELSE 0 END) AS dec_sales,\n  SUM(CASE WHEN d_moy = 1  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS jan_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 2  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS feb_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 3  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS mar_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 4  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS apr_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 5  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS may_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 6  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS jun_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 7  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS jul_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 8  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS aug_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 9  THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS sep_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 10 THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS oct_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 11 THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS nov_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 12 THEN sales_amt ELSE 0 END) / NULLIF(MAX(w_warehouse_sq_ft), 0) AS dec_sales_per_sq_foot,\n  SUM(CASE WHEN d_moy = 1  THEN net_amt ELSE 0 END) AS jan_net,\n  SUM(CASE WHEN d_moy = 2  THEN net_amt ELSE 0 END) AS feb_net,\n  SUM(CASE WHEN d_moy = 3  THEN net_amt ELSE 0 END) AS mar_net,\n  SUM(CASE WHEN d_moy = 4  THEN net_amt ELSE 0 END) AS apr_net,\n  SUM(CASE WHEN d_moy = 5  THEN net_amt ELSE 0 END) AS may_net,\n  SUM(CASE WHEN d_moy = 6  THEN net_amt ELSE 0 END) AS jun_net,\n  SUM(CASE WHEN d_moy = 7  THEN net_amt ELSE 0 END) AS jul_net,\n  SUM(CASE WHEN d_moy = 8  THEN net_amt ELSE 0 END) AS aug_net,\n  SUM(CASE WHEN d_moy = 9  THEN net_amt ELSE 0 END) AS sep_net,\n  SUM(CASE WHEN d_moy = 10 THEN net_amt ELSE 0 END) AS oct_net,\n  SUM(CASE WHEN d_moy = 11 THEN net_amt ELSE 0 END) AS nov_net,\n  SUM(CASE WHEN d_moy = 12 THEN net_amt ELSE 0 END) AS dec_net\nFROM unified\nGROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year\nORDER BY w_warehouse_name;",
    ),
    (
        "queryq67",
        "\nSELECT *\nFROM\n  (SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    rank()\n    OVER (PARTITION BY i_category\n      ORDER BY sumsales DESC) rk\n  FROM\n    (SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      sum(coalesce(ss_sales_price * ss_quantity, 0)) sumsales\n    FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}, {{TABLE:item}}\n    WHERE ss_sold_date_sk = d_date_sk\n      AND ss_item_sk = i_item_sk\n      AND ss_store_sk = s_store_sk\n      AND d_month_seq BETWEEN 1200 AND 1200 + 11\n    GROUP BY ROLLUP (i_category, i_class, i_brand, i_product_name, d_year, d_qoy,\n      d_moy, s_store_id)) dw1) dw2\nWHERE rk <= 100\nORDER BY\n  i_category, i_class, i_brand, i_product_name, d_year,\n  d_qoy, d_moy, s_store_id, sumsales, rk\n",
    ),
    (
        "queryq67a",
        "\nwith results as (\n    select\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id,\n        sum(coalesce(ss_sales_price * ss_quantity, 0)) sumsales\n    from\n      {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}, {{TABLE:item}}\n    where\n      ss_sold_date_sk=d_date_sk\n        and ss_item_sk=i_item_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq between 1212 and 1212 + 11\n    group by\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id),\nresults_rollup as (\n    select\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      sumsales\n    from\n      results\n    union all\n    select\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      null s_store_id,\n      sum(sumsales) sumsales\n    from\n      results\n    group by\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy\n    union all\n    select\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      null d_moy,\n      null s_store_id,\n      sum(sumsales) sumsales\n    from\n      results\n    group by\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy\n    union all\n    select\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      null d_qoy,\n      null d_moy,\n      null s_store_id,\n      sum(sumsales) sumsales\n    from\n      results\n    group by\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year\n    union all\n    select\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      null d_year,\n      null d_qoy,\n      null d_moy,\n      null s_store_id,\n      sum(sumsales) sumsales\n  from\n    results\n  group by\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name\n  union all\n  select\n    i_category,\n    i_class,\n    i_brand,\n    null i_product_name,\n    null d_year,\n    null d_qoy,\n    null d_moy,\n    null s_store_id,\n    sum(sumsales) sumsales\n  from\n    results\n  group by\n    i_category,\n    i_class,\n    i_brand\n  union all\n  select\n    i_category,\n    i_class,\n    null i_brand,\n    null i_product_name,\n    null d_year,\n    null d_qoy,\n    null d_moy,\n    null s_store_id,\n    sum(sumsales) sumsales\n  from\n    results\n  group by\n    i_category,\n    i_class\n  union all\n  select\n    i_category,\n    null i_class,\n    null i_brand,\n    null i_product_name,\n    null d_year,\n    null d_qoy,\n    null d_moy,\n    null s_store_id,\n    sum(sumsales) sumsales\n  from results\n  group by\n    i_category\n  union all\n  select\n    null i_category,\n    null i_class,\n    null i_brand,\n    null i_product_name,\n    null d_year,\n    null d_qoy,\n    null d_moy,\n    null s_store_id,\n    sum(sumsales) sumsales\n  from\n    results)\nselect\n  *\nfrom (\n    select\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      sumsales,\n      rank() over (partition by i_category order by sumsales desc) rk\n    from results_rollup) dw2\nwhere\n  rk <= 100\norder by\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\n",
    ),
    (
        "queryq68",
        "\nSELECT\n  c.c_last_name,\n  c.c_first_name,\n  curr.ca_city,\n  dn.bought_city,\n  dn.ss_ticket_number,\n  dn.extended_price,\n  dn.extended_tax,\n  dn.list_price\nFROM (\n  SELECT\n    ss.ss_ticket_number,\n    ss.ss_customer_sk,\n    ca.ca_city AS bought_city,\n    SUM(ss.ss_ext_sales_price) AS extended_price,\n    SUM(ss.ss_ext_list_price) AS list_price,\n    SUM(ss.ss_ext_tax) AS extended_tax,\n    ss.ss_addr_sk\n  FROM {{TABLE:store_sales}} ss\n  JOIN {{TABLE:date_dim}} d   ON ss.ss_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:store}} s      ON ss.ss_store_sk     = s.s_store_sk\n  JOIN {{TABLE:household_demographics}} hd ON ss.ss_hdemo_sk = hd.hd_demo_sk\n  JOIN {{TABLE:customer_address}} ca ON ss.ss_addr_sk = ca.ca_address_sk\n  WHERE d.d_dom BETWEEN 1 AND 2\n    AND (hd.hd_dep_count = 4 OR hd.hd_vehicle_count = 3)\n    AND d.d_year IN (1999, 1999 + 1, 1999 + 2)\n    AND s.s_city IN ('Midway','Fairview')\n  GROUP BY ss.ss_ticket_number, ss.ss_customer_sk, ss.ss_addr_sk, ca.ca_city\n) dn\nJOIN {{TABLE:customer}} c            ON dn.ss_customer_sk = c.c_customer_sk\nJOIN {{TABLE:customer_address}} curr ON c.c_current_addr_sk = curr.ca_address_sk\nWHERE curr.ca_city <> dn.bought_city\nORDER BY c.c_last_name, dn.ss_ticket_number\n",
    ),
    (
        "queryq69",
        "\nSELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\nFROM\n  {{TABLE:customer}} c, {{TABLE:customer_address}} ca, {{TABLE:customer_demographics}}\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk AND\n    ca_state IN ('KY', 'GA', 'NM') AND\n    cd_demo_sk = c.c_current_cdemo_sk AND\n    exists(SELECT *\n           FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n           WHERE c.c_customer_sk = ss_customer_sk AND\n             ss_sold_date_sk = d_date_sk AND\n             d_year = 2001 AND\n             d_moy BETWEEN 4 AND 4 + 2) AND\n    (NOT exists(SELECT *\n                FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n                WHERE c.c_customer_sk = ws_bill_customer_sk AND\n                  ws_sold_date_sk = d_date_sk AND\n                  d_year = 2001 AND\n                  d_moy BETWEEN 4 AND 4 + 2) AND\n      NOT exists(SELECT *\n                 FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n                 WHERE c.c_customer_sk = cs_ship_customer_sk AND\n                   cs_sold_date_sk = d_date_sk AND\n                   d_year = 2001 AND\n                   d_moy BETWEEN 4 AND 4 + 2))\nGROUP BY cd_gender, cd_marital_status, cd_education_status,\n  cd_purchase_estimate, cd_credit_rating\nORDER BY cd_gender, cd_marital_status, cd_education_status,\n  cd_purchase_estimate, cd_credit_rating\n",
    ),
    (
        "queryq70",
        "\nSELECT\n  sum(ss_net_profit) AS total_sum,\n  s_state,\n  s_county,\n  grouping(s_state) + grouping(s_county) AS lochierarchy,\n  rank()\n  OVER (\n    PARTITION BY grouping(s_state) + grouping(s_county),\n      CASE WHEN grouping(s_county) = 0\n        THEN s_state END\n    ORDER BY sum(ss_net_profit) DESC) AS rank_within_parent\nFROM\n  {{TABLE:store_sales}}, {{TABLE:date_dim}} d1, {{TABLE:store}}\nWHERE\n  d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n    AND d1.d_date_sk = ss_sold_date_sk\n    AND s_store_sk = ss_store_sk\n    AND s_state IN\n    (SELECT s_state\n    FROM\n      (SELECT\n        s_state AS s_state,\n        rank()\n        OVER (PARTITION BY s_state\n          ORDER BY sum(ss_net_profit) DESC) AS ranking\n      FROM {{TABLE:store_sales}}, {{TABLE:store}}, {{TABLE:date_dim}}\n      WHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n        AND d_date_sk = ss_sold_date_sk\n        AND s_store_sk = ss_store_sk\n      GROUP BY s_state) tmp1\n    WHERE ranking <= 5)\nGROUP BY ROLLUP (s_state, s_county)\nORDER BY\n  lochierarchy DESC\n  , CASE WHEN lochierarchy = 0\n  THEN s_state END\n  , rank_within_parent\n",
    ),
    (
        "queryq70a",
        "\n with results as (\n    select\n      sum(ss_net_profit) as total_sum,\n      s_state ,s_county,\n      0 as gstate,\n      0 as g_county\n    from\n      {{TABLE:store_sales}}, {{TABLE:date_dim}} d1, {{TABLE:store}}\n    where\n      d1.d_month_seq between 1212 and 1212 + 11\n        and d1.d_date_sk = ss_sold_date_sk\n        and s_store_sk  = ss_store_sk\n        and s_state in (\n            select s_state\n            from (\n                select\n                  s_state as s_state,\n                  rank() over (partition by s_state order by sum(ss_net_profit) desc) as ranking\n                from {{TABLE:store_sales}}, {{TABLE:store}}, {{TABLE:date_dim}}\n                where d_month_seq between 1212 and 1212 + 11\n                  and d_date_sk = ss_sold_date_sk\n                  and s_store_sk  = ss_store_sk\n                group by s_state) tmp1\n              where ranking <= 5)\n    group by\n      s_state, s_county),\nresults_rollup as (\n    select\n      total_sum,\n      s_state,\n      s_county,\n      0 as g_state,\n      0 as g_county,\n      0 as lochierarchy\n    from results\n    union\n    select\n      sum(total_sum) as total_sum,s_state,\n      NULL as s_county,\n      0 as g_state,\n      1 as g_county,\n      1 as lochierarchy\n    from results\n    group by s_state\n    union\n    select\n      sum(total_sum) as total_sum,\n      NULL as s_state,\n      NULL as s_county,\n      1 as g_state,\n      1 as g_county,\n      2 as lochierarchy\n    from results)\nselect\n  total_sum,\n  s_state,\n  s_county,\n  lochierarchy,\n  rank() over (\n      partition by lochierarchy,\n      case when g_county = 0 then s_state end\n      order by total_sum desc) as rank_within_parent\nfrom\n  results_rollup\norder by\n  lochierarchy desc,\n  case when lochierarchy = 0 then s_state end,\n  rank_within_parent\n",
    ),
    (
        "queryq71",
        "\nSELECT\n  i_brand_id brand_id,\n  i_brand brand,\n  t_hour,\n  t_minute,\n  sum(ext_price) ext_price\nFROM {{TABLE:item}},\n  (SELECT\n     ws_ext_sales_price AS ext_price,\n     ws_sold_date_sk AS sold_date_sk,\n     ws_item_sk AS sold_item_sk,\n     ws_sold_time_sk AS time_sk\n   FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n   WHERE d_date_sk = ws_sold_date_sk\n     AND d_moy = 11\n     AND d_year = 1999\n   UNION ALL\n   SELECT\n     cs_ext_sales_price AS ext_price,\n     cs_sold_date_sk AS sold_date_sk,\n     cs_item_sk AS sold_item_sk,\n     cs_sold_time_sk AS time_sk\n   FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n   WHERE d_date_sk = cs_sold_date_sk\n     AND d_moy = 11\n     AND d_year = 1999\n   UNION ALL\n   SELECT\n     ss_ext_sales_price AS ext_price,\n     ss_sold_date_sk AS sold_date_sk,\n     ss_item_sk AS sold_item_sk,\n     ss_sold_time_sk AS time_sk\n   FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n   WHERE d_date_sk = ss_sold_date_sk\n     AND d_moy = 11\n     AND d_year = 1999\n  ) AS tmp, {{TABLE:time_dim}}\nWHERE\n  sold_item_sk = i_item_sk\n    AND i_manager_id = 1\n    AND time_sk = t_time_sk\n    AND (t_meal_time = 'breakfast' OR t_meal_time = 'dinner')\nGROUP BY i_brand, i_brand_id, t_hour, t_minute\nORDER BY ext_price DESC, brand_id\n        ",
    ),
    (
        "queryq72",
        "\nSELECT\n  i_item_desc,\n  w_warehouse_name,\n  d1.d_week_seq,\n  count(CASE WHEN p_promo_sk IS NULL\n    THEN 1\n        ELSE 0 END) no_promo,\n  count(CASE WHEN p_promo_sk IS NOT NULL\n    THEN 1\n        ELSE 0 END) promo,\n  count(*) total_cnt\nFROM {{TABLE:catalog_sales}}\n  JOIN {{TABLE:inventory}} ON (cs_item_sk = inv_item_sk)\n  JOIN {{TABLE:warehouse}} ON (w_warehouse_sk = inv_warehouse_sk)\n  JOIN {{TABLE:item}} ON (i_item_sk = cs_item_sk)\n  JOIN {{TABLE:customer_demographics}} ON (cs_bill_cdemo_sk = cd_demo_sk)\n  JOIN {{TABLE:household_demographics}} ON (cs_bill_hdemo_sk = hd_demo_sk)\n  JOIN {{TABLE:date_dim}} d1 ON (cs_sold_date_sk = d1.d_date_sk)\n  JOIN {{TABLE:date_dim}} d2 ON (inv_date_sk = d2.d_date_sk)\n  JOIN {{TABLE:date_dim}} d3 ON (cs_ship_date_sk = d3.d_date_sk)\n  LEFT OUTER JOIN {{TABLE:promotion}} ON (cs_promo_sk = p_promo_sk)\n  LEFT OUTER JOIN {{TABLE:catalog_returns}} ON (cr_item_sk = cs_item_sk AND cr_order_number = cs_order_number)\n-- q72 in TPCDS v1.4 had conditions below:\n-- WHERE d1.d_week_seq = d2.d_week_seq\n--   AND inv_quantity_on_hand < cs_quantity\n--   AND d3.d_date > (cast(d1.d_date AS DATE) + interval 5 days)\n--   AND hd_buy_potential = '>10000'\n--   AND d1.d_year = 1999\n--   AND hd_buy_potential = '>10000'\n--   AND cd_marital_status = 'D'\n--   AND d1.d_year = 1999\nWHERE d1.d_week_seq = d2.d_week_seq\n    AND inv_quantity_on_hand < cs_quantity\n    AND d3.d_date > d1.d_date + INTERVAL 5 days\n    AND hd_buy_potential = '1001-5000'\n    AND d1.d_year = 2001\n    AND cd_marital_status = 'M'\nGROUP BY i_item_desc, w_warehouse_name, d1.d_week_seq\nORDER BY total_cnt DESC, i_item_desc, w_warehouse_name, d_week_seq\n",
    ),
    (
        "queryq73",
        "\nSELECT c.c_last_name,\n  c.c_first_name,\n  c.c_salutation,\n  c.c_preferred_cust_flag,\n  dj.ss_ticket_number,\n  dj.cnt\nFROM (\n  SELECT ss.ss_ticket_number,\n    ss.ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM {{TABLE:store_sales}} AS ss\n  JOIN {{TABLE:date_dim}} AS d ON ss.ss_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:store}} AS s ON ss.ss_store_sk = s.s_store_sk\n  JOIN {{TABLE:household_demographics}} AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk\n  WHERE d.d_dom BETWEEN 1 AND 2\n    AND (hd.hd_buy_potential = '>10000' OR hd.hd_buy_potential = 'unknown')\n    AND hd.hd_vehicle_count > 0\n    AND CASE WHEN hd.hd_vehicle_count > 0 THEN hd.hd_dep_count / hd.hd_vehicle_count ELSE NULL END > 1\n    AND d.d_year IN (1999, 1999 + 1, 1999 + 2)\n    AND s.s_county IN ('Williamson County','Franklin Parish','Bronx County','Orange County')\n  GROUP BY ss.ss_ticket_number, ss.ss_customer_sk\n) AS dj\nJOIN {{TABLE:customer}} AS c ON dj.ss_customer_sk = c.c_customer_sk\nWHERE dj.cnt BETWEEN 1 AND 5\nORDER BY dj.cnt DESC;",
    ),
    (
        "queryq74",
        "\nWITH year_total AS (\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    d_year AS year,\n    sum(ss_net_paid) year_total,\n    's' sale_type\n  FROM\n    {{TABLE:customer}}, {{TABLE:store_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = ss_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year IN (2001, 2001 + 1)\n  GROUP BY\n    c_customer_id, c_first_name, c_last_name, d_year\n  UNION ALL\n  SELECT\n    c_customer_id customer_id,\n    c_first_name customer_first_name,\n    c_last_name customer_last_name,\n    d_year AS year,\n    sum(ws_net_paid) year_total,\n    'w' sale_type\n  FROM\n    {{TABLE:customer}}, {{TABLE:web_sales}}, {{TABLE:date_dim}}\n  WHERE c_customer_sk = ws_bill_customer_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year IN (2001, 2001 + 1)\n  GROUP BY\n    c_customer_id, c_first_name, c_last_name, d_year)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name\nFROM\n  year_total t_s_firstyear, year_total t_s_secyear,\n  year_total t_w_firstyear, year_total t_w_secyear\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.year = 2001\n  AND t_s_secyear.year = 2001 + 1\n  AND t_w_firstyear.year = 2001\n  AND t_w_secyear.year = 2001 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE WHEN t_w_firstyear.year_total > 0\n  THEN t_w_secyear.year_total / t_w_firstyear.year_total\n      ELSE NULL END\n  > CASE WHEN t_s_firstyear.year_total > 0\n  THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL END\n-- order-by list of q74 in TPCDS v1.4 is below:\n-- ORDER BY 1, 1, 1\nORDER BY 2, 1, 3\n",
    ),
    (
        "queryq75",
        "\nWITH all_sales AS (\n  SELECT\n    d_year,\n    i_brand_id,\n    i_class_id,\n    i_category_id,\n    i_manufact_id,\n    SUM(sales_cnt) AS sales_cnt,\n    SUM(sales_amt) AS sales_amt\n  FROM (\n         SELECT\n           d_year,\n           i_brand_id,\n           i_class_id,\n           i_category_id,\n           i_manufact_id,\n           cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt,\n           cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt\n         FROM {{TABLE:catalog_sales}}\n           JOIN {{TABLE:item}} ON i_item_sk = cs_item_sk\n           JOIN {{TABLE:date_dim}} ON d_date_sk = cs_sold_date_sk\n           LEFT JOIN {{TABLE:catalog_returns}} ON (cs_order_number = cr_order_number\n             AND cs_item_sk = cr_item_sk)\n         WHERE i_category = 'Books'\n         UNION\n         SELECT\n           d_year,\n           i_brand_id,\n           i_class_id,\n           i_category_id,\n           i_manufact_id,\n           ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt,\n           ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt\n         FROM {{TABLE:store_sales}}\n           JOIN {{TABLE:item}} ON i_item_sk = ss_item_sk\n           JOIN {{TABLE:date_dim}} ON d_date_sk = ss_sold_date_sk\n           LEFT JOIN {{TABLE:store_returns}} ON (ss_ticket_number = sr_ticket_number\n             AND ss_item_sk = sr_item_sk)\n         WHERE i_category = 'Books'\n         UNION\n         SELECT\n           d_year,\n           i_brand_id,\n           i_class_id,\n           i_category_id,\n           i_manufact_id,\n           ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt,\n           ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt\n         FROM {{TABLE:web_sales}}\n           JOIN {{TABLE:item}} ON i_item_sk = ws_item_sk\n           JOIN {{TABLE:date_dim}} ON d_date_sk = ws_sold_date_sk\n           LEFT JOIN {{TABLE:web_returns}} ON (ws_order_number = wr_order_number\n             AND ws_item_sk = wr_item_sk)\n         WHERE i_category = 'Books') sales_detail\n  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT\n  prev_yr.d_year AS prev_year,\n  curr_yr.d_year AS year,\n  curr_yr.i_brand_id,\n  curr_yr.i_class_id,\n  curr_yr.i_category_id,\n  curr_yr.i_manufact_id,\n  prev_yr.sales_cnt AS prev_yr_cnt,\n  curr_yr.sales_cnt AS curr_yr_cnt,\n  curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff,\n  curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff\nFROM all_sales curr_yr, all_sales prev_yr\nWHERE curr_yr.i_brand_id = prev_yr.i_brand_id\n  AND curr_yr.i_class_id = prev_yr.i_class_id\n  AND curr_yr.i_category_id = prev_yr.i_category_id\n  AND curr_yr.i_manufact_id = prev_yr.i_manufact_id\n  AND curr_yr.d_year = 2002\n  AND prev_yr.d_year = 2002 - 1\n  AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9\nORDER BY\n  sales_cnt_diff,\n  sales_amt_diff -- This order-by condition did not exist in TPCDS v1.4\n",
    ),
    (
        "queryq76",
        "\nSELECT\n  channel,\n  col_name,\n  d_year,\n  d_qoy,\n  i_category,\n  COUNT(*) sales_cnt,\n  SUM(ext_sales_price) sales_amt\nFROM (\n       SELECT\n         'store' AS channel,\n         ss_store_sk col_name,\n         d_year,\n         d_qoy,\n         i_category,\n         ss_ext_sales_price ext_sales_price\n       FROM {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       WHERE ss_store_sk IS NULL\n         AND ss_sold_date_sk = d_date_sk\n         AND ss_item_sk = i_item_sk\n       UNION ALL\n       SELECT\n         'web' AS channel,\n         ws_ship_customer_sk col_name,\n         d_year,\n         d_qoy,\n         i_category,\n         ws_ext_sales_price ext_sales_price\n       FROM {{TABLE:web_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       WHERE ws_ship_customer_sk IS NULL\n         AND ws_sold_date_sk = d_date_sk\n         AND ws_item_sk = i_item_sk\n       UNION ALL\n       SELECT\n         'catalog' AS channel,\n         cs_ship_addr_sk col_name,\n         d_year,\n         d_qoy,\n         i_category,\n         cs_ext_sales_price ext_sales_price\n       FROM {{TABLE:catalog_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\n       WHERE cs_ship_addr_sk IS NULL\n         AND cs_sold_date_sk = d_date_sk\n         AND cs_item_sk = i_item_sk) foo\nGROUP BY channel, col_name, d_year, d_qoy, i_category\nORDER BY channel, col_name, d_year, d_qoy, i_category\n",
    ),
    (
        "queryq77",
        "\nWITH ss AS\n(SELECT\n    s_store_sk,\n    sum(ss_ext_sales_price) AS sales,\n    sum(ss_net_profit) AS profit\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n  (cast('2000-08-03' AS DATE) + INTERVAL 30 days)\n    AND ss_store_sk = s_store_sk\n  GROUP BY s_store_sk),\n    sr AS\n  (SELECT\n    s_store_sk,\n    sum(sr_return_amt) AS returns,\n    sum(sr_net_loss) AS profit_loss\n  FROM {{TABLE:store_returns}}, {{TABLE:date_dim}}, {{TABLE:store}}\n  WHERE sr_returned_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n  (cast('2000-08-03' AS DATE) + INTERVAL 30 days)\n    AND sr_store_sk = s_store_sk\n  GROUP BY s_store_sk),\n    cs AS\n  (SELECT\n    cs_call_center_sk,\n    sum(cs_ext_sales_price) AS sales,\n    sum(cs_net_profit) AS profit\n  FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n  WHERE cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n  (cast('2000-08-03' AS DATE) + INTERVAL 30 days)\n  GROUP BY cs_call_center_sk),\n    cr AS\n  (SELECT\n    sum(cr_return_amount) AS returns,\n    sum(cr_net_loss) AS profit_loss\n  FROM {{TABLE:catalog_returns}}, {{TABLE:date_dim}}\n  WHERE cr_returned_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n  (cast('2000-08-03' AS DATE) + INTERVAL 30 days)),\n    ws AS\n  (SELECT\n    wp_web_page_sk,\n    sum(ws_ext_sales_price) AS sales,\n    sum(ws_net_profit) AS profit\n  FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}, {{TABLE:web_page}}\n  WHERE ws_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n  (cast('2000-08-03' AS DATE) + INTERVAL 30 days)\n    AND ws_web_page_sk = wp_web_page_sk\n  GROUP BY wp_web_page_sk),\n    wr AS\n  (SELECT\n    wp_web_page_sk,\n    sum(wr_return_amt) AS returns,\n    sum(wr_net_loss) AS profit_loss\n  FROM {{TABLE:web_returns}}, {{TABLE:date_dim}}, {{TABLE:web_page}}\n  WHERE wr_returned_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n  (cast('2000-08-03' AS DATE) + INTERVAL 30 days)\n    AND wr_web_page_sk = wp_web_page_sk\n  GROUP BY wp_web_page_sk)\nSELECT\n  channel,\n  id,\n  sum(sales) AS sales,\n  sum(returns) AS returns,\n  sum(profit) AS profit\nFROM\n  (SELECT\n     'store channel' AS channel,\n     ss.s_store_sk AS id,\n     sales,\n     coalesce(returns, 0) AS returns,\n     (profit - coalesce(profit_loss, 0)) AS profit\n   FROM ss\n     LEFT JOIN sr\n       ON ss.s_store_sk = sr.s_store_sk\n   UNION ALL\n   SELECT\n     'catalog channel' AS channel,\n     cs_call_center_sk AS id,\n     sales,\n     returns,\n     (profit - profit_loss) AS profit\n   FROM cs, cr\n   UNION ALL\n   SELECT\n     'web channel' AS channel,\n     ws.wp_web_page_sk AS id,\n     sales,\n     coalesce(returns, 0) returns,\n     (profit - coalesce(profit_loss, 0)) AS profit\n   FROM ws\n     LEFT JOIN wr\n       ON ws.wp_web_page_sk = wr.wp_web_page_sk\n  ) x\nGROUP BY ROLLUP (channel, id)\nORDER BY channel, id\n",
    ),
    (
        "queryq77a",
        "\nwith ss as (\n    select\n      s_store_sk,\n      sum(ss_ext_sales_price) as sales,\n      sum(ss_net_profit) as profit\n    from\n      {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}\n    where\n      ss_sold_date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + interval 30 days)\n        and ss_store_sk = s_store_sk\n    group by\n      s_store_sk),\nsr as (\n    select\n      s_store_sk,\n      sum(sr_return_amt) as returns,\n      sum(sr_net_loss) as profit_loss\n    from\n      {{TABLE:store_returns}}, {{TABLE:date_dim}}, {{TABLE:store}}\n    where\n      sr_returned_date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + interval 30 days)\n        and sr_store_sk = s_store_sk\n     group by\n       s_store_sk),\ncs as (\n    select\n      cs_call_center_sk,\n      sum(cs_ext_sales_price) as sales,\n      sum(cs_net_profit) as profit\n    from\n      {{TABLE:catalog_sales}},\n      {{TABLE:date_dim}}\n    where\n      cs_sold_date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + interval 30 days)\n    group by\n      cs_call_center_sk),\n cr as (\n     select\n       sum(cr_return_amount) as returns,\n       sum(cr_net_loss) as profit_loss\n     from {{TABLE:catalog_returns}},\n       {{TABLE:date_dim}}\n     where\n       cr_returned_date_sk = d_date_sk\n         and d_date between cast('1998-08-04' as date)\n         and (cast('1998-08-04' as date) + interval 30 days)),\nws as ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from {{TABLE:web_sales}},\n      {{TABLE:date_dim}},\n      {{TABLE:web_page}}\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-04' as date)\n                  and (cast('1998-08-04' as date) +  interval 30 days)\n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from {{TABLE:web_returns}},\n      {{TABLE:date_dim}},\n      {{TABLE:web_page}}\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('1998-08-04' as date)\n                  and (cast('1998-08-04' as date) +  interval 30 days)\n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by channel, id )\n\n  select  *\n from (\n select channel, id, sales, returns, profit from  results\n union\n select channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results group by channel\n union\n select NULL AS channel, NULL AS id, sum(sales) as sales, sum(returns) as returns, sum(profit) as profit from  results\n) foo\norder by\n  channel, id\n",
    ),
    (
        "queryq78",
        "\nWITH ws AS\n(SELECT\n    d_year AS ws_sold_year,\n    ws_item_sk,\n    ws_bill_customer_sk ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc,\n    sum(ws_sales_price) ws_sp\n  FROM {{TABLE:web_sales}}\n    LEFT JOIN {{TABLE:web_returns}} ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk\n    JOIN {{TABLE:date_dim}} ON ws_sold_date_sk = d_date_sk\n  WHERE wr_order_number IS NULL\n  GROUP BY d_year, ws_item_sk, ws_bill_customer_sk\n),\n    cs AS\n  (SELECT\n    d_year AS cs_sold_year,\n    cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n    sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n  FROM {{TABLE:catalog_sales}}\n    LEFT JOIN {{TABLE:catalog_returns}} ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk\n    JOIN {{TABLE:date_dim}} ON cs_sold_date_sk = d_date_sk\n  WHERE cr_order_number IS NULL\n  GROUP BY d_year, cs_item_sk, cs_bill_customer_sk\n  ),\n    ss AS\n  (SELECT\n    d_year AS ss_sold_year,\n    ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity) ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n  FROM {{TABLE:store_sales}}\n    LEFT JOIN {{TABLE:store_returns}} ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk\n    JOIN {{TABLE:date_dim}} ON ss_sold_date_sk = d_date_sk\n  WHERE sr_ticket_number IS NULL\n  GROUP BY d_year, ss_item_sk, ss_customer_sk\n  )\nSELECT\n  round(ss_qty / (coalesce(ws_qty + cs_qty, 1)), 2) ratio,\n  ss_qty store_qty,\n  ss_wc store_wholesale_cost,\n  ss_sp store_sales_price,\n  coalesce(ws_qty, 0) + coalesce(cs_qty, 0) other_chan_qty,\n  coalesce(ws_wc, 0) + coalesce(cs_wc, 0) other_chan_wholesale_cost,\n  coalesce(ws_sp, 0) + coalesce(cs_sp, 0) other_chan_sales_price\nFROM ss\n  LEFT JOIN ws\n    ON (ws_sold_year = ss_sold_year AND ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk)\n  LEFT JOIN cs\n    ON (cs_sold_year = ss_sold_year AND cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk)\nWHERE coalesce(ws_qty, 0) > 0 AND coalesce(cs_qty, 0) > 0 AND ss_sold_year = 2000\nORDER BY\n  -- order-by list of q78 in TPCDS v1.4 is below:\n  -- ratio,\n  -- ss_qty DESC, ss_wc DESC, ss_sp DESC,\n  -- other_chan_qty,\n  -- other_chan_wholesale_cost,\n  -- other_chan_sales_price,\n  -- round(ss_qty / (coalesce(ws_qty + cs_qty, 1)), 2)\n  ss_sold_year,\n  ss_item_sk,\n  ss_customer_sk,\n  ss_qty desc,\n  ss_wc desc,\n  ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n  ratio\n",
    ),
    (
        "queryq79",
        "\nSELECT c.c_last_name,\n  c.c_first_name,\n  SUBSTR(ms.city_raw, 1, 30) AS s_city,\n  ms.ss_ticket_number,\n  ms.amt,\n  ms.profit\nFROM (\n  SELECT ss.ss_ticket_number,\n         ss.ss_customer_sk,\n         s.s_city AS city_raw,\n         SUM(ss.ss_coupon_amt) AS amt,\n         SUM(ss.ss_net_profit) AS profit\n  FROM {{TABLE:store_sales}} ss\n  JOIN {{TABLE:date_dim}} d ON ss.ss_sold_date_sk = d.d_date_sk\n  JOIN {{TABLE:store}} s ON ss.ss_store_sk = s.s_store_sk\n  JOIN {{TABLE:household_demographics}} hd ON ss.ss_hdemo_sk = hd.hd_demo_sk\n  WHERE (hd.hd_dep_count = 6 OR hd.hd_vehicle_count > 2)\n    AND d.d_dow = 1\n    AND d.d_year IN (1999, 1999 + 1, 1999 + 2)\n    AND s.s_number_employees BETWEEN 200 AND 295\n  GROUP BY ss.ss_ticket_number, ss.ss_customer_sk, s.s_city\n) ms\nJOIN {{TABLE:customer}} c ON ms.ss_customer_sk = c.c_customer_sk\nORDER BY c.c_last_name, c.c_first_name, s_city, ms.profit;",
    ),
    (
        "queryq80",
        "\nWITH ssr AS\n(SELECT\n    s_store_id AS store_id,\n    sum(ss_ext_sales_price) AS sales,\n    sum(coalesce(sr_return_amt, 0)) AS returns,\n    sum(ss_net_profit - coalesce(sr_net_loss, 0)) AS profit\n  FROM {{TABLE:store_sales}}\n    LEFT OUTER JOIN {{TABLE:store_returns}} ON\n                                    (ss_item_sk = sr_item_sk AND\n                                      ss_ticket_number = sr_ticket_number)\n    ,\n    {{TABLE:date_dim}}, {{TABLE:store}}, {{TABLE:item}}, {{TABLE:promotion}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-23' AS DATE)\n  AND (cast('2000-08-23' AS DATE) + INTERVAL 30 days)\n    AND ss_store_sk = s_store_sk\n    AND ss_item_sk = i_item_sk\n    AND i_current_price > 50\n    AND ss_promo_sk = p_promo_sk\n    AND p_channel_tv = 'N'\n  GROUP BY s_store_id),\n    csr AS\n  (SELECT\n    cp_catalog_page_id AS catalog_page_id,\n    sum(cs_ext_sales_price) AS sales,\n    sum(coalesce(cr_return_amount, 0)) AS returns,\n    sum(cs_net_profit - coalesce(cr_net_loss, 0)) AS profit\n  FROM {{TABLE:catalog_sales}}\n    LEFT OUTER JOIN {{TABLE:catalog_returns}} ON\n                                      (cs_item_sk = cr_item_sk AND\n                                        cs_order_number = cr_order_number)\n    ,\n    {{TABLE:date_dim}}, {{TABLE:catalog_page}}, {{TABLE:item}}, {{TABLE:promotion}}\n  WHERE cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-23' AS DATE)\n  AND (cast('2000-08-23' AS DATE) + INTERVAL 30 days)\n    AND cs_catalog_page_sk = cp_catalog_page_sk\n    AND cs_item_sk = i_item_sk\n    AND i_current_price > 50\n    AND cs_promo_sk = p_promo_sk\n    AND p_channel_tv = 'N'\n  GROUP BY cp_catalog_page_id),\n    wsr AS\n  (SELECT\n    web_site_id,\n    sum(ws_ext_sales_price) AS sales,\n    sum(coalesce(wr_return_amt, 0)) AS returns,\n    sum(ws_net_profit - coalesce(wr_net_loss, 0)) AS profit\n  FROM {{TABLE:web_sales}}\n    LEFT OUTER JOIN {{TABLE:web_returns}} ON\n                                  (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number)\n    ,\n    {{TABLE:date_dim}}, {{TABLE:web_site}}, {{TABLE:item}}, {{TABLE:promotion}}\n  WHERE ws_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('2000-08-23' AS DATE)\n  AND (cast('2000-08-23' AS DATE) + INTERVAL 30 days)\n    AND ws_web_site_sk = web_site_sk\n    AND ws_item_sk = i_item_sk\n    AND i_current_price > 50\n    AND ws_promo_sk = p_promo_sk\n    AND p_channel_tv = 'N'\n  GROUP BY web_site_id)\nSELECT\n  channel,\n  id,\n  sum(sales) AS sales,\n  sum(returns) AS returns,\n  sum(profit) AS profit\nFROM (SELECT\n        'store channel' AS channel,\n        concat('store', store_id) AS id,\n        sales,\n        returns,\n        profit\n      FROM ssr\n      UNION ALL\n      SELECT\n        'catalog channel' AS channel,\n        concat('catalog_page', catalog_page_id) AS id,\n        sales,\n        returns,\n        profit\n      FROM csr\n      UNION ALL\n      SELECT\n        'web channel' AS channel,\n        concat('web_site', web_site_id) AS id,\n        sales,\n        returns,\n        profit\n      FROM wsr) x\nGROUP BY ROLLUP (channel, id)\nORDER BY channel, id\n",
    ),
    (
        "queryq80a",
        "\nwith ssr as (\n    select\n      s_store_id as store_id,\n      sum(ss_ext_sales_price) as sales,\n      sum(coalesce(sr_return_amt, 0)) as returns,\n      sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n    from\n      {{TABLE:store_sales}} left outer join {{TABLE:store_returns}} on (\n          ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n      {{TABLE:date_dim}},\n      {{TABLE:store}},\n      {{TABLE:item}},\n      {{TABLE:promotion}}\n    where\n      ss_sold_date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + interval 30 days)\n        and ss_store_sk = s_store_sk\n        and ss_item_sk = i_item_sk\n        and i_current_price > 50\n        and ss_promo_sk = p_promo_sk\n        and p_channel_tv = 'N'\n    group by\n      s_store_id),\ncsr as (\n    select\n      cp_catalog_page_id as catalog_page_id,\n      sum(cs_ext_sales_price) as sales,\n      sum(coalesce(cr_return_amount, 0)) as returns,\n      sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n    from\n      {{TABLE:catalog_sales}} left outer join {{TABLE:catalog_returns}} on\n          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n      {{TABLE:date_dim}},\n      {{TABLE:catalog_page}},\n      {{TABLE:item}},\n      {{TABLE:promotion}}\n    where\n      cs_sold_date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + interval 30 days)\n        and cs_catalog_page_sk = cp_catalog_page_sk\n        and cs_item_sk = i_item_sk\n        and i_current_price > 50\n        and cs_promo_sk = p_promo_sk\n        and p_channel_tv = 'N'\n    group by\n      cp_catalog_page_id),\nwsr as (\n    select\n      web_site_id,\n      sum(ws_ext_sales_price) as sales,\n      sum(coalesce(wr_return_amt, 0)) as returns,\n      sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n    from\n      {{TABLE:web_sales}} left outer join {{TABLE:web_returns}} on (\n          ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n      {{TABLE:date_dim}},\n      {{TABLE:web_site}},\n      {{TABLE:item}},\n      {{TABLE:promotion}}\n    where\n      ws_sold_date_sk = d_date_sk\n        and d_date between cast('1998-08-04' as date)\n        and (cast('1998-08-04' as date) + interval 30 days)\n        and ws_web_site_sk = web_site_sk\n        and ws_item_sk = i_item_sk\n        and i_current_price > 50\n        and ws_promo_sk = p_promo_sk\n        and p_channel_tv = 'N'\n    group by\n      web_site_id),\nresults as (\n    select\n      channel,\n      id,\n      sum(sales) as sales,\n      sum(returns) as returns,\n      sum(profit) as profit\n    from (\n        select\n          'store channel' as channel,\n          'store' || store_id as id,\n          sales,\n          returns,\n          profit\n        from\n          ssr\n        union all\n        select\n          'catalog channel' as channel,\n          'catalog_page' || catalog_page_id as id,\n          sales,\n          returns,\n          profit\n        from\n          csr\n        union all\n        select\n          'web channel' as channel,\n          'web_site' || web_site_id as id,\n          sales,\n          returns,\n          profit\n        from\n          wsr) x\n    group by\n      channel, id)\nselect\n  channel,\n  id,\n  sales,\n  returns,\n  profit\nfrom (\n    select\n      channel,\n      id,\n      sales,\n      returns,\n      profit\n    from\n      results\n    union\n    select\n      channel,\n      NULL AS id,\n      sum(sales) as sales,\n      sum(returns) as returns,\n      sum(profit) as profit\n    from\n      results\n    group by\n      channel\n    union\n    select\n      NULL AS channel,\n      NULL AS id,\n      sum(sales) as sales,\n      sum(returns) as returns,\n      sum(profit) as profit\n    from\n      results) foo\norder by\n  channel, id\n",
    ),
    (
        "queryq81",
        "\nWITH customer_total_return AS\n(SELECT\n    cr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    sum(cr_return_amt_inc_tax) AS ctr_total_return\n  FROM {{TABLE:catalog_returns}}, {{TABLE:date_dim}}, {{TABLE:customer_address}}\n  WHERE cr_returned_date_sk = d_date_sk\n    AND d_year = 2000\n    AND cr_returning_addr_sk = ca_address_sk\n  GROUP BY cr_returning_customer_sk, ca_state )\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  ca_street_number,\n  ca_street_name,\n  ca_street_type,\n  ca_suite_number,\n  ca_city,\n  ca_county,\n  ca_state,\n  ca_zip,\n  ca_country,\n  ca_gmt_offset,\n  ca_location_type,\n  ctr_total_return\nFROM customer_total_return ctr1, {{TABLE:customer_address}}, {{TABLE:customer}}\nWHERE ctr1.ctr_total_return > (SELECT avg(ctr_total_return) * 1.2\nFROM customer_total_return ctr2\nWHERE ctr1.ctr_state = ctr2.ctr_state)\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'GA'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name\n  , ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset\n  , ca_location_type, ctr_total_return\n",
    ),
    (
        "queryq82",
        "\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_current_price\nFROM {{TABLE:item}} item, {{TABLE:inventory}} inventory, {{TABLE:date_dim}} date_dim, {{TABLE:store_sales}} store_sales\nWHERE i_current_price BETWEEN 62 AND 62 + 30\n  AND inv_item_sk = i_item_sk\n  AND d_date_sk = inv_date_sk\n  AND d_date BETWEEN cast('2000-05-25' AS DATE) AND (cast('2000-05-25' AS DATE) + INTERVAL 60 days)\n  AND i_manufact_id IN (129, 270, 821, 423)\n  AND inv_quantity_on_hand BETWEEN 100 AND 500\n  AND ss_item_sk = i_item_sk\nGROUP BY i_item_id, i_item_desc, i_current_price\nORDER BY i_item_id\n",
    ),
    (
        "queryq83",
        "\nWITH weeks AS (\n  SELECT DISTINCT d_week_seq\n  FROM {{TABLE:date_dim}}\n  WHERE d_date IN (DATE '2000-06-30', DATE '2000-09-27', DATE '2000-11-17')\n),\n sr_items AS (\n  SELECT i.i_item_id AS item_id, SUM(sr.sr_return_quantity) AS sr_item_qty\n  FROM {{TABLE:store_returns}} sr\n  JOIN {{TABLE:item}} i ON sr.sr_item_sk = i.i_item_sk\n  JOIN {{TABLE:date_dim}} d ON sr.sr_returned_date_sk = d.d_date_sk\n  WHERE d.d_week_seq IN (SELECT d_week_seq FROM weeks)\n  GROUP BY i.i_item_id\n),\n cr_items AS (\n  SELECT i.i_item_id AS item_id, SUM(cr.cr_return_quantity) AS cr_item_qty\n  FROM {{TABLE:catalog_returns}} cr\n  JOIN {{TABLE:item}} i ON cr.cr_item_sk = i.i_item_sk\n  JOIN {{TABLE:date_dim}} d ON cr.cr_returned_date_sk = d.d_date_sk\n  WHERE d.d_week_seq IN (SELECT d_week_seq FROM weeks)\n  GROUP BY i.i_item_id\n),\n wr_items AS (\n  SELECT i.i_item_id AS item_id, SUM(wr.wr_return_quantity) AS wr_item_qty\n  FROM {{TABLE:web_returns}} wr\n  JOIN {{TABLE:item}} i ON wr.wr_item_sk = i.i_item_sk\n  JOIN {{TABLE:date_dim}} d ON wr.wr_returned_date_sk = d.d_date_sk\n  WHERE d.d_week_seq IN (SELECT d_week_seq FROM weeks)\n  GROUP BY i.i_item_id\n)\nSELECT si.item_id,\n       si.sr_item_qty,\n       si.sr_item_qty / NULLIF((si.sr_item_qty + ci.cr_item_qty + wi.wr_item_qty),0) / 3.0 * 100 AS sr_dev,\n       ci.cr_item_qty,\n       ci.cr_item_qty / NULLIF((si.sr_item_qty + ci.cr_item_qty + wi.wr_item_qty),0) / 3.0 * 100 AS cr_dev,\n       wi.wr_item_qty,\n       wi.wr_item_qty / NULLIF((si.sr_item_qty + ci.cr_item_qty + wi.wr_item_qty),0) / 3.0 * 100 AS wr_dev,\n       (si.sr_item_qty + ci.cr_item_qty + wi.wr_item_qty) / 3.0 AS average\nFROM sr_items si\nJOIN cr_items ci ON si.item_id = ci.item_id\nJOIN wr_items wi ON si.item_id = wi.item_id\nORDER BY si.item_id, si.sr_item_qty;",
    ),
    (
        "queryq84",
        "\nSELECT\n  c_customer_id AS customer_id,\n  concat(c_last_name, ', ', c_first_name) AS customername\nFROM {{TABLE:customer}}\n  , {{TABLE:customer_address}}\n  , {{TABLE:customer_demographics}}\n  , {{TABLE:household_demographics}}\n  , {{TABLE:income_band}}\n  , {{TABLE:store_returns}}\nWHERE ca_city = 'Edgewood'\n  AND c_current_addr_sk = ca_address_sk\n  AND ib_lower_bound >= 38128\n  AND ib_upper_bound <= 38128 + 50000\n  AND ib_income_band_sk = hd_income_band_sk\n  AND cd_demo_sk = c_current_cdemo_sk\n  AND hd_demo_sk = c_current_hdemo_sk\n  AND sr_cdemo_sk = cd_demo_sk\nORDER BY c_customer_id\n",
    ),
    (
        "queryq85",
        "SELECT substr(r.r_reason_desc, 1, 20) AS reason_prefix, AVG(ws.ws_quantity) AS avg_ws_quantity, AVG(wr.wr_refunded_cash) AS avg_wr_refunded_cash, AVG(wr.wr_fee) AS avg_wr_fee \nFROM {{TABLE:web_sales}} ws \nJOIN {{TABLE:web_returns}} wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number \nJOIN {{TABLE:web_page}} wp ON ws.ws_web_page_sk = wp.wp_web_page_sk \nJOIN {{TABLE:customer_demographics}} cd1 ON cd1.cd_demo_sk = wr.wr_refunded_cdemo_sk \nJOIN {{TABLE:customer_demographics}} cd2 ON cd2.cd_demo_sk = wr.wr_returning_cdemo_sk \nJOIN {{TABLE:customer_address}} ca ON ca.ca_address_sk = wr.wr_refunded_addr_sk \nJOIN {{TABLE:date_dim}} d ON ws.ws_sold_date_sk = d.d_date_sk \nJOIN {{TABLE:reason}} r ON r.r_reason_sk = wr.wr_reason_sk \nWHERE d.d_year = 2000 AND ((cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Advanced Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws.ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status AND ws.ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws.ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca.ca_country = 'United States' AND ca.ca_state IN ('IN','OH','NJ') AND ws.ws_net_profit BETWEEN 100 AND 200) OR (ca.ca_country = 'United States' AND ca.ca_state IN ('WI','CT','KY') AND ws.ws_net_profit BETWEEN 150 AND 300) OR (ca.ca_country = 'United States' AND ca.ca_state IN ('LA','IA','AR') AND ws.ws_net_profit BETWEEN 50 AND 250)) \nGROUP BY r.r_reason_desc \nORDER BY substr(r.r_reason_desc, 1, 20), AVG(ws.ws_quantity), AVG(wr.wr_refunded_cash), AVG(wr.wr_fee);",
    ),
    (
        "queryq86",
        "\nSELECT\n  sum(ws_net_paid) AS total_sum,\n  i_category,\n  i_class,\n  grouping(i_category) + grouping(i_class) AS lochierarchy,\n  rank()\n  OVER (\n    PARTITION BY grouping(i_category) + grouping(i_class),\n      CASE WHEN grouping(i_class) = 0\n        THEN i_category END\n    ORDER BY sum(ws_net_paid) DESC) AS rank_within_parent\nFROM\n  {{TABLE:web_sales}}, {{TABLE:date_dim}} d1, {{TABLE:item}}\nWHERE\n  d1.d_month_seq BETWEEN 1200 AND 1200 + 11\n    AND d1.d_date_sk = ws_sold_date_sk\n    AND i_item_sk = ws_item_sk\nGROUP BY ROLLUP (i_category, i_class)\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0\n    THEN i_category END,\n  rank_within_parent\n",
    ),
    (
        "queryq86a",
        "\nwith results as (\n    select\n      sum(ws_net_paid) as total_sum,\n      i_category, i_class,\n      0 as g_category,\n      0 as g_class\n    from\n      {{TABLE:web_sales}}, {{TABLE:date_dim}} d1, {{TABLE:item}}\n    where\n      d1.d_month_seq between 1212 and 1212 + 11\n        and d1.d_date_sk = ws_sold_date_sk\n        and i_item_sk = ws_item_sk\n    group by\n      i_category, i_class),\nresults_rollup as(\n    select\n      total_sum,\n      i_category,\n      i_class,\n      g_category,\n      g_class,\n      0 as lochierarchy\n    from\n      results\n    union\n    select\n      sum(total_sum) as total_sum,\n      i_category,\n      NULL as i_class,\n      0 as g_category,\n      1 as g_class,\n      1 as lochierarchy\n    from\n      results\n    group by\n      i_category\n    union\n    select\n      sum(total_sum) as total_sum,\n      NULL as i_category,\n      NULL as i_class,\n      1 as g_category,\n      1 as g_class,\n      2 as lochierarchy\n    from\n      results)\nselect\n  total_sum,\n  i_category ,i_class, lochierarchy,\n  rank() over (\n      partition by lochierarchy,\n        case when g_class = 0 then i_category end\n      order by total_sum desc) as rank_within_parent\nfrom\n  results_rollup\norder by\n  lochierarchy desc,\n  case when lochierarchy = 0 then i_category end,\n  rank_within_parent\n",
    ),
    (
        "queryq87",
        "\nWITH ss_set AS (SELECT DISTINCT c.c_last_name AS last_name, c.c_first_name AS first_name, d.d_date AS d_date \nFROM {{TABLE:store_sales}} ss \nJOIN {{TABLE:date_dim}} d ON ss.ss_sold_date_sk = d.d_date_sk \nJOIN {{TABLE:customer}} c ON ss.ss_customer_sk = c.c_customer_sk \nWHERE d.d_month_seq BETWEEN 1200 AND 1211), \ncs_set AS (SELECT DISTINCT c.c_last_name AS last_name, c.c_first_name AS first_name, d.d_date AS d_date \nFROM {{TABLE:catalog_sales}} cs \nJOIN {{TABLE:date_dim}} d ON cs.cs_sold_date_sk = d.d_date_sk \nJOIN {{TABLE:customer}} c ON cs.cs_bill_customer_sk = c.c_customer_sk \nWHERE d.d_month_seq BETWEEN 1200 AND 1211), \nws_set AS (SELECT DISTINCT c.c_last_name AS last_name, c.c_first_name AS first_name, d.d_date AS d_date \nFROM {{TABLE:web_sales}} ws \nJOIN {{TABLE:date_dim}} d ON ws.ws_sold_date_sk = d.d_date_sk \nJOIN {{TABLE:customer}} c ON ws.ws_bill_customer_sk = c.c_customer_sk \nWHERE d.d_month_seq BETWEEN 1200 AND 1211) \nSELECT COUNT(*) \nFROM ((SELECT * FROM ss_set EXCEPT SELECT * FROM cs_set) EXCEPT SELECT * FROM ws_set) cool_cust;",
    ),
    (
        "queryq88",
        "\nSELECT \n  SUM(CASE WHEN td.t_hour = 8 AND td.t_minute >= 30 THEN 1 ELSE 0 END) AS h8_30_to_9,\n  SUM(CASE WHEN td.t_hour = 9 AND td.t_minute < 30 THEN 1 ELSE 0 END) AS h9_to_9_30,\n  SUM(CASE WHEN td.t_hour = 9 AND td.t_minute >= 30 THEN 1 ELSE 0 END) AS h9_30_to_10,\n  SUM(CASE WHEN td.t_hour = 10 AND td.t_minute < 30 THEN 1 ELSE 0 END) AS h10_to_10_30,\n  SUM(CASE WHEN td.t_hour = 10 AND td.t_minute >= 30 THEN 1 ELSE 0 END) AS h10_30_to_11,\n  SUM(CASE WHEN td.t_hour = 11 AND td.t_minute < 30 THEN 1 ELSE 0 END) AS h11_to_11_30,\n  SUM(CASE WHEN td.t_hour = 11 AND td.t_minute >= 30 THEN 1 ELSE 0 END) AS h11_30_to_12,\n  SUM(CASE WHEN td.t_hour = 12 AND td.t_minute < 30 THEN 1 ELSE 0 END) AS h12_to_12_30\nFROM {{TABLE:store_sales}} ss\nJOIN {{TABLE:household_demographics}} hd ON ss.ss_hdemo_sk = hd.hd_demo_sk\nJOIN {{TABLE:time_dim}} td ON ss.ss_sold_time_sk = td.t_time_sk\nJOIN {{TABLE:store}} s ON ss.ss_store_sk = s.s_store_sk\nWHERE s.s_store_name = 'ese'\n  AND ((hd.hd_dep_count = 4 AND hd.hd_vehicle_count <= 4 + 2) OR (hd.hd_dep_count = 2 AND hd.hd_vehicle_count <= 2 + 2) OR (hd.hd_dep_count = 0 AND hd.hd_vehicle_count <= 0 + 2))",
    ),
    (
        "queryq89",
        "\nSELECT *\nFROM (\n       SELECT\n         i_category,\n         i_class,\n         i_brand,\n         s_store_name,\n         s_company_name,\n         d_moy,\n         sum(ss_sales_price) sum_sales,\n         avg(sum(ss_sales_price))\n         OVER\n         (PARTITION BY i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\n       FROM {{TABLE:item}}, {{TABLE:store_sales}}, {{TABLE:date_dim}}, {{TABLE:store}}\n       WHERE ss_item_sk = i_item_sk AND\n         ss_sold_date_sk = d_date_sk AND\n         ss_store_sk = s_store_sk AND\n         d_year IN (1999) AND\n         ((i_category IN ('Books', 'Electronics', 'Sports') AND\n           i_class IN ('computers', 'stereo', 'football'))\n           OR (i_category IN ('Men', 'Jewelry', 'Women') AND\n           i_class IN ('shirts', 'birdal', 'dresses')))\n       GROUP BY i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nWHERE CASE WHEN (avg_monthly_sales <> 0)\n  THEN (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales)\n      ELSE NULL END > 0.1\nORDER BY sum_sales - avg_monthly_sales, s_store_name\n",
    ),
    (
        "queryq90",
        "\nSELECT CAST(amc AS DECIMAL(15, 4)) / CAST(pmc AS DECIMAL(15, 4)) AS am_pm_ratio\nFROM (\n  SELECT COUNT(*) AS amc\n  FROM {{TABLE:web_sales}} ws, {{TABLE:household_demographics}} hd, {{TABLE:time_dim}} td, {{TABLE:web_page}} wp\n  WHERE ws.ws_sold_time_sk = td.t_time_sk\n    AND ws.ws_ship_hdemo_sk = hd.hd_demo_sk\n    AND ws.ws_web_page_sk = wp.wp_web_page_sk\n    AND td.t_hour BETWEEN 8 AND 8 + 1\n    AND hd.hd_dep_count = 6\n    AND wp.wp_char_count BETWEEN 5000 AND 5200\n) at,\n(\n  SELECT COUNT(*) AS pmc\n  FROM {{TABLE:web_sales}} ws, {{TABLE:household_demographics}} hd, {{TABLE:time_dim}} td, {{TABLE:web_page}} wp\n  WHERE ws.ws_sold_time_sk = td.t_time_sk\n    AND ws.ws_ship_hdemo_sk = hd.hd_demo_sk\n    AND ws.ws_web_page_sk = wp.wp_web_page_sk\n    AND td.t_hour BETWEEN 19 AND 19 + 1\n    AND hd.hd_dep_count = 6\n    AND wp.wp_char_count BETWEEN 5000 AND 5200\n) pt\nORDER BY am_pm_ratio",
    ),
    (
        "queryq91",
        "\nSELECT\n  cc_call_center_id Call_Center,\n  cc_name Call_Center_Name,\n  cc_manager Manager,\n  sum(cr_net_loss) Returns_Loss\nFROM\n  {{TABLE:call_center}}, {{TABLE:catalog_returns}}, {{TABLE:date_dim}}, {{TABLE:customer}}, {{TABLE:customer_address}},\n  {{TABLE:customer_demographics}}, {{TABLE:household_demographics}}\nWHERE\n  cr_call_center_sk = cc_call_center_sk\n    AND cr_returned_date_sk = d_date_sk\n    AND cr_returning_customer_sk = c_customer_sk\n    AND cd_demo_sk = c_current_cdemo_sk\n    AND hd_demo_sk = c_current_hdemo_sk\n    AND ca_address_sk = c_current_addr_sk\n    AND d_year = 1998\n    AND d_moy = 11\n    AND ((cd_marital_status = 'M' AND cd_education_status = 'Unknown')\n    OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree'))\n    AND hd_buy_potential LIKE 'Unknown%'\n    AND ca_gmt_offset = -7\nGROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status\nORDER BY sum(cr_net_loss) DESC\n        ",
    ),
    (
        "queryq92",
        "\nSELECT sum(ws_ext_discount_amt) AS `Excess Discount Amount `\nFROM {{TABLE:web_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\nWHERE i_manufact_id = 350\n  AND i_item_sk = ws_item_sk\n  AND d_date BETWEEN '2000-01-27' AND (cast('2000-01-27' AS DATE) + INTERVAL 90 days)\n  AND d_date_sk = ws_sold_date_sk\n  AND ws_ext_discount_amt >\n  (\n    SELECT 1.3 * avg(ws_ext_discount_amt)\n    FROM {{TABLE:web_sales}}, {{TABLE:date_dim}}\n    WHERE ws_item_sk = i_item_sk\n      AND d_date BETWEEN '2000-01-27' AND (cast('2000-01-27' AS DATE) + INTERVAL 90 days)\n      AND d_date_sk = ws_sold_date_sk\n  )\nORDER BY sum(ws_ext_discount_amt)\n",
    ),
    (
        "queryq93",
        "\nSELECT\n  ss_customer_sk,\n  sum(act_sales) sumsales\nFROM (SELECT\n  ss_item_sk,\n  ss_ticket_number,\n  ss_customer_sk,\n  CASE WHEN sr_return_quantity IS NOT NULL\n    THEN (ss_quantity - sr_return_quantity) * ss_sales_price\n  ELSE (ss_quantity * ss_sales_price) END act_sales\nFROM {{TABLE:store_sales}}\n  LEFT OUTER JOIN {{TABLE:store_returns}}\n    ON (sr_item_sk = ss_item_sk AND sr_ticket_number = ss_ticket_number)\n  ,\n  {{TABLE:reason}}\nWHERE sr_reason_sk = r_reason_sk AND r_reason_desc = 'reason 28') t\nGROUP BY ss_customer_sk\nORDER BY sumsales, ss_customer_sk\n",
    ),
    (
        "queryq94",
        "\nSELECT\n  count(DISTINCT ws_order_number) AS `order count `,\n  sum(ws_ext_ship_cost) AS `total shipping cost `,\n  sum(ws_net_profit) AS `total net profit `\nFROM\n  {{TABLE:web_sales}} ws1, {{TABLE:date_dim}} date_dim, {{TABLE:customer_address}} customer_address, {{TABLE:web_site}} web_site\nWHERE\n  d_date BETWEEN '1999-02-01' AND\n  (CAST('1999-02-01' AS DATE) + INTERVAL 60 days)\n    AND ws1.ws_ship_date_sk = d_date_sk\n    AND ws1.ws_ship_addr_sk = ca_address_sk\n    AND ca_state = 'IL'\n    AND ws1.ws_web_site_sk = web_site_sk\n    AND web_company_name = 'pri'\n    AND EXISTS(SELECT *\n               FROM {{TABLE:web_sales}} ws2\n               WHERE ws1.ws_order_number = ws2.ws_order_number\n                 AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n    AND NOT EXISTS(SELECT *\n                   FROM {{TABLE:web_returns}} wr1\n                   WHERE ws1.ws_order_number = wr1.wr_order_number)\nORDER BY count(DISTINCT ws_order_number)\n",
    ),
    (
        "queryq95",
        "\nWITH ws_wh AS\n(SELECT\n    ws1.ws_order_number,\n    ws1.ws_warehouse_sk wh1,\n    ws2.ws_warehouse_sk wh2\n  FROM {{TABLE:web_sales}} ws1, {{TABLE:web_sales}} ws2\n  WHERE ws1.ws_order_number = ws2.ws_order_number\n    AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nSELECT\n  count(DISTINCT ws_order_number) AS `order count `,\n  sum(ws_ext_ship_cost) AS `total shipping cost `,\n  sum(ws_net_profit) AS `total net profit `\nFROM\n  {{TABLE:web_sales}} ws1, {{TABLE:date_dim}}, {{TABLE:customer_address}}, {{TABLE:web_site}}\nWHERE\n  d_date BETWEEN '1999-02-01' AND\n  (CAST('1999-02-01' AS DATE) + INTERVAL 60 DAY)\n    AND ws1.ws_ship_date_sk = d_date_sk\n    AND ws1.ws_ship_addr_sk = ca_address_sk\n    AND ca_state = 'IL'\n    AND ws1.ws_web_site_sk = web_site_sk\n    AND web_company_name = 'pri'\n    AND ws1.ws_order_number IN (SELECT ws_order_number\n  FROM ws_wh)\n    AND ws1.ws_order_number IN (SELECT wr_order_number\n  FROM {{TABLE:web_returns}}, ws_wh\n  WHERE wr_order_number = ws_wh.ws_order_number)\nORDER BY count(DISTINCT ws_order_number)\n",
    ),
    (
        "queryq96",
        "\nSELECT count(*)\nFROM {{TABLE:store_sales}} store_sales, {{TABLE:household_demographics}} household_demographics, {{TABLE:time_dim}} time_dim, {{TABLE:store}} store\nWHERE ss_sold_time_sk = time_dim.t_time_sk\n  AND ss_hdemo_sk = household_demographics.hd_demo_sk\n  AND ss_store_sk = s_store_sk\n  AND time_dim.t_hour = 20\n  AND time_dim.t_minute >= 30\n  AND household_demographics.hd_dep_count = 7\n  AND store.s_store_name = 'ese'\nORDER BY count(*)\n",
    ),
    (
        "queryq97",
        "\nWITH ssci AS (\n  SELECT\n    ss_customer_sk customer_sk,\n    ss_item_sk item_sk\n  FROM {{TABLE:store_sales}}, {{TABLE:date_dim}}\n  WHERE ss_sold_date_sk = d_date_sk\n    AND d_month_seq BETWEEN 1200 AND 1200 + 11\n  GROUP BY ss_customer_sk, ss_item_sk),\n    csci AS (\n    SELECT\n      cs_bill_customer_sk customer_sk,\n      cs_item_sk item_sk\n    FROM {{TABLE:catalog_sales}}, {{TABLE:date_dim}}\n    WHERE cs_sold_date_sk = d_date_sk\n      AND d_month_seq BETWEEN 1200 AND 1200 + 11\n    GROUP BY cs_bill_customer_sk, cs_item_sk)\nSELECT\n  sum(CASE WHEN ssci.customer_sk IS NOT NULL AND csci.customer_sk IS NULL\n    THEN 1\n      ELSE 0 END) store_only,\n  sum(CASE WHEN ssci.customer_sk IS NULL AND csci.customer_sk IS NOT NULL\n    THEN 1\n      ELSE 0 END) catalog_only,\n  sum(CASE WHEN ssci.customer_sk IS NOT NULL AND csci.customer_sk IS NOT NULL\n    THEN 1\n      ELSE 0 END) store_and_catalog\nFROM ssci\n  FULL OUTER JOIN csci ON (ssci.customer_sk = csci.customer_sk\n    AND ssci.item_sk = csci.item_sk)\n",
    ),
    (
        "queryq98",
        "\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  sum(ss_ext_sales_price) AS itemrevenue,\n  sum(ss_ext_sales_price) * 100 / sum(sum(ss_ext_sales_price))\n  OVER\n  (PARTITION BY i_class) AS revenueratio\nFROM\n  {{TABLE:store_sales}}, {{TABLE:item}}, {{TABLE:date_dim}}\nWHERE\n  ss_item_sk = i_item_sk\n    AND i_category IN ('Sports', 'Books', 'Home')\n    AND ss_sold_date_sk = d_date_sk\n    AND d_date BETWEEN cast('1999-02-22' AS DATE)\n  AND (cast('1999-02-22' AS DATE) + INTERVAL 30 days)\nGROUP BY\n  i_item_id, i_item_desc, i_category, i_class, i_current_price\nORDER BY\n  i_category, i_class, i_item_id, i_item_desc, revenueratio\n        ",
    ),
    (
        "queryq99",
        "\nSELECT\n  substr(w_warehouse_name, 1, 20),\n  sm_type,\n  cc_name,\n  sum(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30)\n    THEN 1\n      ELSE 0 END)  AS `30 days `,\n  sum(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND\n    (cs_ship_date_sk - cs_sold_date_sk <= 60)\n    THEN 1\n      ELSE 0 END)  AS `31 - 60 days `,\n  sum(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND\n    (cs_ship_date_sk - cs_sold_date_sk <= 90)\n    THEN 1\n      ELSE 0 END)  AS `61 - 90 days `,\n  sum(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND\n    (cs_ship_date_sk - cs_sold_date_sk <= 120)\n    THEN 1\n      ELSE 0 END)  AS `91 - 120 days `,\n  sum(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120)\n    THEN 1\n      ELSE 0 END)  AS `>120 days `\nFROM\n  {{TABLE:catalog_sales}}, {{TABLE:warehouse}}, {{TABLE:ship_mode}}, {{TABLE:call_center}}, {{TABLE:date_dim}}\nWHERE\n  d_month_seq BETWEEN 1200 AND 1200 + 11\n    AND cs_ship_date_sk = d_date_sk\n    AND cs_warehouse_sk = w_warehouse_sk\n    AND cs_ship_mode_sk = sm_ship_mode_sk\n    AND cs_call_center_sk = cc_call_center_sk\nGROUP BY\n  substr(w_warehouse_name, 1, 20), sm_type, cc_name\nORDER BY substr(w_warehouse_name, 1, 20), sm_type, cc_name\n",
    ),
]
